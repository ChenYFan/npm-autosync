{"version":3,"file":"Artalk.cjs","sources":["../src/api/v2.ts","../../../node_modules/.pnpm/abortcontroller-polyfill@1.7.5/node_modules/abortcontroller-polyfill/dist/polyfill-patch-fetch.js","../src/api/fetch.ts","../src/api/index.ts","../../../node_modules/.pnpm/marked@11.2.0/node_modules/marked/lib/marked.esm.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/she.js","../../../node_modules/.pnpm/assignment@2.0.0/node_modules/assignment/assignment.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/lowercase.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/toMap.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/attributes.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/elements.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/parser.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/sanitizer.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/insane.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/defaults.js","../src/lib/sanitizer.ts","../../../node_modules/.pnpm/hanabi@0.4.0/node_modules/hanabi/dist/hanabi.js","../src/lib/highlight.ts","../src/lib/marked-renderer.ts","../src/lib/marked.ts","../src/lib/merge-deep.ts","../src/data.ts","../src/i18n/en.ts","../src/i18n/external.ts","../src/lib/utils.ts","../src/i18n/index.ts","../src/i18n/zh-CN.ts","../src/lib/event-manager.ts","../src/defaults.ts","../src/config.ts","../src/lib/watch-conf.ts","../src/context.ts","../src/components/dialog.ts","../src/lib/ui.ts","../src/components/checker/captcha-renders.ts","../src/components/checker/captcha.ts","../src/components/checker/admin.ts","../src/components/checker/index.ts","../src/lib/component.ts","../src/editor/editor.html?raw","../src/editor/ui.ts","../src/plugins/editor/_plug.ts","../src/plugins/editor/mover.ts","../src/editor/state.ts","../src/editor/editor.ts","../src/layer/sidebar-layer.ts","../src/layer/sidebar-layer.html?raw","../src/list/layout/nest.ts","../src/list/nest.ts","../src/list/layout/flat.ts","../src/list/layout/index.ts","../src/comment/height-limit.ts","../src/comment/renders/header.ts","../src/components/action-btn.ts","../src/comment/renders/actions.ts","../src/comment/renders/index.ts","../src/comment/renders/avatar.ts","../src/comment/renders/content.ts","../src/comment/renders/reply-at.ts","../src/comment/renders/reply-to.ts","../src/comment/renders/pending.ts","../src/comment/render.ts","../src/comment/comment.html?raw","../src/comment/actions.ts","../src/comment/comment-node.ts","../src/lib/detect.ts","../src/components/read-more-btn.ts","../src/list/paginator/read-more.ts","../src/components/pagination.ts","../src/list/paginator/up-down.ts","../src/list/page.ts","../src/list/list.ts","../src/list/list.html?raw","../src/list/comment.ts","../src/layer/scrollbar-helper.ts","../src/layer/layer.ts","../src/layer/wrap.ts","../src/layer/layer-manager.ts","../src/lib/user.ts","../src/service.ts","../src/components/error-dialog.ts","../src/plugins/conf-remoter.ts","../src/plugins/markdown.ts","../src/plugins/editor/local-storage.ts","../src/plugins/editor/submit-add.ts","../src/plugins/editor/submit.ts","../src/plugins/editor/emoticons.ts","../src/plugins/editor/upload.ts","../src/plugins/editor/preview.ts","../src/plugins/editor/index.ts","../src/plugins/editor/header-event.ts","../src/plugins/editor/header-user.ts","../src/plugins/editor/header-link.ts","../src/plugins/editor/textarea.ts","../src/plugins/editor/submit-btn.ts","../src/plugins/editor/state-reply.ts","../src/plugins/editor/state-edit.ts","../src/plugins/editor/closable.ts","../src/plugins/editor/_kit.ts","../src/plugins/editor-kit.ts","../src/plugins/list/goto-focus.ts","../src/plugins/stat.ts","../src/plugins/version-check.ts","../src/plugins/dark-mode.ts","../src/artalk.ts","../src/plugins/index.ts","../src/plugins/admin-only-elem.ts","../src/plugins/list/index.ts","../src/plugins/list/fetch.ts","../src/plugins/list/loading.ts","../src/plugins/list/unread.ts","../src/plugins/list/with-editor.ts","../src/plugins/list/count.ts","../src/plugins/list/sidebar-btn.ts","../src/plugins/list/unread-badge.ts","../src/plugins/list/dropdown.ts","../src/plugins/list/goto-dispatcher.ts","../src/plugins/list/no-comment.ts","../src/plugins/list/copyright.ts","../src/plugins/list/time-ticking.ts","../src/plugins/list/error-dialog.ts","../src/plugins/list/reach-bottom.ts","../src/plugins/list/goto-first.ts","../src/plugins/notifies.ts","../src/main.ts"],"sourcesContent":["/* eslint-disable */\n/* tslint:disable */\n/*\n * ---------------------------------------------------------------\n * ## THIS FILE WAS GENERATED VIA SWAGGER-TYPESCRIPT-API        ##\n * ##                                                           ##\n * ## AUTHOR: acacode                                           ##\n * ## SOURCE: https://github.com/acacode/swagger-typescript-api ##\n * ---------------------------------------------------------------\n */\n\nexport interface CommonApiVersionData {\n  app: string\n  commit_hash: string\n  version: string\n}\n\nexport interface CommonConfData {\n  frontend_conf: CommonMap\n  version: CommonApiVersionData\n}\n\nexport interface CommonJSONResult {\n  /** Data */\n  data: any\n  /** Message */\n  msg: string\n}\n\nexport type CommonMap = Record<string, any>\n\nexport interface EntityCookedComment {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface EntityCookedNotify {\n  comment_id: number\n  id: number\n  is_emailed: boolean\n  is_read: boolean\n  read_link: string\n  user_id: number\n}\n\nexport interface EntityCookedPage {\n  admin_only: boolean\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface EntityCookedSite {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface EntityCookedUser {\n  badge_color: string\n  badge_name: string\n  email: string\n  id: number\n  is_admin: boolean\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface EntityCookedUserForAdmin {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport type HandlerMap = Record<string, any>\n\nexport interface HandlerParamsCaptchaVerify {\n  /** The captcha value to check */\n  value: string\n}\n\nexport interface HandlerParamsCommentCreate {\n  /** The comment content */\n  content: string\n  /** The comment email */\n  email: string\n  /** The comment link */\n  link?: string\n  /** The comment name */\n  name: string\n  /** The comment page_key */\n  page_key: string\n  /** The comment page_title */\n  page_title?: string\n  /** The comment rid */\n  rid?: number\n  /** The site name of your content scope */\n  site_name: string\n  /** The comment ua */\n  ua?: string\n}\n\nexport interface HandlerParamsCommentUpdate {\n  /** The comment content */\n  content: string\n  /** The comment email */\n  email?: string\n  /** The comment ip */\n  ip?: string\n  /** The comment is_collapsed */\n  is_collapsed: boolean\n  /** The comment is_pending */\n  is_pending: boolean\n  /** The comment is_pinned */\n  is_pinned: boolean\n  /** The comment link */\n  link?: string\n  /** The comment nick */\n  nick?: string\n  /** The comment page_key */\n  page_key: string\n  /** The comment rid */\n  rid: number\n  /** The site name of your content scope */\n  site_name: string\n  /** The comment ua */\n  ua: string\n}\n\nexport interface HandlerParamsEmailSend {\n  /** The body of email */\n  body: string\n  /** The subject of email */\n  subject: string\n  /** The email address of the receiver */\n  to_addr: string\n}\n\nexport interface HandlerParamsNotifyReadAll {\n  /** The user email */\n  email: string\n  /** The username */\n  name: string\n}\n\nexport interface HandlerParamsPageFetchAll {\n  /** If not empty, only fetch pages of this site */\n  site_name?: string\n}\n\nexport interface HandlerParamsPagePV {\n  /** The page key */\n  page_key: string\n  /** The page title */\n  page_title?: string\n  /** The site name of your content scope */\n  site_name?: string\n}\n\nexport interface HandlerParamsPageUpdate {\n  /** Updated page admin_only option */\n  admin_only: boolean\n  /** Updated page key */\n  key: string\n  /** The site name of your content scope */\n  site_name: string\n  /** Updated page title */\n  title: string\n}\n\nexport interface HandlerParamsSettingApply {\n  /** The content of the config file in YAML format */\n  yaml: string\n}\n\nexport interface HandlerParamsSiteCreate {\n  /** The site name */\n  name: string\n  /** The site urls */\n  urls: string[]\n}\n\nexport interface HandlerParamsSiteUpdate {\n  /** Updated site name */\n  name: string\n  /** Updated site urls */\n  urls: string[]\n}\n\nexport interface HandlerParamsTransferImport {\n  /** Automatically answer yes for all questions. */\n  assumeyes?: boolean\n  /** The JSON data */\n  json_data?: string\n  /** The JSON file path */\n  json_file?: string\n  /** The target site name */\n  target_site_name?: string\n  /** The target site url */\n  target_site_url?: string\n  /** Enable URL resolver */\n  url_resolver?: boolean\n}\n\nexport interface HandlerParamsUserCreate {\n  /** The user badge color (hex format) */\n  badge_color?: string\n  /** The user badge name */\n  badge_name?: string\n  /** The user email */\n  email: string\n  /** The user is an admin */\n  is_admin: boolean\n  /** The user link */\n  link?: string\n  /** The user name */\n  name: string\n  /** The user password */\n  password?: string\n  /** The user receive email */\n  receive_email: boolean\n}\n\nexport interface HandlerParamsUserLogin {\n  /** The user email */\n  email: string\n  /** The username */\n  name?: string\n  /** The user password */\n  password: string\n}\n\nexport interface HandlerParamsUserUpdate {\n  /** The user badge color (hex format) */\n  badge_color?: string\n  /** The user badge name */\n  badge_name?: string\n  /** The user email */\n  email: string\n  /** The user is an admin */\n  is_admin: boolean\n  /** The user link */\n  link?: string\n  /** The user name */\n  name: string\n  /** The user password */\n  password?: string\n  /** The user receive email */\n  receive_email: boolean\n}\n\nexport interface HandlerParamsVote {\n  /** The user email */\n  email?: string\n  /** The username */\n  name?: string\n}\n\nexport interface HandlerResponseAdminUserList {\n  count: number\n  users: EntityCookedUserForAdmin[]\n}\n\nexport interface HandlerResponseCaptchaGet {\n  img_data: string\n}\n\nexport interface HandlerResponseCaptchaStatus {\n  is_pass: boolean\n}\n\nexport interface HandlerResponseCommentCreate {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseCommentGet {\n  /** The comment detail */\n  comment: EntityCookedComment\n  /** The reply comment if exists (like reply) */\n  reply_comment: EntityCookedComment\n}\n\nexport interface HandlerResponseCommentList {\n  comments: EntityCookedComment[]\n  count: number\n  page: EntityCookedPage\n  roots_count: number\n}\n\nexport interface HandlerResponseCommentUpdate {\n  badge_color: string\n  badge_name: string\n  content: string\n  content_marked: string\n  date: string\n  email_encrypted: string\n  id: number\n  ip_region: string\n  is_allow_reply: boolean\n  is_collapsed: boolean\n  is_pending: boolean\n  is_pinned: boolean\n  link: string\n  nick: string\n  page_key: string\n  page_url: string\n  rid: number\n  site_name: string\n  ua: string\n  user_id: number\n  visible: boolean\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseNotifyList {\n  count: number\n  notifies: EntityCookedNotify[]\n}\n\nexport interface HandlerResponsePageFetch {\n  admin_only: boolean\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponsePageFetchStatus {\n  /** The number of pages that have been fetched */\n  done: number\n  /** If the task is in progress */\n  is_progress: boolean\n  /** The message of the task status */\n  msg: string\n  /** The total number of pages */\n  total: number\n}\n\nexport interface HandlerResponsePageList {\n  count: number\n  pages: EntityCookedPage[]\n}\n\nexport interface HandlerResponsePagePV {\n  pv: number\n}\n\nexport interface HandlerResponsePageUpdate {\n  admin_only: boolean\n  id: number\n  key: string\n  pv: number\n  site_name: string\n  title: string\n  url: string\n  vote_down: number\n  vote_up: number\n}\n\nexport interface HandlerResponseSettingGet {\n  yaml: string\n}\n\nexport interface HandlerResponseSettingTemplate {\n  yaml: string\n}\n\nexport interface HandlerResponseSiteCreate {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface HandlerResponseSiteList {\n  count: number\n  sites: EntityCookedSite[]\n}\n\nexport interface HandlerResponseSiteUpdate {\n  first_url: string\n  id: number\n  name: string\n  urls: string[]\n  urls_raw: string\n}\n\nexport interface HandlerResponseTransferExport {\n  /** The exported data which is a JSON string */\n  artrans: string\n}\n\nexport interface HandlerResponseTransferUpload {\n  /** The uploaded file name which can be used to import */\n  filename: string\n}\n\nexport interface HandlerResponseUpload {\n  file_name: string\n  file_type: string\n  public_url: string\n}\n\nexport interface HandlerResponseUserCreate {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface HandlerResponseUserInfo {\n  is_login: boolean\n  notifies: EntityCookedNotify[]\n  notifies_count: number\n  user: EntityCookedUser\n}\n\nexport interface HandlerResponseUserLogin {\n  token: string\n  user: EntityCookedUser\n}\n\nexport interface HandlerResponseUserStatus {\n  is_admin: boolean\n  is_login: boolean\n}\n\nexport interface HandlerResponseUserUpdate {\n  badge_color: string\n  badge_name: string\n  comment_count: number\n  email: string\n  id: number\n  is_admin: boolean\n  is_in_conf: boolean\n  last_ip: string\n  last_ua: string\n  link: string\n  name: string\n  receive_email: boolean\n}\n\nexport interface HandlerResponseVote {\n  down: number\n  up: number\n}\n\nexport type QueryParamsType = Record<string | number, any>\nexport type ResponseFormat = keyof Omit<Body, 'body' | 'bodyUsed'>\n\nexport interface FullRequestParams extends Omit<RequestInit, 'body'> {\n  /** set parameter to `true` for call `securityWorker` for this request */\n  secure?: boolean\n  /** request path */\n  path: string\n  /** content type of request body */\n  type?: ContentType\n  /** query params */\n  query?: QueryParamsType\n  /** format of response (i.e. response.json() -> format: \"json\") */\n  format?: ResponseFormat\n  /** request body */\n  body?: unknown\n  /** base url */\n  baseUrl?: string\n  /** request cancellation token */\n  cancelToken?: CancelToken\n}\n\nexport type RequestParams = Omit<FullRequestParams, 'body' | 'method' | 'query' | 'path'>\n\nexport interface ApiConfig<SecurityDataType = unknown> {\n  baseUrl?: string\n  baseApiParams?: Omit<RequestParams, 'baseUrl' | 'cancelToken' | 'signal'>\n  securityWorker?: (securityData: SecurityDataType | null) => Promise<RequestParams | void> | RequestParams | void\n  customFetch?: typeof fetch\n}\n\nexport interface HttpResponse<D extends unknown, E extends unknown = unknown> extends Response {\n  data: D\n  error: E\n}\n\ntype CancelToken = Symbol | string | number\n\nexport enum ContentType {\n  Json = 'application/json',\n  FormData = 'multipart/form-data',\n  UrlEncoded = 'application/x-www-form-urlencoded',\n  Text = 'text/plain',\n}\n\nexport class HttpClient<SecurityDataType = unknown> {\n  public baseUrl: string = '/api/v2'\n  private securityData: SecurityDataType | null = null\n  private securityWorker?: ApiConfig<SecurityDataType>['securityWorker']\n  private abortControllers = new Map<CancelToken, AbortController>()\n  private customFetch = (...fetchParams: Parameters<typeof fetch>) => fetch(...fetchParams)\n\n  private baseApiParams: RequestParams = {\n    credentials: 'same-origin',\n    headers: {},\n    redirect: 'follow',\n    referrerPolicy: 'no-referrer',\n  }\n\n  constructor(apiConfig: ApiConfig<SecurityDataType> = {}) {\n    Object.assign(this, apiConfig)\n  }\n\n  public setSecurityData = (data: SecurityDataType | null) => {\n    this.securityData = data\n  }\n\n  protected encodeQueryParam(key: string, value: any) {\n    const encodedKey = encodeURIComponent(key)\n    return `${encodedKey}=${encodeURIComponent(typeof value === 'number' ? value : `${value}`)}`\n  }\n\n  protected addQueryParam(query: QueryParamsType, key: string) {\n    return this.encodeQueryParam(key, query[key])\n  }\n\n  protected addArrayQueryParam(query: QueryParamsType, key: string) {\n    const value = query[key]\n    return value.map((v: any) => this.encodeQueryParam(key, v)).join('&')\n  }\n\n  protected toQueryString(rawQuery?: QueryParamsType): string {\n    const query = rawQuery || {}\n    const keys = Object.keys(query).filter((key) => 'undefined' !== typeof query[key])\n    return keys\n      .map((key) => (Array.isArray(query[key]) ? this.addArrayQueryParam(query, key) : this.addQueryParam(query, key)))\n      .join('&')\n  }\n\n  protected addQueryParams(rawQuery?: QueryParamsType): string {\n    const queryString = this.toQueryString(rawQuery)\n    return queryString ? `?${queryString}` : ''\n  }\n\n  private contentFormatters: Record<ContentType, (input: any) => any> = {\n    [ContentType.Json]: (input: any) =>\n      input !== null && (typeof input === 'object' || typeof input === 'string') ? JSON.stringify(input) : input,\n    [ContentType.Text]: (input: any) => (input !== null && typeof input !== 'string' ? JSON.stringify(input) : input),\n    [ContentType.FormData]: (input: any) =>\n      Object.keys(input || {}).reduce((formData, key) => {\n        const property = input[key]\n        formData.append(\n          key,\n          property instanceof Blob\n            ? property\n            : typeof property === 'object' && property !== null\n            ? JSON.stringify(property)\n            : `${property}`,\n        )\n        return formData\n      }, new FormData()),\n    [ContentType.UrlEncoded]: (input: any) => this.toQueryString(input),\n  }\n\n  protected mergeRequestParams(params1: RequestParams, params2?: RequestParams): RequestParams {\n    return {\n      ...this.baseApiParams,\n      ...params1,\n      ...(params2 || {}),\n      headers: {\n        ...(this.baseApiParams.headers || {}),\n        ...(params1.headers || {}),\n        ...((params2 && params2.headers) || {}),\n      },\n    }\n  }\n\n  protected createAbortSignal = (cancelToken: CancelToken): AbortSignal | undefined => {\n    if (this.abortControllers.has(cancelToken)) {\n      const abortController = this.abortControllers.get(cancelToken)\n      if (abortController) {\n        return abortController.signal\n      }\n      return void 0\n    }\n\n    const abortController = new AbortController()\n    this.abortControllers.set(cancelToken, abortController)\n    return abortController.signal\n  }\n\n  public abortRequest = (cancelToken: CancelToken) => {\n    const abortController = this.abortControllers.get(cancelToken)\n\n    if (abortController) {\n      abortController.abort()\n      this.abortControllers.delete(cancelToken)\n    }\n  }\n\n  public request = async <T = any, E = any>({\n    body,\n    secure,\n    path,\n    type,\n    query,\n    format,\n    baseUrl,\n    cancelToken,\n    ...params\n  }: FullRequestParams): Promise<HttpResponse<T, E>> => {\n    const secureParams =\n      ((typeof secure === 'boolean' ? secure : this.baseApiParams.secure) &&\n        this.securityWorker &&\n        (await this.securityWorker(this.securityData))) ||\n      {}\n    const requestParams = this.mergeRequestParams(params, secureParams)\n    const queryString = query && this.toQueryString(query)\n    const payloadFormatter = this.contentFormatters[type || ContentType.Json]\n    const responseFormat = format || requestParams.format\n\n    return this.customFetch(`${baseUrl || this.baseUrl || ''}${path}${queryString ? `?${queryString}` : ''}`, {\n      ...requestParams,\n      headers: {\n        ...(requestParams.headers || {}),\n        ...(type && type !== ContentType.FormData ? { 'Content-Type': type } : {}),\n      },\n      signal: (cancelToken ? this.createAbortSignal(cancelToken) : requestParams.signal) || null,\n      body: typeof body === 'undefined' || body === null ? null : payloadFormatter(body),\n    }).then(async (response) => {\n      const r = response as HttpResponse<T, E>\n      r.data = null as unknown as T\n      r.error = null as unknown as E\n\n      const data = !responseFormat\n        ? r\n        : await response[responseFormat]()\n            .then((data) => {\n              if (r.ok) {\n                r.data = data\n              } else {\n                r.error = data\n              }\n              return r\n            })\n            .catch((e) => {\n              r.error = e\n              return r\n            })\n\n      if (cancelToken) {\n        this.abortControllers.delete(cancelToken)\n      }\n\n      if (!response.ok) throw data\n      return data\n    })\n  }\n}\n\n/**\n * @title Artalk API\n * @version 2.0\n * @license MIT (https://github.com/ArtalkJS/Artalk/blob/master/LICENSE)\n * @baseUrl /api/v2\n * @contact API Support <artalkjs@gmail.com> (https://artalk.js.org)\n *\n * Artalk is a modern comment system based on Golang.\n */\nexport class Api<SecurityDataType extends unknown> extends HttpClient<SecurityDataType> {\n  cache = {\n    /**\n * @description Flush all cache on the server\n *\n * @tags Cache\n * @name FlushCache\n * @summary Flush Cache\n * @request POST:/cache/flush\n * @secure\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    flushCache: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/cache/flush`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Cache warming helps you to pre-load the cache to improve the performance of the first request\n *\n * @tags Cache\n * @name WarmUpCache\n * @summary Warm-Up Cache\n * @request POST:/cache/warm_up\n * @secure\n * @response `200` `(HandlerMap & {\n    msg?: string,\n\n})` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    warmUpCache: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap & {\n          msg?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/cache/warm_up`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  captcha = {\n    /**\n * @description Get a base64 encoded captcha image or a HTML page to verify for user\n *\n * @tags Captcha\n * @name GetCaptcha\n * @summary Get Captcha\n * @request GET:/captcha\n * @response `200` `HandlerResponseCaptchaGet` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getCaptcha: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCaptchaGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/captcha`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get the status of the user's captcha verification\n     *\n     * @tags Captcha\n     * @name GetCaptchaStatus\n     * @summary Get Captcha Status\n     * @request GET:/captcha/status\n     * @response `200` `HandlerResponseCaptchaStatus` OK\n     */\n    getCaptchaStatus: (params: RequestParams = {}) =>\n      this.request<HandlerResponseCaptchaStatus, any>({\n        path: `/captcha/status`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Verify user enters correct captcha code\n *\n * @tags Captcha\n * @name VerifyCaptcha\n * @summary Verify Captcha\n * @request POST:/captcha/verify\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    img_data?: string,\n\n})` Forbidden\n */\n    verifyCaptcha: (data: HandlerParamsCaptchaVerify, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          img_data?: string\n        }\n      >({\n        path: `/captcha/verify`,\n        method: 'POST',\n        body: data,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  comments = {\n    /**\n * @description Get a list of comments by some conditions\n *\n * @tags Comment\n * @name GetComments\n * @summary Get Comment List\n * @request GET:/comments\n * @secure\n * @response `200` `HandlerResponseCommentList` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getComments: (\n      query: {\n        /** The user email */\n        email?: string\n        /** Enable flat_mode */\n        flat_mode?: boolean\n        /** The limit for pagination */\n        limit?: number\n        /** The username */\n        name?: string\n        /** The offset for pagination */\n        offset?: number\n        /** The comment page_key */\n        page_key: string\n        /** The scope of comments */\n        scope?: 'page' | 'user' | 'site'\n        /** Search keywords */\n        search?: string\n        /** The site name of your content scope */\n        site_name?: string\n        /** Sort by condition */\n        sort_by?: 'date_asc' | 'date_desc' | 'vote'\n        /** Message center show type */\n        type?: 'all' | 'mentions' | 'mine' | 'pending'\n        /** Only show comments by admin */\n        view_only_admin?: boolean\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseCommentList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Create a new comment\n *\n * @tags Comment\n * @name CreateComment\n * @summary Create Comment\n * @request POST:/comments\n * @secure\n * @response `200` `HandlerResponseCommentCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createComment: (comment: HandlerParamsCommentCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments`,\n        method: 'POST',\n        body: comment,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get the detail of a comment by comment id\n *\n * @tags Comment\n * @name GetComment\n * @summary Get a comment\n * @request GET:/comments/{id}\n * @response `200` `HandlerResponseCommentGet` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getComment: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'GET',\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific comment\n *\n * @tags Comment\n * @name UpdateComment\n * @summary Update Comment\n * @request PUT:/comments/{id}\n * @secure\n * @response `200` `HandlerResponseCommentUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updateComment: (id: number, comment: HandlerParamsCommentUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseCommentUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'PUT',\n        body: comment,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific comment\n *\n * @tags Comment\n * @name DeleteComment\n * @summary Delete Comment\n * @request DELETE:/comments/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteComment: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/comments/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  conf = {\n    /**\n     * @description Get System Configs for UI\n     *\n     * @tags System\n     * @name Conf\n     * @summary Get System Configs\n     * @request GET:/conf\n     * @response `200` `CommonConfData` OK\n     */\n    conf: (params: RequestParams = {}) =>\n      this.request<CommonConfData, any>({\n        path: `/conf`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n  }\n  notifies = {\n    /**\n * @description Get a list of notifies for user\n *\n * @tags Notify\n * @name GetNotifies\n * @summary Get Notifies\n * @request GET:/notifies\n * @response `200` `HandlerResponseNotifyList` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getNotifies: (\n      query: {\n        /** The user email */\n        email: string\n        /** The user name */\n        name: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseNotifyList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies`,\n        method: 'GET',\n        query: query,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Mark all notifies as read for user\n *\n * @tags Notify\n * @name MarkAllNotifyRead\n * @summary Mark All Notifies as Read\n * @request POST:/notifies/read\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    markAllNotifyRead: (options: HandlerParamsNotifyReadAll, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies/read`,\n        method: 'POST',\n        body: options,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Mark specific notification as read for user\n *\n * @tags Notify\n * @name MarkNotifyRead\n * @summary Mark Notify as Read\n * @request POST:/notifies/{comment_id}/{notify_key}\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    markNotifyRead: (commentId: number, notifyKey: string, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/notifies/${commentId}/${notifyKey}`,\n        method: 'POST',\n        format: 'json',\n        ...params,\n      }),\n  }\n  pages = {\n    /**\n * @description Get a list of pages by some conditions\n *\n * @tags Page\n * @name GetPages\n * @summary Get Page List\n * @request GET:/pages\n * @secure\n * @response `200` `HandlerResponsePageList` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    getPages: (\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** The offset for pagination */\n        offset?: number\n        /** The site name of your content scope */\n        site_name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponsePageList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Fetch the data of all pages\n *\n * @tags Page\n * @name FetchAllPages\n * @summary Fetch All Pages Data\n * @request POST:/pages/fetch\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    fetchAllPages: (options: HandlerParamsPageFetchAll, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/fetch`,\n        method: 'POST',\n        body: options,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get the status of the task of fetching all pages\n     *\n     * @tags Page\n     * @name GetPageFetchStatus\n     * @summary Get Pages Fetch Status\n     * @request GET:/pages/fetch/status\n     * @secure\n     * @response `200` `HandlerResponsePageFetchStatus` OK\n     */\n    getPageFetchStatus: (params: RequestParams = {}) =>\n      this.request<HandlerResponsePageFetchStatus, any>({\n        path: `/pages/fetch/status`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Increase and get the number of page views\n     *\n     * @tags Page\n     * @name LogPv\n     * @summary Increase Page Views (PV)\n     * @request POST:/pages/pv\n     * @response `200` `HandlerResponsePagePV` OK\n     */\n    logPv: (page: HandlerParamsPagePV, params: RequestParams = {}) =>\n      this.request<HandlerResponsePagePV, any>({\n        path: `/pages/pv`,\n        method: 'POST',\n        body: page,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific page\n *\n * @tags Page\n * @name UpdatePage\n * @summary Update Page\n * @request PUT:/pages/{id}\n * @secure\n * @response `200` `HandlerResponsePageUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updatePage: (id: number, page: HandlerParamsPageUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponsePageUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}`,\n        method: 'PUT',\n        body: page,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific page\n *\n * @tags Page\n * @name DeletePage\n * @summary Delete Page\n * @request DELETE:/pages/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deletePage: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Fetch the data of a specific page\n *\n * @tags Page\n * @name FetchPage\n * @summary Fetch Page Data\n * @request POST:/pages/{id}/fetch\n * @secure\n * @response `200` `HandlerResponsePageFetch` OK\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    fetchPage: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponsePageFetch,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/pages/${id}/fetch`,\n        method: 'POST',\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  sendEmail = {\n    /**\n * @description Send an email to test the email sender\n *\n * @tags System\n * @name SendEmail\n * @summary Send Email\n * @request POST:/send_email\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `HandlerMap` Internal Server Error\n */\n    sendEmail: (email: HandlerParamsEmailSend, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        | (HandlerMap & {\n            msg?: string\n          })\n        | HandlerMap\n      >({\n        path: `/send_email`,\n        method: 'POST',\n        body: email,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  settings = {\n    /**\n * @description Get settings from app config file\n *\n * @tags System\n * @name GetSettings\n * @summary Get Settings\n * @request GET:/settings\n * @secure\n * @response `200` `HandlerResponseSettingGet` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getSettings: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseSettingGet,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/settings`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Apply settings and restart the server\n *\n * @tags System\n * @name ApplySettings\n * @summary Save and apply Settings\n * @request PUT:/settings\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    applySettings: (settings: HandlerParamsSettingApply, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/settings`,\n        method: 'PUT',\n        body: settings,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get config templates in different languages for rendering the settings page in the frontend\n     *\n     * @tags System\n     * @name GetSettingsTemplate\n     * @summary Get Settings Template\n     * @request GET:/settings/template/{locale}\n     * @secure\n     * @response `200` `HandlerResponseSettingTemplate` OK\n     */\n    getSettingsTemplate: (locale: string, params: RequestParams = {}) =>\n      this.request<HandlerResponseSettingTemplate, any>({\n        path: `/settings/template/${locale}`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  sites = {\n    /**\n     * @description Get a list of sites by some conditions\n     *\n     * @tags Site\n     * @name GetSites\n     * @summary Get Site List\n     * @request GET:/sites\n     * @secure\n     * @response `200` `HandlerResponseSiteList` OK\n     */\n    getSites: (params: RequestParams = {}) =>\n      this.request<HandlerResponseSiteList, any>({\n        path: `/sites`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Create a new site\n *\n * @tags Site\n * @name CreateSite\n * @summary Create Site\n * @request POST:/sites\n * @secure\n * @response `200` `HandlerResponseSiteCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createSite: (site: HandlerParamsSiteCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseSiteCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/sites`,\n        method: 'POST',\n        body: site,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Update a specific site\n     *\n     * @tags Site\n     * @name UpdateSite\n     * @summary Update Site\n     * @request PUT:/sites/{id}\n     * @secure\n     * @response `200` `HandlerResponseSiteUpdate` OK\n     */\n    updateSite: (id: number, site: HandlerParamsSiteUpdate, params: RequestParams = {}) =>\n      this.request<HandlerResponseSiteUpdate, any>({\n        path: `/sites/${id}`,\n        method: 'PUT',\n        body: site,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific site\n *\n * @tags Site\n * @name DeleteSite\n * @summary Site Delete\n * @request DELETE:/sites/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteSite: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/sites/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  stats = {\n    /**\n * @description Get the statistics of various data analysis\n *\n * @tags Statistic\n * @name GetStats\n * @summary Statistic\n * @request GET:/stats/{type}\n * @response `200` `CommonJSONResult` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    getStats: (\n      type:\n        | 'latest_comments'\n        | 'latest_pages'\n        | 'pv_most_pages'\n        | 'comment_most_pages'\n        | 'page_pv'\n        | 'site_pv'\n        | 'page_comment'\n        | 'site_comment'\n        | 'rand_comments'\n        | 'rand_pages',\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** multiple page keys separated by commas */\n        page_keys?: string\n        /** The site name of your content scope */\n        site_name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        CommonJSONResult,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/stats/${type}`,\n        method: 'GET',\n        query: query,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  transfer = {\n    /**\n * @description Export data from Artalk\n *\n * @tags Transfer\n * @name ExportArtrans\n * @summary Export Artrans\n * @request GET:/transfer/export\n * @secure\n * @response `200` `HandlerResponseTransferExport` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    exportArtrans: (params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseTransferExport,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/transfer/export`,\n        method: 'GET',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Import data to Artalk\n     *\n     * @tags Transfer\n     * @name ImportArtrans\n     * @summary Import Artrans\n     * @request POST:/transfer/import\n     * @secure\n     * @response `200` `string` OK\n     */\n    importArtrans: (data: HandlerParamsTransferImport, params: RequestParams = {}) =>\n      this.request<string, any>({\n        path: `/transfer/import`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.Json,\n        ...params,\n      }),\n\n    /**\n * @description Upload a file to prepare to import\n *\n * @tags Transfer\n * @name UploadArtrans\n * @summary Upload Artrans\n * @request POST:/transfer/upload\n * @secure\n * @response `200` `(HandlerResponseTransferUpload & {\n    filename?: string,\n\n})` OK\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    uploadArtrans: (\n      data: {\n        /**\n         * Upload file in preparation for import task\n         * @format binary\n         */\n        file: File\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseTransferUpload & {\n          filename?: string\n        },\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/transfer/upload`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.FormData,\n        format: 'json',\n        ...params,\n      }),\n  }\n  upload = {\n    /**\n * @description Upload file from this endpoint\n *\n * @tags Upload\n * @name Upload\n * @summary Upload\n * @request POST:/upload\n * @secure\n * @response `200` `HandlerResponseUpload` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    upload: (\n      data: {\n        /**\n         * Upload file\n         * @format binary\n         */\n        file: File\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseUpload,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/upload`,\n        method: 'POST',\n        body: data,\n        secure: true,\n        type: ContentType.FormData,\n        format: 'json',\n        ...params,\n      }),\n  }\n  user = {\n    /**\n * @description Get user info to prepare for login or check current user status\n *\n * @tags Account\n * @name GetUser\n * @summary Get User Info\n * @request GET:/user\n * @secure\n * @response `200` `HandlerResponseUserInfo` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n */\n    getUser: (\n      query?: {\n        /** The user email */\n        email?: string\n        /** The username */\n        name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseUserInfo,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/user`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Login user by name or email\n *\n * @tags Account\n * @name Login\n * @summary Get Access Token\n * @request POST:/user/access_token\n * @response `200` `HandlerResponseUserLogin` OK\n * @response `400` `(HandlerMap & {\n    \" data\"?: {\n    need_name_select?: (string)[],\n\n},\n    msg?: string,\n\n})` Multiple users with the same email address are matched\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    login: (user: HandlerParamsUserLogin, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserLogin,\n        | (HandlerMap & {\n            ' data'?: {\n              need_name_select?: string[]\n            }\n            msg?: string\n          })\n        | (HandlerMap & {\n            msg?: string\n          })\n      >({\n        path: `/user/access_token`,\n        method: 'POST',\n        body: user,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n     * @description Get user login status by header Authorization\n     *\n     * @tags Account\n     * @name GetUserStatus\n     * @summary Get Login Status\n     * @request GET:/user/status\n     * @secure\n     * @response `200` `HandlerResponseUserStatus` OK\n     */\n    getUserStatus: (\n      query?: {\n        /** The user email */\n        email?: string\n        /** The username */\n        name?: string\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<HandlerResponseUserStatus, any>({\n        path: `/user/status`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n  }\n  users = {\n    /**\n * @description Create a new user\n *\n * @tags User\n * @name CreateUser\n * @summary Create User\n * @request POST:/users\n * @secure\n * @response `200` `HandlerResponseUserCreate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    createUser: (user: HandlerParamsUserCreate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserCreate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users`,\n        method: 'POST',\n        body: user,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Update a specific user\n *\n * @tags User\n * @name UpdateUser\n * @summary Update User\n * @request PUT:/users/{id}\n * @secure\n * @response `200` `HandlerResponseUserUpdate` OK\n * @response `400` `(HandlerMap & {\n    msg?: string,\n\n})` Bad Request\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    updateUser: (id: number, user: HandlerParamsUserUpdate, params: RequestParams = {}) =>\n      this.request<\n        HandlerResponseUserUpdate,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${id}`,\n        method: 'PUT',\n        body: user,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Delete a specific user\n *\n * @tags User\n * @name DeleteUser\n * @summary Delete User\n * @request DELETE:/users/{id}\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    deleteUser: (id: number, params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${id}`,\n        method: 'DELETE',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Get a list of users by some conditions\n *\n * @tags User\n * @name GetUsers\n * @summary Get User List\n * @request GET:/users/{type}\n * @secure\n * @response `200` `HandlerResponseAdminUserList` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    getUsers: (\n      type?: 'all' | 'admin' | 'in_conf',\n      query?: {\n        /** The limit for pagination */\n        limit?: number\n        /** The offset for pagination */\n        offset?: number\n      },\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseAdminUserList,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/users/${type}`,\n        method: 'GET',\n        query: query,\n        secure: true,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n  version = {\n    /**\n     * @description Get the version of Artalk\n     *\n     * @tags System\n     * @name GetVersion\n     * @summary Get Version Info\n     * @request GET:/version\n     * @response `200` `CommonApiVersionData` OK\n     */\n    getVersion: (params: RequestParams = {}) =>\n      this.request<CommonApiVersionData, any>({\n        path: `/version`,\n        method: 'GET',\n        format: 'json',\n        ...params,\n      }),\n  }\n  votes = {\n    /**\n * @description Sync the number of votes in the `comments` or `pages` data tables to keep them the same as the `votes` table\n *\n * @tags Vote\n * @name SyncVotes\n * @summary Sync Vote Data\n * @request POST:/votes/sync\n * @secure\n * @response `200` `HandlerMap` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n */\n    syncVotes: (params: RequestParams = {}) =>\n      this.request<\n        HandlerMap,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/votes/sync`,\n        method: 'POST',\n        secure: true,\n        format: 'json',\n        ...params,\n      }),\n\n    /**\n * @description Vote for a specific comment or page\n *\n * @tags Vote\n * @name Vote\n * @summary Vote\n * @request POST:/votes/{type}/{target_id}\n * @response `200` `HandlerResponseVote` OK\n * @response `403` `(HandlerMap & {\n    msg?: string,\n\n})` Forbidden\n * @response `404` `(HandlerMap & {\n    msg?: string,\n\n})` Not Found\n * @response `500` `(HandlerMap & {\n    msg?: string,\n\n})` Internal Server Error\n */\n    vote: (\n      type: 'comment_up' | 'comment_down' | 'page_up' | 'page_down',\n      targetId: number,\n      vote: HandlerParamsVote,\n      params: RequestParams = {},\n    ) =>\n      this.request<\n        HandlerResponseVote,\n        HandlerMap & {\n          msg?: string\n        }\n      >({\n        path: `/votes/${type}/${targetId}`,\n        method: 'POST',\n        body: vote,\n        type: ContentType.Json,\n        format: 'json',\n        ...params,\n      }),\n  }\n}\n","(function (factory) {\n  typeof define === 'function' && define.amd ? define(factory) :\n  factory();\n})((function () { 'use strict';\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    Object.defineProperty(subClass, \"prototype\", {\n      writable: false\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n    return _setPrototypeOf(o, p);\n  }\n\n  function _isNativeReflectConstruct() {\n    if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === \"function\") return true;\n\n    try {\n      Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n      return call;\n    } else if (call !== void 0) {\n      throw new TypeError(\"Derived constructors may only return object or undefined\");\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _createSuper(Derived) {\n    var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n    return function _createSuperInternal() {\n      var Super = _getPrototypeOf(Derived),\n          result;\n\n      if (hasNativeReflectConstruct) {\n        var NewTarget = _getPrototypeOf(this).constructor;\n\n        result = Reflect.construct(Super, arguments, NewTarget);\n      } else {\n        result = Super.apply(this, arguments);\n      }\n\n      return _possibleConstructorReturn(this, result);\n    };\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get() {\n    if (typeof Reflect !== \"undefined\" && Reflect.get) {\n      _get = Reflect.get.bind();\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(arguments.length < 3 ? target : receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get.apply(this, arguments);\n  }\n\n  var Emitter = /*#__PURE__*/function () {\n    function Emitter() {\n      _classCallCheck(this, Emitter);\n\n      Object.defineProperty(this, 'listeners', {\n        value: {},\n        writable: true,\n        configurable: true\n      });\n    }\n\n    _createClass(Emitter, [{\n      key: \"addEventListener\",\n      value: function addEventListener(type, callback, options) {\n        if (!(type in this.listeners)) {\n          this.listeners[type] = [];\n        }\n\n        this.listeners[type].push({\n          callback: callback,\n          options: options\n        });\n      }\n    }, {\n      key: \"removeEventListener\",\n      value: function removeEventListener(type, callback) {\n        if (!(type in this.listeners)) {\n          return;\n        }\n\n        var stack = this.listeners[type];\n\n        for (var i = 0, l = stack.length; i < l; i++) {\n          if (stack[i].callback === callback) {\n            stack.splice(i, 1);\n            return;\n          }\n        }\n      }\n    }, {\n      key: \"dispatchEvent\",\n      value: function dispatchEvent(event) {\n        if (!(event.type in this.listeners)) {\n          return;\n        }\n\n        var stack = this.listeners[event.type];\n        var stackToCall = stack.slice();\n\n        for (var i = 0, l = stackToCall.length; i < l; i++) {\n          var listener = stackToCall[i];\n\n          try {\n            listener.callback.call(this, event);\n          } catch (e) {\n            Promise.resolve().then(function () {\n              throw e;\n            });\n          }\n\n          if (listener.options && listener.options.once) {\n            this.removeEventListener(event.type, listener.callback);\n          }\n        }\n\n        return !event.defaultPrevented;\n      }\n    }]);\n\n    return Emitter;\n  }();\n\n  var AbortSignal = /*#__PURE__*/function (_Emitter) {\n    _inherits(AbortSignal, _Emitter);\n\n    var _super = _createSuper(AbortSignal);\n\n    function AbortSignal() {\n      var _this;\n\n      _classCallCheck(this, AbortSignal);\n\n      _this = _super.call(this); // Some versions of babel does not transpile super() correctly for IE <= 10, if the parent\n      // constructor has failed to run, then \"this.listeners\" will still be undefined and then we call\n      // the parent constructor directly instead as a workaround. For general details, see babel bug:\n      // https://github.com/babel/babel/issues/3041\n      // This hack was added as a fix for the issue described here:\n      // https://github.com/Financial-Times/polyfill-library/pull/59#issuecomment-477558042\n\n      if (!_this.listeners) {\n        Emitter.call(_assertThisInitialized(_this));\n      } // Compared to assignment, Object.defineProperty makes properties non-enumerable by default and\n      // we want Object.keys(new AbortController().signal) to be [] for compat with the native impl\n\n\n      Object.defineProperty(_assertThisInitialized(_this), 'aborted', {\n        value: false,\n        writable: true,\n        configurable: true\n      });\n      Object.defineProperty(_assertThisInitialized(_this), 'onabort', {\n        value: null,\n        writable: true,\n        configurable: true\n      });\n      Object.defineProperty(_assertThisInitialized(_this), 'reason', {\n        value: undefined,\n        writable: true,\n        configurable: true\n      });\n      return _this;\n    }\n\n    _createClass(AbortSignal, [{\n      key: \"toString\",\n      value: function toString() {\n        return '[object AbortSignal]';\n      }\n    }, {\n      key: \"dispatchEvent\",\n      value: function dispatchEvent(event) {\n        if (event.type === 'abort') {\n          this.aborted = true;\n\n          if (typeof this.onabort === 'function') {\n            this.onabort.call(this, event);\n          }\n        }\n\n        _get(_getPrototypeOf(AbortSignal.prototype), \"dispatchEvent\", this).call(this, event);\n      }\n    }]);\n\n    return AbortSignal;\n  }(Emitter);\n  var AbortController = /*#__PURE__*/function () {\n    function AbortController() {\n      _classCallCheck(this, AbortController);\n\n      // Compared to assignment, Object.defineProperty makes properties non-enumerable by default and\n      // we want Object.keys(new AbortController()) to be [] for compat with the native impl\n      Object.defineProperty(this, 'signal', {\n        value: new AbortSignal(),\n        writable: true,\n        configurable: true\n      });\n    }\n\n    _createClass(AbortController, [{\n      key: \"abort\",\n      value: function abort(reason) {\n        var event;\n\n        try {\n          event = new Event('abort');\n        } catch (e) {\n          if (typeof document !== 'undefined') {\n            if (!document.createEvent) {\n              // For Internet Explorer 8:\n              event = document.createEventObject();\n              event.type = 'abort';\n            } else {\n              // For Internet Explorer 11:\n              event = document.createEvent('Event');\n              event.initEvent('abort', false, false);\n            }\n          } else {\n            // Fallback where document isn't available:\n            event = {\n              type: 'abort',\n              bubbles: false,\n              cancelable: false\n            };\n          }\n        }\n\n        var signalReason = reason;\n\n        if (signalReason === undefined) {\n          if (typeof document === 'undefined') {\n            signalReason = new Error('This operation was aborted');\n            signalReason.name = 'AbortError';\n          } else {\n            try {\n              signalReason = new DOMException('signal is aborted without reason');\n            } catch (err) {\n              // IE 11 does not support calling the DOMException constructor, use a\n              // regular error object on it instead.\n              signalReason = new Error('This operation was aborted');\n              signalReason.name = 'AbortError';\n            }\n          }\n        }\n\n        this.signal.reason = signalReason;\n        this.signal.dispatchEvent(event);\n      }\n    }, {\n      key: \"toString\",\n      value: function toString() {\n        return '[object AbortController]';\n      }\n    }]);\n\n    return AbortController;\n  }();\n\n  if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n    // These are necessary to make sure that we get correct output for:\n    // Object.prototype.toString.call(new AbortController())\n    AbortController.prototype[Symbol.toStringTag] = 'AbortController';\n    AbortSignal.prototype[Symbol.toStringTag] = 'AbortSignal';\n  }\n\n  function polyfillNeeded(self) {\n    if (self.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL) {\n      console.log('__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill');\n      return true;\n    } // Note that the \"unfetch\" minimal fetch polyfill defines fetch() without\n    // defining window.Request, and this polyfill need to work on top of unfetch\n    // so the below feature detection needs the !self.AbortController part.\n    // The Request.prototype check is also needed because Safari versions 11.1.2\n    // up to and including 12.1.x has a window.AbortController present but still\n    // does NOT correctly implement abortable fetch:\n    // https://bugs.webkit.org/show_bug.cgi?id=174980#c2\n\n\n    return typeof self.Request === 'function' && !self.Request.prototype.hasOwnProperty('signal') || !self.AbortController;\n  }\n\n  /**\n   * Note: the \"fetch.Request\" default value is available for fetch imported from\n   * the \"node-fetch\" package and not in browsers. This is OK since browsers\n   * will be importing umd-polyfill.js from that path \"self\" is passed the\n   * decorator so the default value will not be used (because browsers that define\n   * fetch also has Request). One quirky setup where self.fetch exists but\n   * self.Request does not is when the \"unfetch\" minimal fetch polyfill is used\n   * on top of IE11; for this case the browser will try to use the fetch.Request\n   * default value which in turn will be undefined but then then \"if (Request)\"\n   * will ensure that you get a patched fetch but still no Request (as expected).\n   * @param {fetch, Request = fetch.Request}\n   * @returns {fetch: abortableFetch, Request: AbortableRequest}\n   */\n\n  function abortableFetchDecorator(patchTargets) {\n    if ('function' === typeof patchTargets) {\n      patchTargets = {\n        fetch: patchTargets\n      };\n    }\n\n    var _patchTargets = patchTargets,\n        fetch = _patchTargets.fetch,\n        _patchTargets$Request = _patchTargets.Request,\n        NativeRequest = _patchTargets$Request === void 0 ? fetch.Request : _patchTargets$Request,\n        NativeAbortController = _patchTargets.AbortController,\n        _patchTargets$__FORCE = _patchTargets.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,\n        __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL = _patchTargets$__FORCE === void 0 ? false : _patchTargets$__FORCE;\n\n    if (!polyfillNeeded({\n      fetch: fetch,\n      Request: NativeRequest,\n      AbortController: NativeAbortController,\n      __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL: __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL\n    })) {\n      return {\n        fetch: fetch,\n        Request: Request\n      };\n    }\n\n    var Request = NativeRequest; // Note that the \"unfetch\" minimal fetch polyfill defines fetch() without\n    // defining window.Request, and this polyfill need to work on top of unfetch\n    // hence we only patch it if it's available. Also we don't patch it if signal\n    // is already available on the Request prototype because in this case support\n    // is present and the patching below can cause a crash since it assigns to\n    // request.signal which is technically a read-only property. This latter error\n    // happens when you run the main5.js node-fetch example in the repo\n    // \"abortcontroller-polyfill-examples\". The exact error is:\n    //   request.signal = init.signal;\n    //   ^\n    // TypeError: Cannot set property signal of #<Request> which has only a getter\n\n    if (Request && !Request.prototype.hasOwnProperty('signal') || __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL) {\n      Request = function Request(input, init) {\n        var signal;\n\n        if (init && init.signal) {\n          signal = init.signal; // Never pass init.signal to the native Request implementation when the polyfill has\n          // been installed because if we're running on top of a browser with a\n          // working native AbortController (i.e. the polyfill was installed due to\n          // __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL being set), then passing our\n          // fake AbortSignal to the native fetch will trigger:\n          // TypeError: Failed to construct 'Request': member signal is not of type AbortSignal.\n\n          delete init.signal;\n        }\n\n        var request = new NativeRequest(input, init);\n\n        if (signal) {\n          Object.defineProperty(request, 'signal', {\n            writable: false,\n            enumerable: false,\n            configurable: true,\n            value: signal\n          });\n        }\n\n        return request;\n      };\n\n      Request.prototype = NativeRequest.prototype;\n    }\n\n    var realFetch = fetch;\n\n    var abortableFetch = function abortableFetch(input, init) {\n      var signal = Request && Request.prototype.isPrototypeOf(input) ? input.signal : init ? init.signal : undefined;\n\n      if (signal) {\n        var abortError;\n\n        try {\n          abortError = new DOMException('Aborted', 'AbortError');\n        } catch (err) {\n          // IE 11 does not support calling the DOMException constructor, use a\n          // regular error object on it instead.\n          abortError = new Error('Aborted');\n          abortError.name = 'AbortError';\n        } // Return early if already aborted, thus avoiding making an HTTP request\n\n\n        if (signal.aborted) {\n          return Promise.reject(abortError);\n        } // Turn an event into a promise, reject it once `abort` is dispatched\n\n\n        var cancellation = new Promise(function (_, reject) {\n          signal.addEventListener('abort', function () {\n            return reject(abortError);\n          }, {\n            once: true\n          });\n        });\n\n        if (init && init.signal) {\n          // Never pass .signal to the native implementation when the polyfill has\n          // been installed because if we're running on top of a browser with a\n          // working native AbortController (i.e. the polyfill was installed due to\n          // __FORCE_INSTALL_ABORTCONTROLLER_POLYFILL being set), then passing our\n          // fake AbortSignal to the native fetch will trigger:\n          // TypeError: Failed to execute 'fetch' on 'Window': member signal is not of type AbortSignal.\n          delete init.signal;\n        } // Return the fastest promise (don't need to wait for request to finish)\n\n\n        return Promise.race([cancellation, realFetch(input, init)]);\n      }\n\n      return realFetch(input, init);\n    };\n\n    return {\n      fetch: abortableFetch,\n      Request: Request\n    };\n  }\n\n  (function (self) {\n\n    if (!polyfillNeeded(self)) {\n      return;\n    }\n\n    if (!self.fetch) {\n      console.warn('fetch() is not available, cannot install abortcontroller-polyfill');\n      return;\n    }\n\n    var _abortableFetch = abortableFetchDecorator(self),\n        fetch = _abortableFetch.fetch,\n        Request = _abortableFetch.Request;\n\n    self.fetch = fetch;\n    self.Request = Request;\n    Object.defineProperty(self, 'AbortController', {\n      writable: true,\n      enumerable: false,\n      configurable: true,\n      value: AbortController\n    });\n    Object.defineProperty(self, 'AbortSignal', {\n      writable: true,\n      enumerable: false,\n      configurable: true,\n      value: AbortSignal\n    });\n  })(typeof self !== 'undefined' ? self : global);\n\n}));\n","import 'abortcontroller-polyfill/dist/polyfill-patch-fetch'\n\nimport { FetchError } from '@/types'\nimport { ApiOptions } from './options'\n\nexport const Fetch = async (opts: ApiOptions, input: string | URL | Request, init?: RequestInit) => {\n  const apiToken = opts.getApiToken && opts.getApiToken()\n\n  const headers = new Headers({\n    'Authorization': apiToken ? `Bearer ${apiToken}` : '',\n    ...init?.headers,\n  })\n\n  if (!headers.get('Authorization')) headers.delete('Authorization')\n\n  // 请求操作\n  const resp = await fetch(input, {\n    ...init,\n    headers,\n  })\n\n  if (!resp.ok) {\n    // Deserialize response body (if it is JSON, otherwise returns `{}`)\n    const json: any = (await resp.json().catch(() => {})) || {}\n\n    // 请求弹出层验证\n    if (json.need_captcha) {\n        // 请求需要验证码\n        opts.onNeedCheckCaptcha && await opts.onNeedCheckCaptcha({\n          data: { imgData: json.img_data, iframe: json.iframe }\n        })\n        return Fetch(opts, input, init) // retry\n    }\n\n    if (json.need_login) {\n        // 请求需要管理员权限\n        opts.onNeedCheckAdmin && await opts.onNeedCheckAdmin({})\n        return Fetch(opts, input, init)\n    }\n\n    throw createError(resp.status, json)\n  }\n\n  return resp\n}\n\nexport class FetchException extends Error implements FetchError {\n  code: number = 0\n  message: string = 'fetch error'\n  data?: any\n}\n\nfunction createError(code: number, data: any): FetchException {\n  const err = new FetchException()\n  err.message = data.msg || data.message || 'fetch error'\n  err.code = code\n  err.data = data\n  console.error(err)\n  return err\n}\n","import { ApiOptions } from './options'\nimport { Api as ApiV2 } from './v2'\nimport { Fetch } from './fetch'\n\nexport class Api extends ApiV2<void> {\n  private _opts: ApiOptions\n\n  constructor(opts: ApiOptions) {\n    super({\n      baseUrl: opts.baseURL,\n      customFetch: (input, init) => Fetch(opts, input, init)\n    })\n\n    this._opts = opts\n  }\n\n  /**\n   * Get user info as params for request\n   *\n   * @returns Request params with user info\n   */\n  getUserFields() {\n    const user = this._opts.userInfo\n    if (!user?.name || !user?.email) return undefined\n    return { name: user.name, email: user.email }\n  }\n}\n","/**\n * marked v11.2.0 - a markdown parser\n * Copyright (c) 2011-2024, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\n/**\n * Gets the original marked default options.\n */\nfunction _getDefaults() {\n    return {\n        async: false,\n        breaks: false,\n        extensions: null,\n        gfm: true,\n        hooks: null,\n        pedantic: false,\n        renderer: null,\n        silent: false,\n        tokenizer: null,\n        walkTokens: null\n    };\n}\nlet _defaults = _getDefaults();\nfunction changeDefaults(newDefaults) {\n    _defaults = newDefaults;\n}\n\n/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = new RegExp(escapeTest.source, 'g');\nconst escapeTestNoEncode = /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/;\nconst escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');\nconst escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n};\nconst getEscapeReplacement = (ch) => escapeReplacements[ch];\nfunction escape$1(html, encode) {\n    if (encode) {\n        if (escapeTest.test(html)) {\n            return html.replace(escapeReplace, getEscapeReplacement);\n        }\n    }\n    else {\n        if (escapeTestNoEncode.test(html)) {\n            return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n        }\n    }\n    return html;\n}\nconst unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\nfunction unescape(html) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, (_, n) => {\n        n = n.toLowerCase();\n        if (n === 'colon')\n            return ':';\n        if (n.charAt(0) === '#') {\n            return n.charAt(1) === 'x'\n                ? String.fromCharCode(parseInt(n.substring(2), 16))\n                : String.fromCharCode(+n.substring(1));\n        }\n        return '';\n    });\n}\nconst caret = /(^|[^\\[])\\^/g;\nfunction edit(regex, opt) {\n    let source = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    const obj = {\n        replace: (name, val) => {\n            let valSource = typeof val === 'string' ? val : val.source;\n            valSource = valSource.replace(caret, '$1');\n            source = source.replace(name, valSource);\n            return obj;\n        },\n        getRegex: () => {\n            return new RegExp(source, opt);\n        }\n    };\n    return obj;\n}\nfunction cleanUrl(href) {\n    try {\n        href = encodeURI(href).replace(/%25/g, '%');\n    }\n    catch (e) {\n        return null;\n    }\n    return href;\n}\nconst noopTest = { exec: () => null };\nfunction splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n        let escaped = false;\n        let curr = offset;\n        while (--curr >= 0 && str[curr] === '\\\\')\n            escaped = !escaped;\n        if (escaped) {\n            // odd number of slashes means | is escaped\n            // so we leave it alone\n            return '|';\n        }\n        else {\n            // add space before unescaped |\n            return ' |';\n        }\n    }), cells = row.split(/ \\|/);\n    let i = 0;\n    // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n    if (!cells[0].trim()) {\n        cells.shift();\n    }\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n        cells.pop();\n    }\n    if (count) {\n        if (cells.length > count) {\n            cells.splice(count);\n        }\n        else {\n            while (cells.length < count)\n                cells.push('');\n        }\n    }\n    for (; i < cells.length; i++) {\n        // leading or trailing whitespace is ignored per the gfm spec\n        cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n    return cells;\n}\n/**\n * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n * /c*$/ is vulnerable to REDOS.\n *\n * @param str\n * @param c\n * @param invert Remove suffix of non-c chars instead. Default falsey.\n */\nfunction rtrim(str, c, invert) {\n    const l = str.length;\n    if (l === 0) {\n        return '';\n    }\n    // Length of suffix matching the invert condition.\n    let suffLen = 0;\n    // Step left until we fail to match the invert condition.\n    while (suffLen < l) {\n        const currChar = str.charAt(l - suffLen - 1);\n        if (currChar === c && !invert) {\n            suffLen++;\n        }\n        else if (currChar !== c && invert) {\n            suffLen++;\n        }\n        else {\n            break;\n        }\n    }\n    return str.slice(0, l - suffLen);\n}\nfunction findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n        return -1;\n    }\n    let level = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '\\\\') {\n            i++;\n        }\n        else if (str[i] === b[0]) {\n            level++;\n        }\n        else if (str[i] === b[1]) {\n            level--;\n            if (level < 0) {\n                return i;\n            }\n        }\n    }\n    return -1;\n}\n\nfunction outputLink(cap, link, raw, lexer) {\n    const href = link.href;\n    const title = link.title ? escape$1(link.title) : null;\n    const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n    if (cap[0].charAt(0) !== '!') {\n        lexer.state.inLink = true;\n        const token = {\n            type: 'link',\n            raw,\n            href,\n            title,\n            text,\n            tokens: lexer.inlineTokens(text)\n        };\n        lexer.state.inLink = false;\n        return token;\n    }\n    return {\n        type: 'image',\n        raw,\n        href,\n        title,\n        text: escape$1(text)\n    };\n}\nfunction indentCodeCompensation(raw, text) {\n    const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n    if (matchIndentToCode === null) {\n        return text;\n    }\n    const indentToCode = matchIndentToCode[1];\n    return text\n        .split('\\n')\n        .map(node => {\n        const matchIndentInNode = node.match(/^\\s+/);\n        if (matchIndentInNode === null) {\n            return node;\n        }\n        const [indentInNode] = matchIndentInNode;\n        if (indentInNode.length >= indentToCode.length) {\n            return node.slice(indentToCode.length);\n        }\n        return node;\n    })\n        .join('\\n');\n}\n/**\n * Tokenizer\n */\nclass _Tokenizer {\n    options;\n    rules; // set by the lexer\n    lexer; // set by the lexer\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    space(src) {\n        const cap = this.rules.block.newline.exec(src);\n        if (cap && cap[0].length > 0) {\n            return {\n                type: 'space',\n                raw: cap[0]\n            };\n        }\n    }\n    code(src) {\n        const cap = this.rules.block.code.exec(src);\n        if (cap) {\n            const text = cap[0].replace(/^ {1,4}/gm, '');\n            return {\n                type: 'code',\n                raw: cap[0],\n                codeBlockStyle: 'indented',\n                text: !this.options.pedantic\n                    ? rtrim(text, '\\n')\n                    : text\n            };\n        }\n    }\n    fences(src) {\n        const cap = this.rules.block.fences.exec(src);\n        if (cap) {\n            const raw = cap[0];\n            const text = indentCodeCompensation(raw, cap[3] || '');\n            return {\n                type: 'code',\n                raw,\n                lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, '$1') : cap[2],\n                text\n            };\n        }\n    }\n    heading(src) {\n        const cap = this.rules.block.heading.exec(src);\n        if (cap) {\n            let text = cap[2].trim();\n            // remove trailing #s\n            if (/#$/.test(text)) {\n                const trimmed = rtrim(text, '#');\n                if (this.options.pedantic) {\n                    text = trimmed.trim();\n                }\n                else if (!trimmed || / $/.test(trimmed)) {\n                    // CommonMark requires space before trailing #s\n                    text = trimmed.trim();\n                }\n            }\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[1].length,\n                text,\n                tokens: this.lexer.inline(text)\n            };\n        }\n    }\n    hr(src) {\n        const cap = this.rules.block.hr.exec(src);\n        if (cap) {\n            return {\n                type: 'hr',\n                raw: cap[0]\n            };\n        }\n    }\n    blockquote(src) {\n        const cap = this.rules.block.blockquote.exec(src);\n        if (cap) {\n            const text = rtrim(cap[0].replace(/^ *>[ \\t]?/gm, ''), '\\n');\n            const top = this.lexer.state.top;\n            this.lexer.state.top = true;\n            const tokens = this.lexer.blockTokens(text);\n            this.lexer.state.top = top;\n            return {\n                type: 'blockquote',\n                raw: cap[0],\n                tokens,\n                text\n            };\n        }\n    }\n    list(src) {\n        let cap = this.rules.block.list.exec(src);\n        if (cap) {\n            let bull = cap[1].trim();\n            const isordered = bull.length > 1;\n            const list = {\n                type: 'list',\n                raw: '',\n                ordered: isordered,\n                start: isordered ? +bull.slice(0, -1) : '',\n                loose: false,\n                items: []\n            };\n            bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n            if (this.options.pedantic) {\n                bull = isordered ? bull : '[*+-]';\n            }\n            // Get next list item\n            const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))`);\n            let raw = '';\n            let itemContents = '';\n            let endsWithBlankLine = false;\n            // Check if current bullet point can start a new List Item\n            while (src) {\n                let endEarly = false;\n                if (!(cap = itemRegex.exec(src))) {\n                    break;\n                }\n                if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)\n                    break;\n                }\n                raw = cap[0];\n                src = src.substring(raw.length);\n                let line = cap[2].split('\\n', 1)[0].replace(/^\\t+/, (t) => ' '.repeat(3 * t.length));\n                let nextLine = src.split('\\n', 1)[0];\n                let indent = 0;\n                if (this.options.pedantic) {\n                    indent = 2;\n                    itemContents = line.trimStart();\n                }\n                else {\n                    indent = cap[2].search(/[^ ]/); // Find first non-space char\n                    indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n                    itemContents = line.slice(indent);\n                    indent += cap[1].length;\n                }\n                let blankLine = false;\n                if (!line && /^ *$/.test(nextLine)) { // Items begin with at most one blank line\n                    raw += nextLine + '\\n';\n                    src = src.substring(nextLine.length + 1);\n                    endEarly = true;\n                }\n                if (!endEarly) {\n                    const nextBulletRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \\t][^\\\\n]*)?(?:\\\\n|$))`);\n                    const hrRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`);\n                    const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`);\n                    const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);\n                    // Check if following lines should be included in List Item\n                    while (src) {\n                        const rawLine = src.split('\\n', 1)[0];\n                        nextLine = rawLine;\n                        // Re-align to follow commonmark nesting rules\n                        if (this.options.pedantic) {\n                            nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n                        }\n                        // End list item if found code fences\n                        if (fencesBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new heading\n                        if (headingBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new bullet\n                        if (nextBulletRegex.test(nextLine)) {\n                            break;\n                        }\n                        // Horizontal rule found\n                        if (hrRegex.test(src)) {\n                            break;\n                        }\n                        if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible\n                            itemContents += '\\n' + nextLine.slice(indent);\n                        }\n                        else {\n                            // not enough indentation\n                            if (blankLine) {\n                                break;\n                            }\n                            // paragraph continuation unless last line was a different block level element\n                            if (line.search(/[^ ]/) >= 4) { // indented code block\n                                break;\n                            }\n                            if (fencesBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (headingBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (hrRegex.test(line)) {\n                                break;\n                            }\n                            itemContents += '\\n' + nextLine;\n                        }\n                        if (!blankLine && !nextLine.trim()) { // Check if current line is blank\n                            blankLine = true;\n                        }\n                        raw += rawLine + '\\n';\n                        src = src.substring(rawLine.length + 1);\n                        line = nextLine.slice(indent);\n                    }\n                }\n                if (!list.loose) {\n                    // If the previous item ended with a blank line, the list is loose\n                    if (endsWithBlankLine) {\n                        list.loose = true;\n                    }\n                    else if (/\\n *\\n *$/.test(raw)) {\n                        endsWithBlankLine = true;\n                    }\n                }\n                let istask = null;\n                let ischecked;\n                // Check for task list items\n                if (this.options.gfm) {\n                    istask = /^\\[[ xX]\\] /.exec(itemContents);\n                    if (istask) {\n                        ischecked = istask[0] !== '[ ] ';\n                        itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n                    }\n                }\n                list.items.push({\n                    type: 'list_item',\n                    raw,\n                    task: !!istask,\n                    checked: ischecked,\n                    loose: false,\n                    text: itemContents,\n                    tokens: []\n                });\n                list.raw += raw;\n            }\n            // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n            list.items[list.items.length - 1].raw = raw.trimEnd();\n            (list.items[list.items.length - 1]).text = itemContents.trimEnd();\n            list.raw = list.raw.trimEnd();\n            // Item child tokens handled here at end because we needed to have the final item to trim it first\n            for (let i = 0; i < list.items.length; i++) {\n                this.lexer.state.top = false;\n                list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n                if (!list.loose) {\n                    // Check if list should be loose\n                    const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n                    const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\\n.*\\n/.test(t.raw));\n                    list.loose = hasMultipleLineBreaks;\n                }\n            }\n            // Set all items to loose if list is loose\n            if (list.loose) {\n                for (let i = 0; i < list.items.length; i++) {\n                    list.items[i].loose = true;\n                }\n            }\n            return list;\n        }\n    }\n    html(src) {\n        const cap = this.rules.block.html.exec(src);\n        if (cap) {\n            const token = {\n                type: 'html',\n                block: true,\n                raw: cap[0],\n                pre: cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style',\n                text: cap[0]\n            };\n            return token;\n        }\n    }\n    def(src) {\n        const cap = this.rules.block.def.exec(src);\n        if (cap) {\n            const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n            const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline.anyPunctuation, '$1') : '';\n            const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation, '$1') : cap[3];\n            return {\n                type: 'def',\n                tag,\n                raw: cap[0],\n                href,\n                title\n            };\n        }\n    }\n    table(src) {\n        const cap = this.rules.block.table.exec(src);\n        if (!cap) {\n            return;\n        }\n        if (!/[:|]/.test(cap[2])) {\n            // delimiter row must have a pipe (|) or colon (:) otherwise it is a setext heading\n            return;\n        }\n        const headers = splitCells(cap[1]);\n        const aligns = cap[2].replace(/^\\||\\| *$/g, '').split('|');\n        const rows = cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : [];\n        const item = {\n            type: 'table',\n            raw: cap[0],\n            header: [],\n            align: [],\n            rows: []\n        };\n        if (headers.length !== aligns.length) {\n            // header and align columns must be equal, rows can be different.\n            return;\n        }\n        for (const align of aligns) {\n            if (/^ *-+: *$/.test(align)) {\n                item.align.push('right');\n            }\n            else if (/^ *:-+: *$/.test(align)) {\n                item.align.push('center');\n            }\n            else if (/^ *:-+ *$/.test(align)) {\n                item.align.push('left');\n            }\n            else {\n                item.align.push(null);\n            }\n        }\n        for (const header of headers) {\n            item.header.push({\n                text: header,\n                tokens: this.lexer.inline(header)\n            });\n        }\n        for (const row of rows) {\n            item.rows.push(splitCells(row, item.header.length).map(cell => {\n                return {\n                    text: cell,\n                    tokens: this.lexer.inline(cell)\n                };\n            }));\n        }\n        return item;\n    }\n    lheading(src) {\n        const cap = this.rules.block.lheading.exec(src);\n        if (cap) {\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[2].charAt(0) === '=' ? 1 : 2,\n                text: cap[1],\n                tokens: this.lexer.inline(cap[1])\n            };\n        }\n    }\n    paragraph(src) {\n        const cap = this.rules.block.paragraph.exec(src);\n        if (cap) {\n            const text = cap[1].charAt(cap[1].length - 1) === '\\n'\n                ? cap[1].slice(0, -1)\n                : cap[1];\n            return {\n                type: 'paragraph',\n                raw: cap[0],\n                text,\n                tokens: this.lexer.inline(text)\n            };\n        }\n    }\n    text(src) {\n        const cap = this.rules.block.text.exec(src);\n        if (cap) {\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                tokens: this.lexer.inline(cap[0])\n            };\n        }\n    }\n    escape(src) {\n        const cap = this.rules.inline.escape.exec(src);\n        if (cap) {\n            return {\n                type: 'escape',\n                raw: cap[0],\n                text: escape$1(cap[1])\n            };\n        }\n    }\n    tag(src) {\n        const cap = this.rules.inline.tag.exec(src);\n        if (cap) {\n            if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n                this.lexer.state.inLink = true;\n            }\n            else if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n                this.lexer.state.inLink = false;\n            }\n            if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = true;\n            }\n            else if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = false;\n            }\n            return {\n                type: 'html',\n                raw: cap[0],\n                inLink: this.lexer.state.inLink,\n                inRawBlock: this.lexer.state.inRawBlock,\n                block: false,\n                text: cap[0]\n            };\n        }\n    }\n    link(src) {\n        const cap = this.rules.inline.link.exec(src);\n        if (cap) {\n            const trimmedUrl = cap[2].trim();\n            if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n                // commonmark requires matching angle brackets\n                if (!(/>$/.test(trimmedUrl))) {\n                    return;\n                }\n                // ending angle bracket cannot be escaped\n                const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n                if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n                    return;\n                }\n            }\n            else {\n                // find closing parenthesis\n                const lastParenIndex = findClosingBracket(cap[2], '()');\n                if (lastParenIndex > -1) {\n                    const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n                    const linkLen = start + cap[1].length + lastParenIndex;\n                    cap[2] = cap[2].substring(0, lastParenIndex);\n                    cap[0] = cap[0].substring(0, linkLen).trim();\n                    cap[3] = '';\n                }\n            }\n            let href = cap[2];\n            let title = '';\n            if (this.options.pedantic) {\n                // split pedantic href and title\n                const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n                if (link) {\n                    href = link[1];\n                    title = link[3];\n                }\n            }\n            else {\n                title = cap[3] ? cap[3].slice(1, -1) : '';\n            }\n            href = href.trim();\n            if (/^</.test(href)) {\n                if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {\n                    // pedantic allows starting angle bracket without ending angle bracket\n                    href = href.slice(1);\n                }\n                else {\n                    href = href.slice(1, -1);\n                }\n            }\n            return outputLink(cap, {\n                href: href ? href.replace(this.rules.inline.anyPunctuation, '$1') : href,\n                title: title ? title.replace(this.rules.inline.anyPunctuation, '$1') : title\n            }, cap[0], this.lexer);\n        }\n    }\n    reflink(src, links) {\n        let cap;\n        if ((cap = this.rules.inline.reflink.exec(src))\n            || (cap = this.rules.inline.nolink.exec(src))) {\n            const linkString = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n            const link = links[linkString.toLowerCase()];\n            if (!link) {\n                const text = cap[0].charAt(0);\n                return {\n                    type: 'text',\n                    raw: text,\n                    text\n                };\n            }\n            return outputLink(cap, link, cap[0], this.lexer);\n        }\n    }\n    emStrong(src, maskedSrc, prevChar = '') {\n        let match = this.rules.inline.emStrongLDelim.exec(src);\n        if (!match)\n            return;\n        // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n        if (match[3] && prevChar.match(/[\\p{L}\\p{N}]/u))\n            return;\n        const nextChar = match[1] || match[2] || '';\n        if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\n            // unicode Regex counts emoji as 1 char; spread into array for proper count (used multiple times below)\n            const lLength = [...match[0]].length - 1;\n            let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\n            const endReg = match[0][0] === '*' ? this.rules.inline.emStrongRDelimAst : this.rules.inline.emStrongRDelimUnd;\n            endReg.lastIndex = 0;\n            // Clip maskedSrc to same section of string as src (move to lexer?)\n            maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n            while ((match = endReg.exec(maskedSrc)) != null) {\n                rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n                if (!rDelim)\n                    continue; // skip single * in __abc*abc__\n                rLength = [...rDelim].length;\n                if (match[3] || match[4]) { // found another Left Delim\n                    delimTotal += rLength;\n                    continue;\n                }\n                else if (match[5] || match[6]) { // either Left or Right Delim\n                    if (lLength % 3 && !((lLength + rLength) % 3)) {\n                        midDelimTotal += rLength;\n                        continue; // CommonMark Emphasis Rules 9-10\n                    }\n                }\n                delimTotal -= rLength;\n                if (delimTotal > 0)\n                    continue; // Haven't found enough closing delimiters\n                // Remove extra characters. *a*** -> *a*\n                rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n                // char length can be >1 for unicode characters;\n                const lastCharLength = [...match[0]][0].length;\n                const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\n                // Create `em` if smallest delimiter has odd char count. *a***\n                if (Math.min(lLength, rLength) % 2) {\n                    const text = raw.slice(1, -1);\n                    return {\n                        type: 'em',\n                        raw,\n                        text,\n                        tokens: this.lexer.inlineTokens(text)\n                    };\n                }\n                // Create 'strong' if smallest delimiter has even char count. **a***\n                const text = raw.slice(2, -2);\n                return {\n                    type: 'strong',\n                    raw,\n                    text,\n                    tokens: this.lexer.inlineTokens(text)\n                };\n            }\n        }\n    }\n    codespan(src) {\n        const cap = this.rules.inline.code.exec(src);\n        if (cap) {\n            let text = cap[2].replace(/\\n/g, ' ');\n            const hasNonSpaceChars = /[^ ]/.test(text);\n            const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n            if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n                text = text.substring(1, text.length - 1);\n            }\n            text = escape$1(text, true);\n            return {\n                type: 'codespan',\n                raw: cap[0],\n                text\n            };\n        }\n    }\n    br(src) {\n        const cap = this.rules.inline.br.exec(src);\n        if (cap) {\n            return {\n                type: 'br',\n                raw: cap[0]\n            };\n        }\n    }\n    del(src) {\n        const cap = this.rules.inline.del.exec(src);\n        if (cap) {\n            return {\n                type: 'del',\n                raw: cap[0],\n                text: cap[2],\n                tokens: this.lexer.inlineTokens(cap[2])\n            };\n        }\n    }\n    autolink(src) {\n        const cap = this.rules.inline.autolink.exec(src);\n        if (cap) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape$1(cap[1]);\n                href = 'mailto:' + text;\n            }\n            else {\n                text = escape$1(cap[1]);\n                href = text;\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text\n                    }\n                ]\n            };\n        }\n    }\n    url(src) {\n        let cap;\n        if (cap = this.rules.inline.url.exec(src)) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape$1(cap[0]);\n                href = 'mailto:' + text;\n            }\n            else {\n                // do extended autolink path validation\n                let prevCapZero;\n                do {\n                    prevCapZero = cap[0];\n                    cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? '';\n                } while (prevCapZero !== cap[0]);\n                text = escape$1(cap[0]);\n                if (cap[1] === 'www.') {\n                    href = 'http://' + cap[0];\n                }\n                else {\n                    href = cap[0];\n                }\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text\n                    }\n                ]\n            };\n        }\n    }\n    inlineText(src) {\n        const cap = this.rules.inline.text.exec(src);\n        if (cap) {\n            let text;\n            if (this.lexer.state.inRawBlock) {\n                text = cap[0];\n            }\n            else {\n                text = escape$1(cap[0]);\n            }\n            return {\n                type: 'text',\n                raw: cap[0],\n                text\n            };\n        }\n    }\n}\n\n/**\n * Block-Level Grammar\n */\nconst newline = /^(?: *(?:\\n|$))+/;\nconst blockCode = /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/;\nconst fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\nconst hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\nconst heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\nconst bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nconst lheading = edit(/^(?!bull )((?:.|\\n(?!\\s*?\\n|bull ))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .getRegex();\nconst _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\nconst blockText = /^[^\\n]+/;\nconst _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nconst def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n *)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/)\n    .replace('label', _blockLabel)\n    .replace('title', /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/)\n    .getRegex();\nconst list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/)\n    .replace(/bull/g, bullet)\n    .getRegex();\nconst _tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n    + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n    + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n    + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n    + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr'\n    + '|track|ul';\nconst _comment = /<!--(?!-?>)[\\s\\S]*?(?:-->|$)/;\nconst html = edit('^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) closing tag\n    + ')', 'i')\n    .replace('comment', _comment)\n    .replace('tag', _tag)\n    .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst paragraph = edit(_paragraph)\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n    .replace('|table', '')\n    .replace('blockquote', ' {0,3}>')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/)\n    .replace('paragraph', paragraph)\n    .getRegex();\n/**\n * Normal Block Grammar\n */\nconst blockNormal = {\n    blockquote,\n    code: blockCode,\n    def,\n    fences,\n    heading,\n    hr,\n    html,\n    lheading,\n    list,\n    newline,\n    paragraph,\n    table: noopTest,\n    text: blockText\n};\n/**\n * GFM Block Grammar\n */\nconst gfmTable = edit('^ *([^\\\\n ].*)\\\\n' // Header\n    + ' {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)') // Cells\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('blockquote', ' {0,3}>')\n    .replace('code', ' {4}[^\\\\n]')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // tables can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockGfm = {\n    ...blockNormal,\n    table: gfmTable,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n        .replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n        .replace('table', gfmTable) // interrupt paragraphs with table\n        .replace('blockquote', ' {0,3}>')\n        .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n        .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n        .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n        .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n        .getRegex()\n};\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\nconst blockPedantic = {\n    ...blockNormal,\n    html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)'\n        + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n        + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n        .replace('comment', _comment)\n        .replace(/tag/g, '(?!(?:'\n        + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n        + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n        + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n        .getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest, // fences not supported\n    lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' *#{1,6} *[^\\n]')\n        .replace('lheading', lheading)\n        .replace('|table', '')\n        .replace('blockquote', ' {0,3}>')\n        .replace('|fences', '')\n        .replace('|list', '')\n        .replace('|html', '')\n        .replace('|tag', '')\n        .getRegex()\n};\n/**\n * Inline-Level Grammar\n */\nconst escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\nconst inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\nconst br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\nconst inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\n// list of unicode punctuation marks, plus any missing characters from CommonMark spec\nconst _punctuation = '\\\\p{P}$+<=>`^|~';\nconst punctuation = edit(/^((?![*_])[\\spunctuation])/, 'u')\n    .replace(/punctuation/g, _punctuation).getRegex();\n// sequences em should skip over [title](link), `code`, <html>\nconst blockSkip = /\\[[^[\\]]*?\\]\\([^\\(\\)]*?\\)|`[^`]*?`|<[^<>]*?>/g;\nconst emStrongLDelim = edit(/^(?:\\*+(?:((?!\\*)[punct])|[^\\s*]))|^_+(?:((?!_)[punct])|([^\\s_]))/, 'u')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst emStrongRDelimAst = edit('^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)' // Skip orphan inside strong\n    + '|[^*]+(?=[^*])' // Consume to delim\n    + '|(?!\\\\*)[punct](\\\\*+)(?=[\\\\s]|$)' // (1) #*** can only be a Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?!\\\\*)(?=[punct\\\\s]|$)' // (2) a***#, a*** can only be a Right Delimiter\n    + '|(?!\\\\*)[punct\\\\s](\\\\*+)(?=[^punct\\\\s])' // (3) #***a, ***a can only be Left Delimiter\n    + '|[\\\\s](\\\\*+)(?!\\\\*)(?=[punct])' // (4) ***# can only be Left Delimiter\n    + '|(?!\\\\*)[punct](\\\\*+)(?!\\\\*)(?=[punct])' // (5) #***# can be either Left or Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?=[^punct\\\\s])', 'gu') // (6) a***a can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n// (6) Not allowed for _\nconst emStrongRDelimUnd = edit('^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)' // Skip orphan inside strong\n    + '|[^_]+(?=[^_])' // Consume to delim\n    + '|(?!_)[punct](_+)(?=[\\\\s]|$)' // (1) #___ can only be a Right Delimiter\n    + '|[^punct\\\\s](_+)(?!_)(?=[punct\\\\s]|$)' // (2) a___#, a___ can only be a Right Delimiter\n    + '|(?!_)[punct\\\\s](_+)(?=[^punct\\\\s])' // (3) #___a, ___a can only be Left Delimiter\n    + '|[\\\\s](_+)(?!_)(?=[punct])' // (4) ___# can only be Left Delimiter\n    + '|(?!_)[punct](_+)(?!_)(?=[punct])', 'gu') // (5) #___# can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst anyPunctuation = edit(/\\\\([punct])/, 'gu')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/)\n    .replace('scheme', /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/)\n    .replace('email', /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/)\n    .getRegex();\nconst _inlineComment = edit(_comment).replace('(?:-->|$)', '-->').getRegex();\nconst tag = edit('^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>') // CDATA section\n    .replace('comment', _inlineComment)\n    .replace('attribute', /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\nconst link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/)\n    .replace('label', _inlineLabel)\n    .replace('href', /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/)\n    .replace('title', /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/)\n    .getRegex();\nconst reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/)\n    .replace('label', _inlineLabel)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst reflinkSearch = edit('reflink|nolink(?!\\\\()', 'g')\n    .replace('reflink', reflink)\n    .replace('nolink', nolink)\n    .getRegex();\n/**\n * Normal Inline Grammar\n */\nconst inlineNormal = {\n    _backpedal: noopTest, // only used for GFM url\n    anyPunctuation,\n    autolink,\n    blockSkip,\n    br,\n    code: inlineCode,\n    del: noopTest,\n    emStrongLDelim,\n    emStrongRDelimAst,\n    emStrongRDelimUnd,\n    escape,\n    link,\n    nolink,\n    punctuation,\n    reflink,\n    reflinkSearch,\n    tag,\n    text: inlineText,\n    url: noopTest\n};\n/**\n * Pedantic Inline Grammar\n */\nconst inlinePedantic = {\n    ...inlineNormal,\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n        .replace('label', _inlineLabel)\n        .getRegex()\n};\n/**\n * GFM Inline Grammar\n */\nconst inlineGfm = {\n    ...inlineNormal,\n    escape: edit(escape).replace('])', '~|])').getRegex(),\n    url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, 'i')\n        .replace('email', /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/)\n        .getRegex(),\n    _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\n};\n/**\n * GFM + Line Breaks Inline Grammar\n */\nconst inlineBreaks = {\n    ...inlineGfm,\n    br: edit(br).replace('{2,}', '*').getRegex(),\n    text: edit(inlineGfm.text)\n        .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n        .replace(/\\{2,\\}/g, '*')\n        .getRegex()\n};\n/**\n * exports\n */\nconst block = {\n    normal: blockNormal,\n    gfm: blockGfm,\n    pedantic: blockPedantic\n};\nconst inline = {\n    normal: inlineNormal,\n    gfm: inlineGfm,\n    breaks: inlineBreaks,\n    pedantic: inlinePedantic\n};\n\n/**\n * Block Lexer\n */\nclass _Lexer {\n    tokens;\n    options;\n    state;\n    tokenizer;\n    inlineQueue;\n    constructor(options) {\n        // TokenList cannot be created in one go\n        this.tokens = [];\n        this.tokens.links = Object.create(null);\n        this.options = options || _defaults;\n        this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\n        this.tokenizer = this.options.tokenizer;\n        this.tokenizer.options = this.options;\n        this.tokenizer.lexer = this;\n        this.inlineQueue = [];\n        this.state = {\n            inLink: false,\n            inRawBlock: false,\n            top: true\n        };\n        const rules = {\n            block: block.normal,\n            inline: inline.normal\n        };\n        if (this.options.pedantic) {\n            rules.block = block.pedantic;\n            rules.inline = inline.pedantic;\n        }\n        else if (this.options.gfm) {\n            rules.block = block.gfm;\n            if (this.options.breaks) {\n                rules.inline = inline.breaks;\n            }\n            else {\n                rules.inline = inline.gfm;\n            }\n        }\n        this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n    static get rules() {\n        return {\n            block,\n            inline\n        };\n    }\n    /**\n     * Static Lex Method\n     */\n    static lex(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    static lexInline(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    lex(src) {\n        src = src\n            .replace(/\\r\\n|\\r/g, '\\n');\n        this.blockTokens(src, this.tokens);\n        for (let i = 0; i < this.inlineQueue.length; i++) {\n            const next = this.inlineQueue[i];\n            this.inlineTokens(next.src, next.tokens);\n        }\n        this.inlineQueue = [];\n        return this.tokens;\n    }\n    blockTokens(src, tokens = []) {\n        if (this.options.pedantic) {\n            src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n        }\n        else {\n            src = src.replace(/^( *)(\\t+)/gm, (_, leading, tabs) => {\n                return leading + '    '.repeat(tabs.length);\n            });\n        }\n        let token;\n        let lastToken;\n        let cutSrc;\n        let lastParagraphClipped;\n        while (src) {\n            if (this.options.extensions\n                && this.options.extensions.block\n                && this.options.extensions.block.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // newline\n            if (token = this.tokenizer.space(src)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.length === 1 && tokens.length > 0) {\n                    // if there's a single \\n as a spacer, it's terminating the last line,\n                    // so move it there so that we don't get unnecessary paragraph tags\n                    tokens[tokens.length - 1].raw += '\\n';\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.code(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                // An indented code block cannot interrupt a paragraph.\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // fences\n            if (token = this.tokenizer.fences(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // heading\n            if (token = this.tokenizer.heading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // hr\n            if (token = this.tokenizer.hr(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // blockquote\n            if (token = this.tokenizer.blockquote(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // list\n            if (token = this.tokenizer.list(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // html\n            if (token = this.tokenizer.html(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // def\n            if (token = this.tokenizer.def(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.raw;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else if (!this.tokens.links[token.tag]) {\n                    this.tokens.links[token.tag] = {\n                        href: token.href,\n                        title: token.title\n                    };\n                }\n                continue;\n            }\n            // table (gfm)\n            if (token = this.tokenizer.table(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // lheading\n            if (token = this.tokenizer.lheading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // top-level paragraph\n            // prevent paragraph consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startBlock) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startBlock.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n                lastToken = tokens[tokens.length - 1];\n                if (lastParagraphClipped && lastToken.type === 'paragraph') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                lastParagraphClipped = (cutSrc.length !== src.length);\n                src = src.substring(token.raw.length);\n                continue;\n            }\n            // text\n            if (token = this.tokenizer.text(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        this.state.top = true;\n        return tokens;\n    }\n    inline(src, tokens = []) {\n        this.inlineQueue.push({ src, tokens });\n        return tokens;\n    }\n    /**\n     * Lexing/Compiling\n     */\n    inlineTokens(src, tokens = []) {\n        let token, lastToken, cutSrc;\n        // String with links masked to avoid interference with em and strong\n        let maskedSrc = src;\n        let match;\n        let keepPrevChar, prevChar;\n        // Mask out reflinks\n        if (this.tokens.links) {\n            const links = Object.keys(this.tokens.links);\n            if (links.length > 0) {\n                while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n                    if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n                        maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n                    }\n                }\n            }\n        }\n        // Mask out other blocks\n        while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n        }\n        // Mask out escaped characters\n        while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);\n        }\n        while (src) {\n            if (!keepPrevChar) {\n                prevChar = '';\n            }\n            keepPrevChar = false;\n            // extensions\n            if (this.options.extensions\n                && this.options.extensions.inline\n                && this.options.extensions.inline.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // escape\n            if (token = this.tokenizer.escape(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // tag\n            if (token = this.tokenizer.tag(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // link\n            if (token = this.tokenizer.link(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // reflink, nolink\n            if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // em & strong\n            if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.codespan(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // br\n            if (token = this.tokenizer.br(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // del (gfm)\n            if (token = this.tokenizer.del(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // autolink\n            if (token = this.tokenizer.autolink(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // url (gfm)\n            if (!this.state.inLink && (token = this.tokenizer.url(src))) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // text\n            // prevent inlineText consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startInline) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startInline.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (token = this.tokenizer.inlineText(cutSrc)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started\n                    prevChar = token.raw.slice(-1);\n                }\n                keepPrevChar = true;\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        return tokens;\n    }\n}\n\n/**\n * Renderer\n */\nclass _Renderer {\n    options;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    code(code, infostring, escaped) {\n        const lang = (infostring || '').match(/^\\S*/)?.[0];\n        code = code.replace(/\\n$/, '') + '\\n';\n        if (!lang) {\n            return '<pre><code>'\n                + (escaped ? code : escape$1(code, true))\n                + '</code></pre>\\n';\n        }\n        return '<pre><code class=\"language-'\n            + escape$1(lang)\n            + '\">'\n            + (escaped ? code : escape$1(code, true))\n            + '</code></pre>\\n';\n    }\n    blockquote(quote) {\n        return `<blockquote>\\n${quote}</blockquote>\\n`;\n    }\n    html(html, block) {\n        return html;\n    }\n    heading(text, level, raw) {\n        // ignore IDs\n        return `<h${level}>${text}</h${level}>\\n`;\n    }\n    hr() {\n        return '<hr>\\n';\n    }\n    list(body, ordered, start) {\n        const type = ordered ? 'ol' : 'ul';\n        const startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n        return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    }\n    listitem(text, task, checked) {\n        return `<li>${text}</li>\\n`;\n    }\n    checkbox(checked) {\n        return '<input '\n            + (checked ? 'checked=\"\" ' : '')\n            + 'disabled=\"\" type=\"checkbox\">';\n    }\n    paragraph(text) {\n        return `<p>${text}</p>\\n`;\n    }\n    table(header, body) {\n        if (body)\n            body = `<tbody>${body}</tbody>`;\n        return '<table>\\n'\n            + '<thead>\\n'\n            + header\n            + '</thead>\\n'\n            + body\n            + '</table>\\n';\n    }\n    tablerow(content) {\n        return `<tr>\\n${content}</tr>\\n`;\n    }\n    tablecell(content, flags) {\n        const type = flags.header ? 'th' : 'td';\n        const tag = flags.align\n            ? `<${type} align=\"${flags.align}\">`\n            : `<${type}>`;\n        return tag + content + `</${type}>\\n`;\n    }\n    /**\n     * span level renderer\n     */\n    strong(text) {\n        return `<strong>${text}</strong>`;\n    }\n    em(text) {\n        return `<em>${text}</em>`;\n    }\n    codespan(text) {\n        return `<code>${text}</code>`;\n    }\n    br() {\n        return '<br>';\n    }\n    del(text) {\n        return `<del>${text}</del>`;\n    }\n    link(href, title, text) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = '<a href=\"' + href + '\"';\n        if (title) {\n            out += ' title=\"' + title + '\"';\n        }\n        out += '>' + text + '</a>';\n        return out;\n    }\n    image(href, title, text) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = `<img src=\"${href}\" alt=\"${text}\"`;\n        if (title) {\n            out += ` title=\"${title}\"`;\n        }\n        out += '>';\n        return out;\n    }\n    text(text) {\n        return text;\n    }\n}\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\nclass _TextRenderer {\n    // no need for block level renderers\n    strong(text) {\n        return text;\n    }\n    em(text) {\n        return text;\n    }\n    codespan(text) {\n        return text;\n    }\n    del(text) {\n        return text;\n    }\n    html(text) {\n        return text;\n    }\n    text(text) {\n        return text;\n    }\n    link(href, title, text) {\n        return '' + text;\n    }\n    image(href, title, text) {\n        return '' + text;\n    }\n    br() {\n        return '';\n    }\n}\n\n/**\n * Parsing & Compiling\n */\nclass _Parser {\n    options;\n    renderer;\n    textRenderer;\n    constructor(options) {\n        this.options = options || _defaults;\n        this.options.renderer = this.options.renderer || new _Renderer();\n        this.renderer = this.options.renderer;\n        this.renderer.options = this.options;\n        this.textRenderer = new _TextRenderer();\n    }\n    /**\n     * Static Parse Method\n     */\n    static parse(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    static parseInline(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    parse(tokens, top = true) {\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n                const genericToken = token;\n                const ret = this.options.extensions.renderers[genericToken.type].call({ parser: this }, genericToken);\n                if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(genericToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            switch (token.type) {\n                case 'space': {\n                    continue;\n                }\n                case 'hr': {\n                    out += this.renderer.hr();\n                    continue;\n                }\n                case 'heading': {\n                    const headingToken = token;\n                    out += this.renderer.heading(this.parseInline(headingToken.tokens), headingToken.depth, unescape(this.parseInline(headingToken.tokens, this.textRenderer)));\n                    continue;\n                }\n                case 'code': {\n                    const codeToken = token;\n                    out += this.renderer.code(codeToken.text, codeToken.lang, !!codeToken.escaped);\n                    continue;\n                }\n                case 'table': {\n                    const tableToken = token;\n                    let header = '';\n                    // header\n                    let cell = '';\n                    for (let j = 0; j < tableToken.header.length; j++) {\n                        cell += this.renderer.tablecell(this.parseInline(tableToken.header[j].tokens), { header: true, align: tableToken.align[j] });\n                    }\n                    header += this.renderer.tablerow(cell);\n                    let body = '';\n                    for (let j = 0; j < tableToken.rows.length; j++) {\n                        const row = tableToken.rows[j];\n                        cell = '';\n                        for (let k = 0; k < row.length; k++) {\n                            cell += this.renderer.tablecell(this.parseInline(row[k].tokens), { header: false, align: tableToken.align[k] });\n                        }\n                        body += this.renderer.tablerow(cell);\n                    }\n                    out += this.renderer.table(header, body);\n                    continue;\n                }\n                case 'blockquote': {\n                    const blockquoteToken = token;\n                    const body = this.parse(blockquoteToken.tokens);\n                    out += this.renderer.blockquote(body);\n                    continue;\n                }\n                case 'list': {\n                    const listToken = token;\n                    const ordered = listToken.ordered;\n                    const start = listToken.start;\n                    const loose = listToken.loose;\n                    let body = '';\n                    for (let j = 0; j < listToken.items.length; j++) {\n                        const item = listToken.items[j];\n                        const checked = item.checked;\n                        const task = item.task;\n                        let itemBody = '';\n                        if (item.task) {\n                            const checkbox = this.renderer.checkbox(!!checked);\n                            if (loose) {\n                                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                                    }\n                                }\n                                else {\n                                    item.tokens.unshift({\n                                        type: 'text',\n                                        text: checkbox + ' '\n                                    });\n                                }\n                            }\n                            else {\n                                itemBody += checkbox + ' ';\n                            }\n                        }\n                        itemBody += this.parse(item.tokens, loose);\n                        body += this.renderer.listitem(itemBody, task, !!checked);\n                    }\n                    out += this.renderer.list(body, ordered, start);\n                    continue;\n                }\n                case 'html': {\n                    const htmlToken = token;\n                    out += this.renderer.html(htmlToken.text, htmlToken.block);\n                    continue;\n                }\n                case 'paragraph': {\n                    const paragraphToken = token;\n                    out += this.renderer.paragraph(this.parseInline(paragraphToken.tokens));\n                    continue;\n                }\n                case 'text': {\n                    let textToken = token;\n                    let body = textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text;\n                    while (i + 1 < tokens.length && tokens[i + 1].type === 'text') {\n                        textToken = tokens[++i];\n                        body += '\\n' + (textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text);\n                    }\n                    out += top ? this.renderer.paragraph(body) : body;\n                    continue;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    parseInline(tokens, renderer) {\n        renderer = renderer || this.renderer;\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n                const ret = this.options.extensions.renderers[token.type].call({ parser: this }, token);\n                if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            switch (token.type) {\n                case 'escape': {\n                    const escapeToken = token;\n                    out += renderer.text(escapeToken.text);\n                    break;\n                }\n                case 'html': {\n                    const tagToken = token;\n                    out += renderer.html(tagToken.text);\n                    break;\n                }\n                case 'link': {\n                    const linkToken = token;\n                    out += renderer.link(linkToken.href, linkToken.title, this.parseInline(linkToken.tokens, renderer));\n                    break;\n                }\n                case 'image': {\n                    const imageToken = token;\n                    out += renderer.image(imageToken.href, imageToken.title, imageToken.text);\n                    break;\n                }\n                case 'strong': {\n                    const strongToken = token;\n                    out += renderer.strong(this.parseInline(strongToken.tokens, renderer));\n                    break;\n                }\n                case 'em': {\n                    const emToken = token;\n                    out += renderer.em(this.parseInline(emToken.tokens, renderer));\n                    break;\n                }\n                case 'codespan': {\n                    const codespanToken = token;\n                    out += renderer.codespan(codespanToken.text);\n                    break;\n                }\n                case 'br': {\n                    out += renderer.br();\n                    break;\n                }\n                case 'del': {\n                    const delToken = token;\n                    out += renderer.del(this.parseInline(delToken.tokens, renderer));\n                    break;\n                }\n                case 'text': {\n                    const textToken = token;\n                    out += renderer.text(textToken.text);\n                    break;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n}\n\nclass _Hooks {\n    options;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    static passThroughHooks = new Set([\n        'preprocess',\n        'postprocess',\n        'processAllTokens'\n    ]);\n    /**\n     * Process markdown before marked\n     */\n    preprocess(markdown) {\n        return markdown;\n    }\n    /**\n     * Process HTML after marked is finished\n     */\n    postprocess(html) {\n        return html;\n    }\n    /**\n     * Process all tokens before walk tokens\n     */\n    processAllTokens(tokens) {\n        return tokens;\n    }\n}\n\nclass Marked {\n    defaults = _getDefaults();\n    options = this.setOptions;\n    parse = this.#parseMarkdown(_Lexer.lex, _Parser.parse);\n    parseInline = this.#parseMarkdown(_Lexer.lexInline, _Parser.parseInline);\n    Parser = _Parser;\n    Renderer = _Renderer;\n    TextRenderer = _TextRenderer;\n    Lexer = _Lexer;\n    Tokenizer = _Tokenizer;\n    Hooks = _Hooks;\n    constructor(...args) {\n        this.use(...args);\n    }\n    /**\n     * Run callback for every token\n     */\n    walkTokens(tokens, callback) {\n        let values = [];\n        for (const token of tokens) {\n            values = values.concat(callback.call(this, token));\n            switch (token.type) {\n                case 'table': {\n                    const tableToken = token;\n                    for (const cell of tableToken.header) {\n                        values = values.concat(this.walkTokens(cell.tokens, callback));\n                    }\n                    for (const row of tableToken.rows) {\n                        for (const cell of row) {\n                            values = values.concat(this.walkTokens(cell.tokens, callback));\n                        }\n                    }\n                    break;\n                }\n                case 'list': {\n                    const listToken = token;\n                    values = values.concat(this.walkTokens(listToken.items, callback));\n                    break;\n                }\n                default: {\n                    const genericToken = token;\n                    if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\n                        this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\n                            const tokens = genericToken[childTokens].flat(Infinity);\n                            values = values.concat(this.walkTokens(tokens, callback));\n                        });\n                    }\n                    else if (genericToken.tokens) {\n                        values = values.concat(this.walkTokens(genericToken.tokens, callback));\n                    }\n                }\n            }\n        }\n        return values;\n    }\n    use(...args) {\n        const extensions = this.defaults.extensions || { renderers: {}, childTokens: {} };\n        args.forEach((pack) => {\n            // copy options to new object\n            const opts = { ...pack };\n            // set async to true if it was set to true before\n            opts.async = this.defaults.async || opts.async || false;\n            // ==-- Parse \"addon\" extensions --== //\n            if (pack.extensions) {\n                pack.extensions.forEach((ext) => {\n                    if (!ext.name) {\n                        throw new Error('extension name required');\n                    }\n                    if ('renderer' in ext) { // Renderer extensions\n                        const prevRenderer = extensions.renderers[ext.name];\n                        if (prevRenderer) {\n                            // Replace extension with func to run new extension but fall back if false\n                            extensions.renderers[ext.name] = function (...args) {\n                                let ret = ext.renderer.apply(this, args);\n                                if (ret === false) {\n                                    ret = prevRenderer.apply(this, args);\n                                }\n                                return ret;\n                            };\n                        }\n                        else {\n                            extensions.renderers[ext.name] = ext.renderer;\n                        }\n                    }\n                    if ('tokenizer' in ext) { // Tokenizer Extensions\n                        if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {\n                            throw new Error(\"extension level must be 'block' or 'inline'\");\n                        }\n                        const extLevel = extensions[ext.level];\n                        if (extLevel) {\n                            extLevel.unshift(ext.tokenizer);\n                        }\n                        else {\n                            extensions[ext.level] = [ext.tokenizer];\n                        }\n                        if (ext.start) { // Function to check for start of token\n                            if (ext.level === 'block') {\n                                if (extensions.startBlock) {\n                                    extensions.startBlock.push(ext.start);\n                                }\n                                else {\n                                    extensions.startBlock = [ext.start];\n                                }\n                            }\n                            else if (ext.level === 'inline') {\n                                if (extensions.startInline) {\n                                    extensions.startInline.push(ext.start);\n                                }\n                                else {\n                                    extensions.startInline = [ext.start];\n                                }\n                            }\n                        }\n                    }\n                    if ('childTokens' in ext && ext.childTokens) { // Child tokens to be visited by walkTokens\n                        extensions.childTokens[ext.name] = ext.childTokens;\n                    }\n                });\n                opts.extensions = extensions;\n            }\n            // ==-- Parse \"overwrite\" extensions --== //\n            if (pack.renderer) {\n                const renderer = this.defaults.renderer || new _Renderer(this.defaults);\n                for (const prop in pack.renderer) {\n                    if (!(prop in renderer)) {\n                        throw new Error(`renderer '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const rendererProp = prop;\n                    const rendererFunc = pack.renderer[rendererProp];\n                    const prevRenderer = renderer[rendererProp];\n                    // Replace renderer with func to run extension, but fall back if false\n                    renderer[rendererProp] = (...args) => {\n                        let ret = rendererFunc.apply(renderer, args);\n                        if (ret === false) {\n                            ret = prevRenderer.apply(renderer, args);\n                        }\n                        return ret || '';\n                    };\n                }\n                opts.renderer = renderer;\n            }\n            if (pack.tokenizer) {\n                const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\n                for (const prop in pack.tokenizer) {\n                    if (!(prop in tokenizer)) {\n                        throw new Error(`tokenizer '${prop}' does not exist`);\n                    }\n                    if (['options', 'rules', 'lexer'].includes(prop)) {\n                        // ignore options, rules, and lexer properties\n                        continue;\n                    }\n                    const tokenizerProp = prop;\n                    const tokenizerFunc = pack.tokenizer[tokenizerProp];\n                    const prevTokenizer = tokenizer[tokenizerProp];\n                    // Replace tokenizer with func to run extension, but fall back if false\n                    // @ts-expect-error cannot type tokenizer function dynamically\n                    tokenizer[tokenizerProp] = (...args) => {\n                        let ret = tokenizerFunc.apply(tokenizer, args);\n                        if (ret === false) {\n                            ret = prevTokenizer.apply(tokenizer, args);\n                        }\n                        return ret;\n                    };\n                }\n                opts.tokenizer = tokenizer;\n            }\n            // ==-- Parse Hooks extensions --== //\n            if (pack.hooks) {\n                const hooks = this.defaults.hooks || new _Hooks();\n                for (const prop in pack.hooks) {\n                    if (!(prop in hooks)) {\n                        throw new Error(`hook '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const hooksProp = prop;\n                    const hooksFunc = pack.hooks[hooksProp];\n                    const prevHook = hooks[hooksProp];\n                    if (_Hooks.passThroughHooks.has(prop)) {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (arg) => {\n                            if (this.defaults.async) {\n                                return Promise.resolve(hooksFunc.call(hooks, arg)).then(ret => {\n                                    return prevHook.call(hooks, ret);\n                                });\n                            }\n                            const ret = hooksFunc.call(hooks, arg);\n                            return prevHook.call(hooks, ret);\n                        };\n                    }\n                    else {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (...args) => {\n                            let ret = hooksFunc.apply(hooks, args);\n                            if (ret === false) {\n                                ret = prevHook.apply(hooks, args);\n                            }\n                            return ret;\n                        };\n                    }\n                }\n                opts.hooks = hooks;\n            }\n            // ==-- Parse WalkTokens extensions --== //\n            if (pack.walkTokens) {\n                const walkTokens = this.defaults.walkTokens;\n                const packWalktokens = pack.walkTokens;\n                opts.walkTokens = function (token) {\n                    let values = [];\n                    values.push(packWalktokens.call(this, token));\n                    if (walkTokens) {\n                        values = values.concat(walkTokens.call(this, token));\n                    }\n                    return values;\n                };\n            }\n            this.defaults = { ...this.defaults, ...opts };\n        });\n        return this;\n    }\n    setOptions(opt) {\n        this.defaults = { ...this.defaults, ...opt };\n        return this;\n    }\n    lexer(src, options) {\n        return _Lexer.lex(src, options ?? this.defaults);\n    }\n    parser(tokens, options) {\n        return _Parser.parse(tokens, options ?? this.defaults);\n    }\n    #parseMarkdown(lexer, parser) {\n        return (src, options) => {\n            const origOpt = { ...options };\n            const opt = { ...this.defaults, ...origOpt };\n            // Show warning if an extension set async to true but the parse was called with async: false\n            if (this.defaults.async === true && origOpt.async === false) {\n                if (!opt.silent) {\n                    console.warn('marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored.');\n                }\n                opt.async = true;\n            }\n            const throwError = this.#onError(!!opt.silent, !!opt.async);\n            // throw error in case of non string input\n            if (typeof src === 'undefined' || src === null) {\n                return throwError(new Error('marked(): input parameter is undefined or null'));\n            }\n            if (typeof src !== 'string') {\n                return throwError(new Error('marked(): input parameter is of type '\n                    + Object.prototype.toString.call(src) + ', string expected'));\n            }\n            if (opt.hooks) {\n                opt.hooks.options = opt;\n            }\n            if (opt.async) {\n                return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src)\n                    .then(src => lexer(src, opt))\n                    .then(tokens => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens)\n                    .then(tokens => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(() => tokens) : tokens)\n                    .then(tokens => parser(tokens, opt))\n                    .then(html => opt.hooks ? opt.hooks.postprocess(html) : html)\n                    .catch(throwError);\n            }\n            try {\n                if (opt.hooks) {\n                    src = opt.hooks.preprocess(src);\n                }\n                let tokens = lexer(src, opt);\n                if (opt.hooks) {\n                    tokens = opt.hooks.processAllTokens(tokens);\n                }\n                if (opt.walkTokens) {\n                    this.walkTokens(tokens, opt.walkTokens);\n                }\n                let html = parser(tokens, opt);\n                if (opt.hooks) {\n                    html = opt.hooks.postprocess(html);\n                }\n                return html;\n            }\n            catch (e) {\n                return throwError(e);\n            }\n        };\n    }\n    #onError(silent, async) {\n        return (e) => {\n            e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n            if (silent) {\n                const msg = '<p>An error occurred:</p><pre>'\n                    + escape$1(e.message + '', true)\n                    + '</pre>';\n                if (async) {\n                    return Promise.resolve(msg);\n                }\n                return msg;\n            }\n            if (async) {\n                return Promise.reject(e);\n            }\n            throw e;\n        };\n    }\n}\n\nconst markedInstance = new Marked();\nfunction marked(src, opt) {\n    return markedInstance.parse(src, opt);\n}\n/**\n * Sets the default options.\n *\n * @param options Hash of options\n */\nmarked.options =\n    marked.setOptions = function (options) {\n        markedInstance.setOptions(options);\n        marked.defaults = markedInstance.defaults;\n        changeDefaults(marked.defaults);\n        return marked;\n    };\n/**\n * Gets the original marked default options.\n */\nmarked.getDefaults = _getDefaults;\nmarked.defaults = _defaults;\n/**\n * Use Extension\n */\nmarked.use = function (...args) {\n    markedInstance.use(...args);\n    marked.defaults = markedInstance.defaults;\n    changeDefaults(marked.defaults);\n    return marked;\n};\n/**\n * Run callback for every token\n */\nmarked.walkTokens = function (tokens, callback) {\n    return markedInstance.walkTokens(tokens, callback);\n};\n/**\n * Compiles markdown to HTML without enclosing `p` tag.\n *\n * @param src String of markdown source to be compiled\n * @param options Hash of options\n * @return String of compiled HTML\n */\nmarked.parseInline = markedInstance.parseInline;\n/**\n * Expose\n */\nmarked.Parser = _Parser;\nmarked.parser = _Parser.parse;\nmarked.Renderer = _Renderer;\nmarked.TextRenderer = _TextRenderer;\nmarked.Lexer = _Lexer;\nmarked.lexer = _Lexer.lex;\nmarked.Tokenizer = _Tokenizer;\nmarked.Hooks = _Hooks;\nmarked.parse = marked;\nconst options = marked.options;\nconst setOptions = marked.setOptions;\nconst use = marked.use;\nconst walkTokens = marked.walkTokens;\nconst parseInline = marked.parseInline;\nconst parse = marked;\nconst parser = _Parser.parse;\nconst lexer = _Lexer.lex;\n\nexport { _Hooks as Hooks, _Lexer as Lexer, Marked, _Parser as Parser, _Renderer as Renderer, _TextRenderer as TextRenderer, _Tokenizer as Tokenizer, _defaults as defaults, _getDefaults as getDefaults, lexer, marked, options, parse, parseInline, parser, setOptions, use, walkTokens };\n//# sourceMappingURL=marked.esm.js.map\n","'use strict';\n\nvar escapes = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\nvar unescapes = {\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>',\n  '&quot;': '\"',\n  '&#39;': \"'\"\n};\nvar rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\nvar runescaped = /[&<>\"']/g;\n\nfunction escapeHtmlChar (match) {\n  return escapes[match];\n}\nfunction unescapeHtmlChar (match) {\n  return unescapes[match];\n}\n\nfunction escapeHtml (text) {\n  return text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n}\n\nfunction unescapeHtml (html) {\n  return html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n}\n\nescapeHtml.options = unescapeHtml.options = {};\n\nmodule.exports = {\n  encode: escapeHtml,\n  escape: escapeHtml,\n  decode: unescapeHtml,\n  unescape: unescapeHtml,\n  version: '1.0.0-browser'\n};\n","'use strict';\n\nfunction assignment (result) {\n  var stack = Array.prototype.slice.call(arguments, 1);\n  var item;\n  var key;\n  while (stack.length) {\n    item = stack.shift();\n    for (key in item) {\n      if (item.hasOwnProperty(key)) {\n        if (Object.prototype.toString.call(result[key]) === '[object Object]') {\n          result[key] = assignment(result[key], item[key]);\n        } else {\n          result[key] = item[key];\n        }\n      }\n    }\n  }\n  return result;\n}\n\nmodule.exports = assignment;\n","'use strict';\n\nmodule.exports = function lowercase (string) {\n  return typeof string === 'string' ? string.toLowerCase() : string;\n};\n","'use strict';\n\nfunction toMap (list) {\n  return list.reduce(asKey, {});\n}\n\nfunction asKey (accumulator, item) {\n  accumulator[item] = true;\n  return accumulator;\n}\n\nmodule.exports = toMap;\n","'use strict';\n\nvar toMap = require('./toMap');\nvar uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n\nmodule.exports = {\n  uris: toMap(uris) // attributes that have an href and hence need to be sanitized\n};\n","'use strict';\n\nvar toMap = require('./toMap');\nvar voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n\nmodule.exports = {\n  voids: toMap(voids)\n};\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\nvar rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\nvar rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\nvar rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\nvar rtag = /^</;\nvar rtagend = /^<\\s*\\//;\n\nfunction createStack () {\n  var stack = [];\n  stack.lastItem = function lastItem () {\n    return stack[stack.length - 1];\n  };\n  return stack;\n}\n\nfunction parser (html, handler) {\n  var stack = createStack();\n  var last = html;\n  var chars;\n\n  while (html) {\n    parsePart();\n  }\n  parseEndTag(); // clean up any remaining tags\n\n  function parsePart () {\n    chars = true;\n    parseTag();\n\n    var same = html === last;\n    last = html;\n\n    if (same) { // discard, because it's invalid\n      html = '';\n    }\n  }\n\n  function parseTag () {\n    if (html.substr(0, 4) === '<!--') { // comments\n      parseComment();\n    } else if (rtagend.test(html)) {\n      parseEdge(rend, parseEndTag);\n    } else if (rtag.test(html)) {\n      parseEdge(rstart, parseStartTag);\n    }\n    parseTagDecode();\n  }\n\n  function parseEdge (regex, parser) {\n    var match = html.match(regex);\n    if (match) {\n      html = html.substring(match[0].length);\n      match[0].replace(regex, parser);\n      chars = false;\n    }\n  }\n\n  function parseComment () {\n    var index = html.indexOf('-->');\n    if (index >= 0) {\n      if (handler.comment) {\n        handler.comment(html.substring(4, index));\n      }\n      html = html.substring(index + 3);\n      chars = false;\n    }\n  }\n\n  function parseTagDecode () {\n    if (!chars) {\n      return;\n    }\n    var text;\n    var index = html.indexOf('<');\n    if (index >= 0) {\n      text = html.substring(0, index);\n      html = html.substring(index);\n    } else {\n      text = html;\n      html = '';\n    }\n    if (handler.chars) {\n      handler.chars(text);\n    }\n  }\n\n  function parseStartTag (tag, tagName, rest, unary) {\n    var attrs = {};\n    var low = lowercase(tagName);\n    var u = elements.voids[low] || !!unary;\n\n    rest.replace(rattrs, attrReplacer);\n\n    if (!u) {\n      stack.push(low);\n    }\n    if (handler.start) {\n      handler.start(low, attrs, u);\n    }\n\n    function attrReplacer (match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n      if (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n        attrs[name] = void 0; // attribute is like <button disabled></button>\n      } else {\n        attrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n      }\n    }\n  }\n\n  function parseEndTag (tag, tagName) {\n    var i;\n    var pos = 0;\n    var low = lowercase(tagName);\n    if (low) {\n      for (pos = stack.length - 1; pos >= 0; pos--) {\n        if (stack[pos] === low) {\n          break; // find the closest opened tag of the same type\n        }\n      }\n    }\n    if (pos >= 0) {\n      for (i = stack.length - 1; i >= pos; i--) {\n        if (handler.end) { // close all the open elements, up the stack\n          handler.end(stack[i]);\n        }\n      }\n      stack.length = pos;\n    }\n  }\n}\n\nmodule.exports = parser;\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\n\nfunction sanitizer (buffer, options) {\n  var last;\n  var context;\n  var o = options || {};\n\n  reset();\n\n  return {\n    start: start,\n    end: end,\n    chars: chars\n  };\n\n  function out (value) {\n    buffer.push(value);\n  }\n\n  function start (tag, attrs, unary) {\n    var low = lowercase(tag);\n\n    if (context.ignoring) {\n      ignore(low); return;\n    }\n    if ((o.allowedTags || []).indexOf(low) === -1) {\n      ignore(low); return;\n    }\n    if (o.filter && !o.filter({ tag: low, attrs: attrs })) {\n      ignore(low); return;\n    }\n\n    out('<');\n    out(low);\n    Object.keys(attrs).forEach(parse);\n    out(unary ? '/>' : '>');\n\n    function parse (key) {\n      var value = attrs[key];\n      var classesOk = (o.allowedClasses || {})[low] || [];\n      var attrsOk = (o.allowedAttributes || {})[low] || [];\n      var valid;\n      var lkey = lowercase(key);\n      if (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n        value = value.split(' ').filter(isValidClass).join(' ').trim();\n        valid = value.length;\n      } else {\n        valid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n      }\n      if (valid) {\n        out(' ');\n        out(key);\n        if (typeof value === 'string') {\n          out('=\"');\n          out(he.encode(value));\n          out('\"');\n        }\n      }\n      function isValidClass (className) {\n        return classesOk && classesOk.indexOf(className) !== -1;\n      }\n    }\n  }\n\n  function end (tag) {\n    var low = lowercase(tag);\n    var allowed = (o.allowedTags || []).indexOf(low) !== -1;\n    if (allowed) {\n      if (context.ignoring === false) {\n        out('</');\n        out(low);\n        out('>');\n      } else {\n        unignore(low);\n      }\n    } else {\n      unignore(low);\n    }\n  }\n\n  function testUrl (text) {\n    var start = text[0];\n    if (start === '#' || start === '/') {\n      return true;\n    }\n    var colon = text.indexOf(':');\n    if (colon === -1) {\n      return true;\n    }\n    var questionmark = text.indexOf('?');\n    if (questionmark !== -1 && colon > questionmark) {\n      return true;\n    }\n    var hash = text.indexOf('#');\n    if (hash !== -1 && colon > hash) {\n      return true;\n    }\n    return o.allowedSchemes.some(matches);\n\n    function matches (scheme) {\n      return text.indexOf(scheme + ':') === 0;\n    }\n  }\n\n  function chars (text) {\n    if (context.ignoring === false) {\n      out(o.transformText ? o.transformText(text) : text);\n    }\n  }\n\n  function ignore (tag) {\n    if (elements.voids[tag]) {\n      return;\n    }\n    if (context.ignoring === false) {\n      context = { ignoring: tag, depth: 1 };\n    } else if (context.ignoring === tag) {\n      context.depth++;\n    }\n  }\n\n  function unignore (tag) {\n    if (context.ignoring === tag) {\n      if (--context.depth <= 0) {\n        reset();\n      }\n    }\n  }\n\n  function reset () {\n    context = { ignoring: false, depth: 0 };\n  }\n}\n\nmodule.exports = sanitizer;\n","'use strict';\n\nvar he = require('he');\nvar assign = require('assignment');\nvar parser = require('./parser');\nvar sanitizer = require('./sanitizer');\nvar defaults = require('./defaults');\n\nfunction insane (html, options, strict) {\n  var buffer = [];\n  var configuration = strict === true ? options : assign({}, defaults, options);\n  var handler = sanitizer(buffer, configuration);\n\n  parser(html, handler);\n\n  return buffer.join('');\n}\n\ninsane.defaults = defaults;\nmodule.exports = insane;\n","'use strict';\n\nvar defaults = {\n  allowedAttributes: {\n    a: ['href', 'name', 'target', 'title', 'aria-label'],\n    iframe: ['allowfullscreen', 'frameborder', 'src'],\n    img: ['src', 'alt', 'title', 'aria-label']\n  },\n  allowedClasses: {},\n  allowedSchemes: ['http', 'https', 'mailto'],\n  allowedTags: [\n    'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n    'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n    'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n  ],\n  filter: null\n};\n\nmodule.exports = defaults;\n","import insane from 'insane'\n\nconst insaneOptions = {\n  allowedClasses: {},\n  // @refer CVE-2018-8495\n  // @link https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8495\n  // @link https://leucosite.com/Microsoft-Edge-RCE/\n  // @link https://medium.com/@knownsec404team/analysis-of-the-security-issues-of-url-scheme-in-pc-from-cve-2018-8495-934478a36756\n  allowedSchemes: [\n    'http', 'https', 'mailto',\n    'data' // for support base64 encoded image (安全性有待考虑)\n  ],\n  allowedTags: [\n    'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n    'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n    'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n  ],\n  allowedAttributes: {\n    '*': ['title', 'accesskey'],\n    a: ['href', 'name', 'target', 'aria-label', 'rel'],\n    img: ['src', 'alt', 'title', 'atk-emoticon', 'aria-label'],\n    // for code highlight\n    code: ['class'],\n    span: ['class', 'style'],\n  },\n  filter: node => {\n    // allow hljs style\n    const allowed = [\n      [ 'code', /^hljs\\W+language-(.*)$/ ],\n      [ 'span', /^(hljs-.*)$/ ]\n    ]\n    allowed.forEach(([ tag, reg ]) => {\n      if (\n        node.tag === tag\n        && !!node.attrs.class\n        && !(reg as RegExp).test(node.attrs.class)\n      ) {\n        delete node.attrs.class\n      }\n    })\n\n    // allow <span> set color sty\n    if (node.tag === 'span' && !!node.attrs.style\n        && !/^color:(\\W+)?#[0-9a-f]{3,6};?$/i.test(node.attrs.style)) {\n      delete node.attrs.style\n    }\n\n    return true\n  }\n}\n\nexport function sanitize(content: string): string {\n  // @link https://github.com/markedjs/marked/discussions/1232\n  // @link https://gist.github.com/lionel-rowe/bb384465ba4e4c81a9c8dada84167225\n  return insane(content, insaneOptions)\n}\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.hanabi = factory());\n}(this, (function () { 'use strict';\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar index$1 = createCommonjsModule(function (module) {\n'use strict';\n\nvar comment = module.exports = function () {\n\treturn new RegExp('(?:' + comment.line().source + ')|(?:' + comment.block().source + ')', 'gm');\n};\n\ncomment.line = function () {\n\treturn /(?:^|\\s)\\/\\/(.+?)$/gm;\n};\n\ncomment.block = function () {\n\treturn /\\/\\*([\\S\\s]*?)\\*\\//gm;\n};\n});\n\nvar defaultColors = ['23AC69', '91C132', 'F19726', 'E8552D', '1AAB8E', 'E1147F', '2980C1', '1BA1E6', '9FA0A0', 'F19726', 'E30B20', 'E30B20', 'A3338B'];\n\nvar index = function (input, ref) {\n  if ( ref === void 0 ) ref = {};\n  var colors = ref.colors; if ( colors === void 0 ) colors = defaultColors;\n\n  var index = 0;\n  var cache = {};\n  var wordRe = /[\\u4E00-\\u9FFF\\u3400-\\u4dbf\\uf900-\\ufaff\\u3040-\\u309f\\uac00-\\ud7af\\u0400-\\u04FF]+|\\w+/;\n  var leftAngleRe = /</;\n\n  var re = new RegExp((\"(\" + (wordRe.source) + \"|\" + (leftAngleRe.source) + \")|(\" + (index$1().source) + \")\"), 'gmi');\n  return input\n  .replace(re, function (m, word, cm) {\n    if (cm) {\n      return toComment(cm)\n    }\n\n    if (word === '<') {\n      return '&lt;'\n    }\n    var color;\n    if (cache[word]) {\n      color = cache[word];\n    } else {\n      color = colors[index];\n      cache[word] = color;\n    }\n\n    var out = \"<span style=\\\"color: #\" + color + \"\\\">\" + word + \"</span>\";\n    index = ++index % colors.length;\n    return out\n  })\n};\n\nfunction toComment(cm) {\n  return (\"<span style=\\\"color: slategray\\\">\" + cm + \"</span>\")\n}\n\nreturn index;\n\n})));\n","import hanabi from 'hanabi'\n\nexport function renderCode(code: string) {\n  return hanabi(code)\n}\n","import { marked as libMarked } from 'marked'\nimport { renderCode } from './highlight'\n\nexport function getRenderer() {\n  const renderer = new libMarked.Renderer()\n  renderer.link = markedLinkRenderer(renderer, renderer.link)\n  renderer.code = markedCodeRenderer()\n  return renderer\n}\n\nexport const markedLinkRenderer = (renderer: any, orgLinkRenderer: Function) => (href: string, title: string, text: string): string => {\n  const localLink = href?.startsWith(`${window.location.protocol}//${window.location.hostname}`);\n  const html = orgLinkRenderer.call(renderer, href, title, text);\n  return html.replace(/^<a /, `<a target=\"_blank\" ${!localLink ? `rel=\"noreferrer noopener nofollow\"` : ''} `);\n}\n\nexport const markedCodeRenderer = () => (block: string, lang: string | undefined): string => {\n  // Colorize the block only if the language is known to highlight.js\n  const realLang = (!lang ? 'plaintext' : lang)\n  let colorized = block\n  if ((window as any).hljs) {\n    if (realLang && (window as any).hljs.getLanguage(realLang)) {\n      colorized = (window as any).hljs.highlight(realLang, block).value\n    }\n  } else {\n    colorized = renderCode(block)\n  }\n\n  return `<pre rel=\"${realLang}\">\\n`\n    + `<code class=\"hljs language-${realLang}\">${colorized.replace(/&amp;/g, '&')}</code>\\n`\n    + `</pre>`\n}\n","import { marked as libMarked, MarkedOptions } from 'marked'\n\nimport { sanitize } from './sanitizer'\nimport { renderCode } from './highlight'\nimport { getRenderer } from './marked-renderer'\n\ntype Replacer = (raw: string) => string\nexport type TMarked = typeof libMarked\n\nlet instance: TMarked|undefined\nlet replacers: Replacer[] = []\n\nconst markedOptions: MarkedOptions = {\n  gfm: true,\n  breaks: true,\n  async: false\n}\n\n/** Get Marked instance */\nexport function getInstance() {\n  return instance\n}\n\nexport function setReplacers(arr: Replacer[]) {\n  replacers = arr\n}\n\n/** 初始化 marked */\nexport function initMarked() {\n  try { if (!libMarked.name) return } catch { return }\n\n  // @see https://github.com/markedjs/marked/blob/4afb228d956a415624c4e5554bb8f25d047676fe/src/Tokenizer.js#L329\n  libMarked.setOptions({\n    renderer: getRenderer(),\n    ...markedOptions\n  })\n\n  instance = libMarked\n}\n\n/** 解析 markdown */\nexport default function marked(src: string): string {\n  let markedContent = getInstance()?.parse(src) as string\n  if (!markedContent) { // 无 Markdown 模式简单处理\n    markedContent = simpleMarked(src)\n  }\n\n  let dest = sanitize(markedContent)\n\n  // 内容替换器\n  replacers.forEach((replacer) => {\n    if (typeof replacer === 'function')\n      dest = replacer(dest)\n  })\n\n  return dest\n}\n\nfunction simpleMarked(src: string) {\n  return src\n    // .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n    .replace(/```\\s*([^]+?.*?[^]+?[^]+?)```/g, (_, code) => `<pre><code>${renderCode(code)}</code></pre>`)\n    // .replace(/`([^`]+?)`/g, '<code>$1</code>')\n    .replace(/!\\[(.*?)\\]\\((.*?)\\)/g, (_, alt, imgSrc) => `<img src=\"${imgSrc}\" alt=\"${alt}\" />`)\n    .replace(/\\[(.*?)\\]\\((.*?)\\)/g, (_, text, link) => `<a href=\"${link}\" target=\"_blank\">${text}</a>`)\n    .replace(/\\n/g, '<br>')\n}\n","/**\n * Performs a deep merge of objects and returns new object.\n * Does not modify objects (immutable) and merges arrays via concatenation.\n *\n * @param objects - Objects to merge\n * @returns New object with merged key/values\n */\nexport function mergeDeep<T>(...objects: any[]): T {\n  const isObject = (obj: any) => obj && typeof obj === \"object\" && obj.constructor === Object;\n\n  return objects.reduce((prev, obj) => {\n    Object.keys(obj ?? {}).forEach((key) => {\n      // Avoid prototype pollution\n      if (key === \"__proto__\" || key === \"constructor\" || key === \"prototype\") {\n        return\n      }\n\n      const pVal = prev[key]\n      const oVal = obj[key]\n\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\n        prev[key] = pVal.concat(...oVal)\n      } else if (isObject(pVal) && isObject(oVal)) {\n        prev[key] = mergeDeep(pVal, oVal)\n      } else {\n        prev[key] = oVal\n      }\n    })\n\n    return prev\n  }, {})\n}\n","import type { NotifyData, PageData, CommentData, DataManagerApi, ListFetchParams, ListLastFetchData, EventPayloadMap } from '@/types'\nimport EventManager from './lib/event-manager'\n\nexport class DataManager implements DataManagerApi {\n  private loading: boolean = false\n  private listLastFetch?: ListLastFetchData\n  private comments: CommentData[] = [] // Note: 无层级结构 + 无须排列\n  private notifies: NotifyData[] = []\n  private page?: PageData\n\n  constructor(\n    protected events: EventManager<EventPayloadMap>\n  ) {}\n\n  getLoading() {\n    return this.loading\n  }\n\n  setLoading(val: boolean) {\n    this.loading = val\n  }\n\n  getListLastFetch() {\n    return this.listLastFetch\n  }\n\n  setListLastFetch(val: ListLastFetchData) {\n    this.listLastFetch = val\n  }\n\n  // -------------------------------------------------------------------\n  //  Comments\n  // -------------------------------------------------------------------\n  getComments() {\n    return this.comments\n  }\n\n  fetchComments(params: Partial<ListFetchParams>) {\n    this.events.trigger('list-fetch', params)\n  }\n\n  findComment(id: number) {\n    return this.comments.find(c => c.id === id)\n  }\n\n  clearComments() {\n    this.comments = []\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  loadComments(partialComments: CommentData[]) {\n    this.events.trigger('list-load', partialComments)\n\n    this.comments.push(...partialComments)\n\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  insertComment(comment: CommentData) {\n    this.comments.push(comment)\n\n    this.events.trigger('comment-inserted', comment)\n    this.events.trigger('list-loaded', this.comments) // list-loaded should always keep the last\n  }\n\n  updateComment(comment: CommentData) {\n    this.comments = this.comments.map(c => {\n      if (c.id === comment.id) return comment\n      return c\n    })\n\n    this.events.trigger('comment-updated', comment)\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  deleteComment(id: number) {\n    const comment = this.comments.find(c => c.id === id)\n    if (!comment) throw new Error(`Comment ${id} not found`)\n    this.comments = this.comments.filter(c => c.id !== id)\n\n    this.events.trigger('comment-deleted', comment)\n    this.events.trigger('list-loaded', this.comments)\n  }\n\n  // -------------------------------------------------------------------\n  //  Notifies\n  // -------------------------------------------------------------------\n  getNotifies() {\n    return this.notifies\n  }\n\n  updateNotifies(notifies: NotifyData[]) {\n    this.notifies = notifies\n\n    this.events.trigger('notifies-updated', this.notifies)\n  }\n\n  // -------------------------------------------------------------------\n  // Page\n  // -------------------------------------------------------------------\n  getPage() {\n    return this.page\n  }\n\n  updatePage(pageData: PageData) {\n    this.page = pageData\n\n    this.events.trigger('page-loaded', pageData)\n  }\n}\n","const en = {\n  /* Editor */\n  placeholder: 'Leave a comment',\n  noComment: 'No Comment',\n  send: 'Send',\n  save: 'Save',\n  nick: 'Nickname',\n  email: 'Email',\n  link: 'Website',\n  emoticon: 'Emoji',\n  preview: 'Preview',\n  uploadImage: 'Upload Image',\n  uploadFail: 'Upload Failed',\n  commentFail: 'Failed to comment',\n  restoredMsg: 'Content has been restored',\n  onlyAdminCanReply: 'Only admin can reply',\n  uploadLoginMsg: 'Please fill in your name and email to upload',\n\n  /* List */\n  counter: '{count} Comments',\n  sortLatest: 'Latest',\n  sortOldest: 'Oldest',\n  sortBest: 'Best',\n  sortAuthor: 'Author',\n  openComment: 'Open Comment',\n  closeComment: 'Close Comment',\n  listLoadFailMsg: 'Failed to load comments',\n  listRetry: 'Retry',\n  loadMore: 'Load More',\n\n  /* Comment */\n  admin: 'Admin',\n  reply: 'Reply',\n  voteUp: 'Up',\n  voteDown: 'Down',\n  voteFail: 'Vote Failed',\n  readMore: 'Read More',\n  actionConfirm: 'Confirm',\n  collapse: 'Collapse',\n  collapsed: 'Collapsed',\n  collapsedMsg: 'This comment has been collapsed',\n  expand: 'Expand',\n  approved: 'Approved',\n  pending: 'Pending',\n  pendingMsg: 'Pending, visible only to commenter.',\n  edit: 'Edit',\n  editCancel: 'Cancel Edit',\n  delete: 'Delete',\n  deleteConfirm: 'Confirm',\n  pin: 'Pin',\n  unpin: 'Unpin',\n\n  /* Time */\n  seconds: 'seconds ago',\n  minutes: 'minutes ago',\n  hours: 'hours ago',\n  days: 'days ago',\n  now: 'just now',\n\n  /* Checker */\n  adminCheck: 'Enter admin password:',\n  captchaCheck: 'Enter the CAPTCHA to continue:',\n  confirm: 'Confirm',\n  cancel: 'Cancel',\n\n  /* Sidebar */\n  msgCenter: 'Messages',\n  ctrlCenter: 'Admin',\n\n  /* General */\n  frontend: 'Frontend',\n  backend: 'Backend',\n  loading: 'Loading',\n  loadFail: 'Load Failed',\n  editing: 'Editing',\n  editFail: 'Edit Failed',\n  deleting: 'Deleting',\n  deleteFail: 'Delete Failed',\n  reqGot: 'Request got',\n  reqAborted: 'Request timed out or terminated unexpectedly',\n  updateMsg: 'Please update Artalk {name} to get the full experience',\n  currentVersion: 'Current Version',\n  ignore: 'Ignore',\n  open: 'Open',\n  openName: 'Open {name}',\n}\n\nexport type I18n = typeof en\nexport type I18nKeys = keyof I18n\n\nexport default en\n","import type { I18n } from '.'\n\nexport const GLOBAL_LOCALES_KEY = \"ArtalkI18n\"\n\nexport function defineLocaleExternal(lang: string, locale: I18n, aliases?: string[]) {\n  if (!window[GLOBAL_LOCALES_KEY]) window[GLOBAL_LOCALES_KEY] = {}\n  window[GLOBAL_LOCALES_KEY][lang] = locale\n  if (aliases) aliases.forEach(l => { window[GLOBAL_LOCALES_KEY][l] = locale })\n  return locale\n}\n","export function createElement<E extends HTMLElement = HTMLElement>(htmlStr: string = ''): E {\n  const div = document.createElement('div')\n  div.innerHTML = htmlStr.trim()\n  return (div.firstElementChild || div) as E\n}\n\nexport function getHeight(el: HTMLElement) {\n  return parseFloat(getComputedStyle(el, null).height.replace('px', ''))\n}\n\nexport function htmlEncode(str: string) {\n  const temp = document.createElement('div')\n  temp.innerText = str\n  const output = temp.innerHTML\n  return output\n}\n\nexport function htmlDecode(str: string) {\n  const temp = document.createElement('div')\n  temp.innerHTML = str\n  const output = temp.innerText\n  return output\n}\n\nexport function getQueryParam(name: string) {\n  const match = RegExp(`[?&]${name}=([^&]*)`).exec(window.location.search);\n  return match && decodeURIComponent(match[1].replace(/\\+/g, ' '));\n}\n\nexport function getOffset(el: HTMLElement, relativeTo?: HTMLElement) {\n  const getOffsetRecursive = (element: HTMLElement): { top: number, left: number } => {\n    const rect = element.getBoundingClientRect()\n    const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop\n    return {\n      top: rect.top + scrollTop,\n      left: rect.left + scrollLeft\n    }\n  }\n\n  const elOffset = getOffsetRecursive(el)\n  if (!relativeTo) return elOffset\n\n  const relativeToOffset = getOffsetRecursive(relativeTo)\n\n  return {\n    top: elOffset.top - relativeToOffset.top,\n    left: elOffset.left - relativeToOffset.left\n  }\n}\n\nexport function padWithZeros(vNumber: number, width: number) {\n  let numAsString = vNumber.toString()\n  while (numAsString.length < width) {\n    numAsString = `0${numAsString}`\n  }\n  return numAsString\n}\n\nexport function dateFormat(date: Date) {\n  const vDay = padWithZeros(date.getDate(), 2)\n  const vMonth = padWithZeros(date.getMonth() + 1, 2)\n  const vYear = padWithZeros(date.getFullYear(), 2)\n  // var vHour = padWithZeros(date.getHours(), 2);\n  // var vMinute = padWithZeros(date.getMinutes(), 2);\n  // var vSecond = padWithZeros(date.getSeconds(), 2);\n  return `${vYear}-${vMonth}-${vDay}`\n}\n\nexport function timeAgo(date: Date, $t: Function = (n: string) => n) {\n  try {\n    const oldTime = date.getTime()\n    const currTime = new Date().getTime()\n    const diffValue = currTime - oldTime\n\n    const days = Math.floor(diffValue / (24 * 3600 * 1000))\n    if (days === 0) {\n      // 计算相差小时数\n      const leave1 = diffValue % (24 * 3600 * 1000) // 计算天数后剩余的毫秒数\n      const hours = Math.floor(leave1 / (3600 * 1000))\n      if (hours === 0) {\n        // 计算相差分钟数\n        const leave2 = leave1 % (3600 * 1000) // 计算小时数后剩余的毫秒数\n        const minutes = Math.floor(leave2 / (60 * 1000))\n        if (minutes === 0) {\n          // 计算相差秒数\n          const leave3 = leave2 % (60 * 1000) // 计算分钟数后剩余的毫秒数\n          const seconds = Math.round(leave3 / 1000)\n          if (seconds < 10) return $t('now')\n          return `${seconds} ${$t('seconds')}`\n        }\n        return `${minutes} ${$t('minutes')}`\n      }\n      return `${hours} ${$t('hours')}`\n    }\n    if (days < 0) return $t('now')\n\n    if (days < 8) {\n      return `${days} ${$t('days')}`\n    }\n\n    return dateFormat(date)\n  } catch (error) {\n    console.error(error)\n    return ' - '\n  }\n}\n\n/** 所有图片加载完毕后执行 */\nexport function onImagesLoaded($container: HTMLElement, event: Function) {\n  if (!$container) return\n  const images = $container.getElementsByTagName('img')\n  if (!images.length) return\n  let loaded = images.length\n  for (let i = 0; i < images.length; i++) {\n    if (images[i].complete) {\n      loaded--\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-loop-func\n      images[i].addEventListener('load', () => {\n        loaded--\n        if (loaded === 0) event()\n      })\n    }\n\n    if (loaded === 0) event()\n  }\n}\n\nexport function getGravatarURL(opts: { params: string, mirror: string, emailMD5: string }) {\n  return `${opts.mirror.replace(/\\/$/, '')}/${opts.emailMD5}?${opts.params.replace(/^\\?/, '')}`\n}\n\nexport function sleep(ms: number) {\n  return new Promise(resolve => { setTimeout(resolve, ms) });\n}\n\n/** 版本号比较（a < b :-1 | 0 | b < a :1） */\nexport function versionCompare(a: string, b: string) {\n  const pa = a.split('.')\n  const pb = b.split('.')\n  for (let i = 0; i < 3; i++) {\n      const na = Number(pa[i])\n      const nb = Number(pb[i])\n      if (na > nb) return 1\n      if (nb > na) return -1\n      if (!Number.isNaN(na) && Number.isNaN(nb)) return 1\n      if (Number.isNaN(na) && !Number.isNaN(nb)) return -1\n  }\n  return 0\n}\n\n/** 获取修正后的 UserAgent */\nexport async function getCorrectUserAgent() {\n  const uaRaw = navigator.userAgent\n  if (!(navigator as any).userAgentData || !(navigator as any).userAgentData.getHighEntropyValues) {\n    return uaRaw\n  }\n\n  // @link https://web.dev/migrate-to-ua-ch/\n  // @link https://web.dev/user-agent-client-hints/\n  const uaData = (navigator as any).userAgentData\n  let uaGot: any = null\n  try {\n    uaGot = await uaData.getHighEntropyValues([\"platformVersion\"])\n  } catch (err) { console.error(err); return uaRaw }\n  const majorPlatformVersion = Number(uaGot.platformVersion.split('.')[0])\n\n  if (uaData.platform === \"Windows\") {\n    if (majorPlatformVersion >= 13) { // @link https://docs.microsoft.com/en-us/microsoft-edge/web-platform/how-to-detect-win11\n      // @date 2022-4-29\n      // Win 11 样本：\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36\"\n      return uaRaw.replace(/Windows NT 10.0/, 'Windows NT 11.0')\n    }\n  }\n  if (uaData.platform === \"macOS\") {\n    if (majorPlatformVersion >= 11) { // 11 => BigSur\n      // @date 2022-4-29\n      // (Intel Chip) macOS 12.3 样本：\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36\"\n      // (Arm Chip) macOS 样本：\"Mozilla/5.0 (Macintosh; ARM Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.2 Safari/605.1.15\"\n      return uaRaw.replace(/(Mac OS X \\d+_\\d+_\\d+|Mac OS X)/, `Mac OS X ${uaGot.platformVersion.replace(/\\./g, '_')}`)\n    }\n  }\n\n  return uaRaw\n}\n\n/** 是否为完整的 URL */\nexport function isValidURL(urlRaw: string) {\n  // @link https://www.rfc-editor.org/rfc/rfc3986\n  let url: URL\n  try {\n    url = new URL(urlRaw)\n  } catch (_) { return false }\n  return url.protocol === \"http:\" || url.protocol === \"https:\"\n}\n\n/** 获取基于 conf.server 的 URL */\nexport function getURLBasedOnApi(opts: { base: string, path: string }) {\n  return getURLBasedOn(opts.base, opts.path)\n}\n\n/** 获取基于某个 baseURL 的 URL */\nexport function getURLBasedOn(baseURL: string, path: string) {\n  return `${baseURL.replace(/\\/$/, '')}/${path.replace(/^\\//, '')}`\n}\n","import en, { I18n, I18nKeys } from './en'\nimport zhCN from './zh-CN'\nimport { GLOBAL_LOCALES_KEY } from './external'\nimport * as Utils from '../lib/utils'\n\nexport type * from './en'\n\n// @note the key of language is followed by `ISO 639`\n// https://en.wikipedia.org/wiki/ISO_639\n// https://datatracker.ietf.org/doc/html/rfc5646#section-2.1\nexport const internal = {\n  'en': en,\n  'en-US': en,\n  'zh-CN': zhCN,\n}\n\n/**\n * find a locale object by language name\n */\nexport function findLocaleSet(lang: string): I18n {\n  // normalize a key of language to `ISO 639`\n  lang = lang.replace(\n    /^([a-zA-Z]+)(-[a-zA-Z]+)?$/,\n    (_, p1: string, p2: string) => (p1.toLowerCase() + (p2 || '').toUpperCase())\n  )\n\n  // internal finding\n  if (internal[lang]) {\n    return internal[lang]\n  }\n\n  // external finding\n  if (window[GLOBAL_LOCALES_KEY] && window[GLOBAL_LOCALES_KEY][lang]) {\n    return window[GLOBAL_LOCALES_KEY][lang]\n  }\n\n  // case when not found:\n  // use `en` by default\n  return internal.en\n}\n\n/**\n * System locale setting\n */\nlet LocaleConf: I18n|string = 'en'\nlet LocaleDict: I18n = findLocaleSet(LocaleConf) // en by default\n\n/**\n * Set system locale\n */\nexport function setLocale(locale: I18n|string) {\n  if (locale === LocaleConf) return\n  LocaleConf = locale\n  LocaleDict = (typeof locale === 'string') ? findLocaleSet(locale) : locale\n}\n\n/**\n * Get an i18n message by key\n */\nexport function t(key: I18nKeys, args: {[key: string]: string} = {}) {\n  let str = LocaleDict?.[key] || key\n  str = str.replace(/\\{\\s*(\\w+?)\\s*\\}/g, (_, token) => args[token] || '')\n\n  return Utils.htmlEncode(str)\n}\n\nexport default t\n","import type { I18n } from '.'\n\nconst zhCN: I18n = {\n  /* Editor */\n  placeholder: '键入内容...',\n  noComment: '「此时无声胜有声」',\n  send: '发送',\n  save: '保存',\n  nick: '昵称',\n  email: '邮箱',\n  link: '网址',\n  emoticon: '表情',\n  preview: '预览',\n  uploadImage: '上传图片',\n  uploadFail: '上传失败',\n  commentFail: '评论失败',\n  restoredMsg: '内容已自动恢复',\n  onlyAdminCanReply: '仅管理员可评论',\n  uploadLoginMsg: '填入你的名字邮箱才能上传哦',\n\n  /* List */\n  counter: '{count} 条评论',\n  sortLatest: '最新',\n  sortOldest: '最早',\n  sortBest: '最热',\n  sortAuthor: '作者',\n  openComment: '打开评论',\n  closeComment: '关闭评论',\n  listLoadFailMsg: '无法获取评论列表数据',\n  listRetry: '点击重新获取',\n  loadMore: '加载更多',\n\n  /* Comment */\n  admin: '管理员',\n  reply: '回复',\n  voteUp: '赞同',\n  voteDown: '反对',\n  voteFail: '投票失败',\n  readMore: '阅读更多',\n  actionConfirm: '确认操作',\n  collapse: '折叠',\n  collapsed: '已折叠',\n  collapsedMsg: '该评论已被系统或管理员折叠',\n  expand: '展开',\n  approved: '已审',\n  pending: '待审',\n  pendingMsg: '审核中，仅本人可见。',\n  edit: '编辑',\n  editCancel: '取消编辑',\n  delete: '删除',\n  deleteConfirm: '确认删除',\n  pin: '置顶',\n  unpin: '取消置顶',\n\n  /* Time */\n  seconds: '秒前',\n  minutes: '分钟前',\n  hours: '小时前',\n  days: '天前',\n  now: '刚刚',\n\n  /* Checker */\n  adminCheck: '键入密码来验证管理员身份：',\n  captchaCheck: '键入验证码继续：',\n  confirm: '确认',\n  cancel: '取消',\n\n  /* Sidebar */\n  msgCenter: '通知中心',\n  ctrlCenter: '控制中心',\n\n  /* General */\n  frontend: '前端',\n  backend: '后端',\n  loading: '加载中',\n  loadFail: '加载失败',\n  editing: '修改中',\n  editFail: '修改失败',\n  deleting: '删除中',\n  deleteFail: '删除失败',\n  reqGot: '请求响应',\n  reqAborted: '请求超时或意外终止',\n  updateMsg: '请更新 Artalk {name} 以获得完整体验',\n  currentVersion: '当前版本',\n  ignore: '忽略',\n  open: '打开',\n  openName: '打开{name}',\n}\n\nexport default zhCN\n","export type EventHandler<T> = (payload: T) => void\nexport interface Event<PayloadMap, K extends keyof PayloadMap = keyof PayloadMap> extends EventOptions {\n  name: K\n  handler: EventHandler<PayloadMap[K]>\n}\nexport interface EventOptions {\n  once?: boolean\n}\n\nexport interface EventManagerFuncs<PayloadMap> {\n  on<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>, opts?: EventOptions): void\n  off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>): void\n  trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]): void\n}\n\nexport default class EventManager<PayloadMap> implements EventManagerFuncs<PayloadMap> {\n  private events: Event<PayloadMap>[] = []\n\n  /**\n   * Add an event listener for a specific event name\n   */\n  public on<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>, opts: EventOptions = {}) {\n    this.events.push({ name, handler: handler as EventHandler<PayloadMap[keyof PayloadMap]>, ...opts })\n  }\n\n  /**\n   * Remove an event listener for a specific event name and handler\n   */\n  public off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>) {\n    if (!handler) return // not allow remove all events with same name\n    this.events = this.events.filter((evt) =>\n      !(evt.name === name && evt.handler === handler))\n  }\n\n  /**\n   * Trigger an event with an optional payload\n   */\n  public trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]) {\n    this.events\n      .slice(0) // make a copy, in case listeners are removed while iterating\n      .filter((evt) => evt.name === name && typeof evt.handler === 'function')\n      .forEach((evt) => {\n        if (evt.once) this.off(name, evt.handler)\n        evt.handler(payload!)\n      })\n  }\n}\n","import type { ArtalkConfig } from '@/types'\n\nconst defaults: ArtalkConfig = {\n  el: '',\n  pageKey: '',\n  pageTitle: '',\n  server: '',\n  site: '',\n\n  placeholder: '',\n  noComment: '',\n  sendBtn: '',\n  darkMode: false,\n  editorTravel: true,\n\n  flatMode: 'auto',\n  nestMax: 2,\n  nestSort: 'DATE_ASC',\n\n  emoticons: \"https://cdn.jsdelivr.net/gh/ArtalkJS/Emoticons/grps/default.json\",\n\n  vote: true,\n  voteDown: false,\n  uaBadge: true,\n  listSort: true,\n  preview: true,\n  countEl: '#ArtalkCount',\n  pvEl: '#ArtalkPV',\n\n  gravatar: {\n    mirror: 'https://cravatar.cn/avatar/',\n    params: 'd=mp&s=240',\n  },\n\n  pagination: {\n    pageSize: 20,\n    readMore: true,\n    autoLoad: true,\n  },\n\n  heightLimit: {\n    content: 300,\n    children: 400,\n    scrollable: false,\n  },\n\n  imgUpload: true,\n  reqTimeout: 15000,\n  versionCheck: true,\n  useBackendConf: true,\n\n  locale: 'en',\n}\n\nif (ARTALK_LITE) {\n  defaults.vote = false\n  defaults.uaBadge = false\n  defaults.emoticons = false\n  defaults.preview = false\n}\n\nexport default defaults\n","import type { ArtalkConfig, ContextApi } from '@/types'\nimport type { ApiOptions } from './api/options'\nimport { mergeDeep } from './lib/merge-deep'\nimport Defaults from './defaults'\n\n/**\n * Handle the custom config which is provided by the user\n *\n * @param customConf - The custom config object which is provided by the user\n * @param full - If `full` is `true`, the return value will be the complete config for Artalk instance creation\n * @returns The config for Artalk instance creation\n */\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full: true): ArtalkConfig\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full?: false): Partial<ArtalkConfig>\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full = false) {\n  // 合并默认配置\n  const conf: Partial<ArtalkConfig> = full ? mergeDeep(Defaults, customConf) : customConf\n\n  // 绑定元素\n  if (conf.el && typeof conf.el === 'string') {\n    try {\n      const findEl = document.querySelector<HTMLElement>(conf.el)\n      if (!findEl) throw Error(`Target element \"${conf.el}\" was not found.`)\n      conf.el = findEl\n    } catch (e) {\n      console.error(e)\n      throw new Error('Please check your Artalk `el` config.')\n    }\n  }\n\n  // 默认 pageKey\n  if (conf.pageKey === '')\n    conf.pageKey = `${window.location.pathname}` // @link http://bl.ocks.org/abernier/3070589\n\n  // 默认 pageTitle\n  if (conf.pageTitle === '')\n    conf.pageTitle = `${document.title}`\n\n  // 服务器配置\n  if (conf.server)\n    conf.server = conf.server.replace(/\\/$/, '').replace(/\\/api\\/?$/, '')\n\n  // 自适应语言\n  if (conf.locale === 'auto')\n    conf.locale = navigator.language\n\n  // 自动判断启用平铺模式\n  if (conf.flatMode === 'auto')\n    conf.flatMode = window.matchMedia(\"(max-width: 768px)\").matches\n\n  // flatMode\n  if (typeof conf.nestMax === 'number' && Number(conf.nestMax) <= 1)\n    conf.flatMode = true\n\n  return conf\n}\n\n/**\n * Handle the config which is provided by the server\n *\n * @param conf - The Server response config for control the frontend of Artalk remotely\n * @returns The config for Artalk instance creation\n */\nexport function handleConfFormServer(conf: Partial<ArtalkConfig>) {\n  const DisabledKeys: (keyof ArtalkConfig)[] = [\n    'el', 'pageKey', 'pageTitle', 'server', 'site', 'darkMode'\n  ]\n  Object.keys(conf).forEach(k => {\n    if (DisabledKeys.includes(k as any)) delete conf[k]\n  })\n\n  // Patch: `emoticons` config string to json\n  if (conf.emoticons && typeof conf.emoticons === \"string\") {\n    conf.emoticons = conf.emoticons.trim()\n    if (conf.emoticons.startsWith(\"[\") || conf.emoticons.startsWith(\"{\")) {\n      conf.emoticons = JSON.parse(conf.emoticons) // parse json\n    } else if (conf.emoticons === \"false\") {\n      conf.emoticons = false\n    }\n  }\n\n  return conf\n}\n\n/**\n * Convert Artalk Config to ApiOptions for Api client\n *\n * @param conf - Artalk config\n * @param ctx - If `ctx` not provided, `checkAdmin` and `checkCaptcha` will be disabled\n * @returns ApiOptions for Api client instance creation\n */\nexport function convertApiOptions(conf: Partial<ArtalkConfig>, ctx?: ContextApi): ApiOptions {\n  return {\n    baseURL: `${conf.server}/api/v2`,\n    siteName: conf.site || '',\n    pageKey: conf.pageKey || '',\n    pageTitle: conf.pageTitle || '',\n    timeout: conf.reqTimeout,\n    getApiToken: () => ctx?.get('user').getData().token,\n    userInfo: ctx?.get('user').checkHasBasicUserInfo() ? {\n      name: ctx?.get('user').getData().nick,\n      email: ctx?.get('user').getData().email,\n    } : undefined,\n\n    onNeedCheckAdmin: (payload) => {\n      if (!ctx) throw new Error('`ctx` is required when `onNeedCheckAdmin` is called.')\n      return ctx.checkAdmin({})\n    },\n\n    onNeedCheckCaptcha: (payload) => {\n      if (!ctx) throw new Error('`ctx` is required when `onNeedCheckCaptcha` is called.')\n      return ctx.checkCaptcha({\n        imgData: payload.data.imgData,\n        iframe: payload.data.iframe,\n      })\n    },\n  }\n}\n","import type { ArtalkConfig, ContextApi } from '@/types'\n\nexport function watchConf<T extends (keyof ArtalkConfig)[]>(ctx: ContextApi, keys: T, effect: (conf: Pick<ArtalkConfig, T[number]>) => void): void {\n  const deepEqual = (a: any, b: any) => JSON.stringify(a) === JSON.stringify(b)\n  const val = () => {\n    const conf = ctx.getConf()\n    const res: any = {}\n    keys.forEach((key) => { res[key] = conf[key] })\n    return res\n  }\n  let lastVal: any = null\n  const handler = () => {\n    const newVal = val()\n    const isDiff = lastVal == null || !deepEqual(lastVal, newVal)\n    // only trigger when specific keys changed\n    if (isDiff) {\n      lastVal = newVal\n      effect(newVal)\n    }\n  }\n  ctx.on('mounted', handler)\n  ctx.on('updated', handler)\n}\n","import type { ArtalkConfig, CommentData, ListFetchParams, ContextApi, EventPayloadMap, SidebarShowPayload } from '@/types'\nimport type { TInjectedServices } from './service'\nimport { Api } from './api'\n\nimport * as marked from './lib/marked'\nimport { mergeDeep } from './lib/merge-deep'\nimport { CheckerCaptchaPayload, CheckerPayload } from './components/checker'\n\nimport { DataManager } from './data'\nimport * as I18n from './i18n'\n\nimport EventManager from './lib/event-manager'\nimport { convertApiOptions, handelCustomConf } from './config'\nimport { watchConf } from './lib/watch-conf'\n\n// Auto dependency injection\ninterface Context extends TInjectedServices { }\n\n/**\n * Artalk Context\n */\nclass Context implements ContextApi {\n  /* 运行参数 */\n  conf: ArtalkConfig\n  data: DataManager\n  $root: HTMLElement\n\n  /* Event Manager */\n  private events = new EventManager<EventPayloadMap>()\n  private mounted = false\n\n  constructor(conf: ArtalkConfig) {\n    this.conf = conf\n\n    this.$root = conf.el as HTMLElement\n    this.$root.classList.add('artalk')\n    this.$root.innerHTML = ''\n\n    this.data = new DataManager(this.events)\n\n    this.on('mounted', () => {\n      this.mounted = true\n    })\n  }\n\n  inject(depName: string, obj: any) {\n    this[depName] = obj\n  }\n\n  get(depName: string) {\n    return this[depName]\n  }\n\n  getApi() {\n    return new Api(convertApiOptions(this.conf, this))\n  }\n\n  getData() {\n    return this.data\n  }\n\n  replyComment(commentData: CommentData, $comment: HTMLElement): void {\n    this.editor.setReply(commentData, $comment)\n  }\n\n  editComment(commentData: CommentData, $comment: HTMLElement): void {\n    this.editor.setEditComment(commentData, $comment)\n  }\n\n  fetch(params: Partial<ListFetchParams>): void {\n    this.data.fetchComments(params)\n  }\n\n  reload(): void {\n    this.data.fetchComments({ offset: 0 })\n  }\n\n  /* List */\n  listGotoFirst(): void {\n    this.events.trigger('list-goto-first')\n  }\n\n  getCommentNodes() {\n    return this.list.getCommentNodes()\n  }\n\n  getComments() {\n    return this.data.getComments()\n  }\n\n  getCommentList = this.getCommentNodes\n  getCommentDataList = this.getComments\n\n  /* Editor */\n  editorShowLoading(): void {\n    this.editor.showLoading()\n  }\n\n  editorHideLoading(): void {\n    this.editor.hideLoading()\n  }\n\n  editorShowNotify(msg, type): void {\n    this.editor.showNotify(msg, type)\n  }\n\n  editorResetState(): void {\n    this.editor.resetState()\n  }\n\n  /* Sidebar */\n  showSidebar(payload?: SidebarShowPayload): void {\n    this.sidebarLayer.show(payload)\n  }\n\n  hideSidebar(): void {\n    this.sidebarLayer.hide()\n  }\n\n  /* Checker */\n  checkAdmin(payload: CheckerPayload): Promise<void> {\n    return this.checkerLauncher.checkAdmin(payload)\n  }\n\n  checkCaptcha(payload: CheckerCaptchaPayload): Promise<void> {\n    return this.checkerLauncher.checkCaptcha(payload)\n  }\n\n  /* Events */\n  on(name: any, handler: any) {\n    this.events.on(name, handler)\n  }\n\n  off(name: any, handler: any) {\n    this.events.off(name, handler)\n  }\n\n  trigger(name: any, payload?: any) {\n    this.events.trigger(name, payload)\n  }\n\n  /* i18n */\n  $t(key: I18n.I18nKeys, args: {[key: string]: string} = {}): string {\n    return I18n.t(key, args)\n  }\n\n  setDarkMode(darkMode: boolean|'auto'): void {\n    this.updateConf({ darkMode })\n  }\n\n  updateConf(nConf: Partial<ArtalkConfig>): void {\n    this.conf = mergeDeep(this.conf, handelCustomConf(nConf, false))\n    this.mounted && this.events.trigger('updated', this.conf)\n  }\n\n  getConf(): ArtalkConfig {\n    return this.conf\n  }\n\n  getEl(): HTMLElement {\n    return this.$root\n  }\n\n  getMarked() {\n    return marked.getInstance()\n  }\n\n  watchConf<T extends (keyof ArtalkConfig)[]>(keys: T, effect: (conf: Pick<ArtalkConfig, T[number]>) => void): void {\n    watchConf(this, keys, effect)\n  }\n}\n\nexport default Context\n","import $t from '@/i18n'\nimport * as Utils from '../lib/utils'\n\ntype BtnClickHandler = (btnEl: HTMLElement, dialog: Dialog) => boolean|void\n\n/**\n * 对话框\n */\nexport default class Dialog {\n  public $el: HTMLElement\n  public $content: HTMLElement\n  public $actions: HTMLElement\n\n  constructor (contentEl: HTMLElement) {\n    this.$el = Utils.createElement(\n      `<div class=\"atk-layer-dialog-wrap\">\n        <div class=\"atk-layer-dialog\">\n          <div class=\"atk-layer-dialog-content\"></div>\n          <div class=\"atk-layer-dialog-actions\"></div>\n        </div>\n      </div>`\n    )\n\n    // 按钮\n    this.$actions = this.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!\n\n    // 内容\n    this.$content = this.$el.querySelector('.atk-layer-dialog-content')!\n    this.$content.appendChild(contentEl)\n  }\n\n  /** 按钮 · 确定 */\n  public setYes(handler: BtnClickHandler) {\n    const btn = Utils.createElement<HTMLButtonElement>(\n      `<button data-action=\"confirm\">${$t('confirm')}</button>`\n    )\n    btn.onclick = this.onBtnClick(handler)\n    this.$actions.appendChild(btn)\n\n    return this\n  }\n\n  /** 按钮 · 取消 */\n  public setNo(handler: BtnClickHandler) {\n    const btn = Utils.createElement<HTMLButtonElement>(\n      `<button data-action=\"cancel\">${$t('cancel')}</button>`\n    )\n    btn.onclick = this.onBtnClick(handler)\n    this.$actions.appendChild(btn)\n\n    return this\n  }\n\n  private onBtnClick(handler: BtnClickHandler) {\n    return (evt: Event) => {\n      const re = handler(evt.currentTarget as HTMLElement, this)\n      if (re === undefined || re === true) {\n        this.$el.remove()\n      }\n    }\n  }\n}\n","import type { NotifyLevel } from '@/types'\nimport * as Utils from './utils'\n\n/** 显示加载 */\nexport function showLoading(parentElem: HTMLElement, conf?: { transparentBg?: boolean }) {\n  // Use :scope https://developer.mozilla.org/en-US/docs/Web/CSS/:scope\n  let $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\n  if (!$loading) {\n    $loading = Utils.createElement(\n    `<div class=\"atk-loading\" style=\"display: none;\">\n      <div class=\"atk-loading-spinner\">\n        <svg viewBox=\"25 25 50 50\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\" stroke-miterlimit=\"10\"></circle></svg>\n      </div>\n    </div>`)\n    if (conf?.transparentBg) $loading.style.background = 'transparent'\n    parentElem.appendChild($loading)\n  }\n  $loading.style.display = ''\n\n  // spinner 延迟显示，若加载等待时间太短，没必要显示（闪一下即可）\n  const $spinner = $loading.querySelector<HTMLElement>('.atk-loading-spinner')\n  if ($spinner) {\n    $spinner.style.display = 'none'\n    window.setTimeout(() => {\n      if ($spinner.isConnected) $spinner.style.display = ''\n    }, 500)\n  }\n}\n\n/** 隐藏加载 */\nexport function hideLoading(parentElem: HTMLElement) {\n  const $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\n  if ($loading) $loading.style.display = 'none'\n}\n\n/** 元素加载动画 */\nexport function setLoading(val: boolean, parentElem: HTMLElement) {\n  if (val) showLoading(parentElem)\n  else hideLoading(parentElem)\n}\n\n/** 元素是否用户可见 */\nexport function isVisible(el: HTMLElement, viewport: HTMLElement = document.documentElement) {\n  const viewportHeight = viewport.clientHeight\n\n  const docViewTop = viewport.scrollTop\n  const docViewBottom = docViewTop + viewportHeight\n\n  const rect = el.getBoundingClientRect()\n  const elemTop = rect.top + docViewTop\n  const elemBottom = elemTop + rect.height\n\n  return (elemBottom <= docViewBottom) //&& (elemTop >= docViewTop) 注释因为假如 el 比 viewport 还高就会失效\n}\n\n/** 滚动到元素中心 */\nexport function scrollIntoView(elem: HTMLElement, enableAnim: boolean = true, relativeTo?: HTMLElement) {\n  let top: number\n\n  if (relativeTo) {\n    const containerRect = relativeTo.getBoundingClientRect()\n    const elementRect = elem.getBoundingClientRect()\n    top = elementRect.top - containerRect.top + relativeTo.scrollTop - relativeTo.clientHeight / 2 + elem.clientHeight / 2\n  } else {\n    const rect = elem.getBoundingClientRect()\n    const elemTop = rect.top + window.scrollY\n    top = elemTop - (window.innerHeight / 2 - rect.height / 2)\n  }\n\n  const scrollOptions: ScrollToOptions = {\n    top, left: 0,\n    // behavior: enableAnim ? 'smooth' : 'instant',\n    behavior: 'instant'\n  }\n\n  if (relativeTo) relativeTo.scroll(scrollOptions)\n  else window.scroll(scrollOptions)\n}\n\n/** 显示消息 */\nexport function showNotify(\n  wrapElem: HTMLElement,\n  msg: string,\n  type: NotifyLevel,\n) {\n  const colors = { s: '#57d59f', e: '#ff6f6c', w: '#ffc721', i: '#2ebcfc' }\n  const timeout = 3000 // 持续显示时间 ms\n\n  const notifyElem = Utils.createElement(\n    `<div class=\"atk-notify atk-fade-in\" style=\"background-color: ${colors[type]}\"><span class=\"atk-notify-content\"></span></div>`\n  )\n  const notifyContentEl = notifyElem.querySelector<HTMLElement>('.atk-notify-content')!\n  notifyContentEl.innerHTML = Utils.htmlEncode(msg).replace('\\n', '<br/>')\n\n  wrapElem.appendChild(notifyElem)\n\n  const notifyRemove = () => {\n    notifyElem.classList.add('atk-fade-out')\n    setTimeout(() => {\n      notifyElem.remove()\n    }, 200)\n  }\n\n  let timeoutFn: number\n  if (timeout > 0) {\n    timeoutFn = window.setTimeout(() => {\n      notifyRemove()\n    }, timeout)\n  }\n\n  notifyElem.addEventListener('click', () => {\n    notifyRemove()\n    window.clearTimeout(timeoutFn)\n  })\n}\n\n/** fade 动画 */\nexport function playFadeAnim(\n  elem: HTMLElement,\n  after?: () => void,\n  type: 'in' | 'out' = 'in'\n) {\n  elem.classList.add(`atk-fade-${type}`)\n  // 动画结束清除 class\n  const onAnimEnded = () => {\n    elem.classList.remove(`atk-fade-${type}`)\n    elem.removeEventListener('animationend', onAnimEnded)\n    if (after) after()\n  }\n  elem.addEventListener('animationend', onAnimEnded)\n}\n\n/** 渐入动画 */\nexport function playFadeInAnim(elem: HTMLElement, after?: () => void) {\n  playFadeAnim(elem, after, 'in')\n}\n\n/** 渐出动画 */\nexport function playFadeOutAnim(elem: HTMLElement, after?: () => void) {\n  playFadeAnim(elem, after, 'out')\n}\n\n/** 设置全局错误 */\nexport function setError(parentElem: HTMLElement, html: string | HTMLElement | null, title: string = '<span class=\"atk-error-title\">Artalk Error</span>') {\n  let elem = parentElem.querySelector<HTMLElement>('.atk-error-layer')\n  if (html === null) {\n    if (elem !== null) elem.remove()\n    return\n  }\n  if (!elem) {\n    elem = Utils.createElement(\n      `<div class=\"atk-error-layer\">${title}<span class=\"atk-error-text\"></span></div>`\n    )\n    parentElem.appendChild(elem)\n  }\n\n  const errorTextEl = elem.querySelector<HTMLElement>('.atk-error-text')!\n  errorTextEl.innerHTML = ''\n  if (html === null) return\n\n  if (html instanceof HTMLElement) {\n    errorTextEl.appendChild(html)\n  } else {\n    errorTextEl.innerText = html\n  }\n}\n\nexport function getScrollBarWidth() {\n  const inner = document.createElement('p')\n  inner.style.width = '100%'\n  inner.style.height = '200px'\n\n  const outer = document.createElement('div')\n  outer.style.position = 'absolute'\n  outer.style.top = '0px'\n  outer.style.left = '0px'\n  outer.style.visibility = 'hidden'\n  outer.style.width = '200px'\n  outer.style.height = '150px'\n  outer.style.overflow = 'hidden'\n  outer.appendChild(inner)\n\n  document.body.appendChild(outer)\n  const w1 = inner.offsetWidth\n  outer.style.overflow = 'scroll'\n  let w2 = inner.offsetWidth\n  if (w1 === w2) w2 = outer.clientWidth\n\n  document.body.removeChild(outer)\n\n  return (w1 - w2)\n}\n","import $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport type { CheckerCtx } from '.'\n\n/** 图片验证码 */\nexport function imgBody(checker: CheckerCtx) {\n  // 图片验证方式\n  const elem = Utils.createElement(\n    `<span><img class=\"atk-captcha-img\" src=\"${checker.get('img_data') || ''}\">${$t('captchaCheck')}</span>`\n  );\n\n  // 刷新验证码\n  elem.querySelector<HTMLElement>('.atk-captcha-img')!.onclick = () => {\n    const imgEl = elem.querySelector('.atk-captcha-img')\n    checker.getApi().captcha.getCaptcha()\n      .then((res) => {\n        imgEl!.setAttribute('src', res.data.img_data)\n      })\n      .catch((err) => {\n        console.error('Failed to get captcha image ', err)\n      })\n  }\n  return elem\n}\n\n/** iframe 形式的通用验证服务 */\nexport function iframeBody(checker: CheckerCtx) {\n  const $iframeWrap = Utils.createElement(`<div class=\"atk-checker-iframe-wrap\"></div>`)\n  const $iframe = Utils.createElement<HTMLIFrameElement>(`<iframe class=\"atk-fade-in\" referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>`)\n  $iframe.style.display = 'none'\n  Ui.showLoading($iframeWrap, { transparentBg: true })\n  $iframe.src = checker.getOpts().getCaptchaIframeURL()\n  $iframe.onload = () => {\n    $iframe.style.display = ''\n    Ui.hideLoading($iframeWrap)\n  }\n  $iframeWrap.append($iframe)\n\n  const $closeBtn = Utils.createElement(`<div class=\"atk-close-btn\"><i class=\"atk-icon atk-icon-close\"></i></div>`)\n  $iframeWrap.append($closeBtn)\n\n  checker.hideInteractInput()\n\n  // 轮询状态\n  let stop = false // 打断\n  const sleep = (ms: number) => new Promise((resolve) => { window.setTimeout(() => { resolve(null) }, ms) })\n  ;(async function queryStatus() {\n    await sleep(1000)\n    if (stop) return\n    let isPass = false\n    try {\n      const resp = await checker.getApi().captcha.getCaptchaStatus()\n      isPass = resp.data.is_pass\n    } catch { isPass = false }\n    if (isPass) {\n      checker.triggerSuccess()\n    } else {\n      queryStatus()\n    }\n  })()\n\n  $closeBtn.onclick = () => {\n    stop = true\n    checker.cancel()\n  }\n\n  return $iframeWrap\n}\n","\nimport type { Checker } from '.'\nimport * as render from './captcha-renders'\n\nconst CaptchaChecker: Checker<{}> = {\n  request(checker, inputVal) {\n    return checker.getApi().captcha.verifyCaptcha({\n      value: inputVal\n    })\n  },\n\n  body(checker) {\n    if (checker.get('iframe')) return render.iframeBody(checker)\n    return render.imgBody(checker)\n  },\n\n  onSuccess(checker, data, inputVal, formEl) {\n    checker.set('val', inputVal)\n  },\n\n  onError(checker, err, inputVal, formEl) {\n    formEl.querySelector<HTMLElement>('.atk-captcha-img')!.click() // 刷新验证码\n    formEl.querySelector<HTMLInputElement>('input[type=\"text\"]')!.value = '' // 清空输入框输入\n  }\n}\n\nexport default CaptchaChecker\n\n","import $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\nimport type { Checker } from '.'\n\nconst AdminChecker: Checker<{ token: string }> = {\n  inputType: 'password',\n\n  async request(checker, inputVal) {\n    return (await checker.getApi().user.login({\n      name: checker.getUser().getData().nick,\n      email: checker.getUser().getData().email,\n      password: inputVal\n    })).data\n  },\n\n  body(checker) {\n    return Utils.createElement(`<span>${$t('adminCheck')}</span>`)\n  },\n\n  onSuccess(checker, res, inputVal, formEl) {\n    checker.getUser().update({\n      isAdmin: true,\n      token: res.token\n    })\n    checker.getOpts().onReload()\n  },\n\n  onError(checker, err, inputVal, formEl) {}\n}\n\nexport default AdminChecker\n","import type { Api } from '@/api'\nimport Dialog from '@/components/dialog'\nimport $t from '@/i18n'\nimport type { ContextApi } from '@/types'\nimport type User from '@/lib/user'\nimport * as Utils from '@/lib/utils'\nimport CaptchaChecker from './captcha'\nimport AdminChecker from './admin'\n\nexport interface CheckerCaptchaPayload extends CheckerPayload {\n  imgData?: string\n  iframe?: string\n}\n\nexport interface CheckerPayload {\n  onSuccess?: () => void\n  onMount?: (dialogEl: HTMLElement) => void\n  onCancel?: () => void\n}\n\nexport interface CheckerLauncherOptions {\n  getCtx: () => ContextApi\n  getApi: () => Api\n  getCaptchaIframeURL: () => string\n  onReload: () => void\n}\n\nfunction wrapPromise<P extends CheckerPayload = CheckerPayload>(fn: (p: P) => void) {\n  return (payload: P) => new Promise<void>((resolve, reject) => {\n    const cancelFn = payload.onCancel\n    payload.onCancel = () => {\n      cancelFn && cancelFn()\n      reject(new Error('user canceled the checker'))\n    }\n    const successFn = payload.onSuccess\n    payload.onSuccess = () => {\n      successFn && successFn()\n      resolve()\n    }\n    fn(payload)\n  })\n}\n\n/**\n * Checker 发射台\n */\nexport default class CheckerLauncher {\n  constructor(private opts: CheckerLauncherOptions) { }\n\n  public checkCaptcha: ((payload: CheckerCaptchaPayload) => Promise<void>) = wrapPromise((p) => {\n    this.fire(CaptchaChecker, p, (ctx) => {\n      ctx.set('img_data', p.imgData)\n      ctx.set('iframe', p.iframe)\n    })\n  })\n\n  public checkAdmin: ((payload: CheckerPayload) => Promise<void>) = wrapPromise((p) => {\n    this.fire(AdminChecker, p)\n  })\n\n  public fire(checker: Checker, payload: CheckerPayload, postFire?: (c: CheckerCtx) => void) {\n    // 显示层\n    const layer = this.opts.getCtx().get('layerManager').create(`checker-${new Date().getTime()}`)\n    layer.show()\n\n    const close = () => {\n      layer.destroy()\n    }\n\n    // 构建 Checker 的上下文\n    const checkerStore: CheckerStore = {}\n    let hideInteractInput = false\n    const checkerCtx: CheckerCtx = {\n      set: (key, val) => { checkerStore[key] = val },\n      get: (key) => (checkerStore[key]),\n      getOpts: () => (this.opts),\n      getUser: () => (this.opts.getCtx().get('user')),\n      getApi: () => this.opts.getApi(),\n      hideInteractInput: () => {\n        hideInteractInput = true\n      },\n      triggerSuccess: () => {\n        close()\n        if (checker.onSuccess) checker.onSuccess(checkerCtx, \"\", \"\", formEl)\n        if (payload.onSuccess) payload.onSuccess()\n      },\n      cancel: () => {\n        close()\n        if (payload.onCancel) payload.onCancel()\n      }\n    }\n\n    if (postFire) postFire(checkerCtx)\n\n    // 创建表单\n    const formEl = Utils.createElement()\n    formEl.appendChild(checker.body(checkerCtx))\n\n    // 输入框\n    const $input = Utils.createElement<HTMLInputElement>(\n      `<input id=\"check\" type=\"${checker.inputType || 'text'}\" autocomplete=\"off\" required placeholder=\"\">`\n    )\n    formEl.appendChild($input)\n    setTimeout(() => $input.focus(), 80) // 延迟 Focus\n\n    // 绑定键盘事件\n    $input.onkeyup = (evt) => {\n      if (evt.key === 'Enter' || evt.keyCode === 13) {\n        // 按下回车键\n        evt.preventDefault()\n        layer\n          .getEl()\n          .querySelector<HTMLButtonElement>('button[data-action=\"confirm\"]')!\n          .click()\n      }\n    }\n\n    let btnTextOrg: string | undefined\n    const dialog = new Dialog(formEl)\n\n    // 确认按钮\n    dialog.setYes((btnEl) => {\n      const inputVal = $input.value.trim()\n\n      // 按钮操作\n      if (!btnTextOrg) btnTextOrg = btnEl.innerText\n      const btnTextSet = (btnText: string) => {\n        btnEl.innerText = btnText\n        btnEl.classList.add('error')\n      }\n      const btnTextRestore = () => {\n        btnEl.innerText = btnTextOrg || ''\n        btnEl.classList.remove('error')\n      }\n\n      btnEl.innerText = `${$t('loading')}...`\n\n      // 发送请求\n      checker\n        .request(checkerCtx, inputVal)\n        .then((data) => {\n          // 请求成功\n          close()\n\n          if (checker.onSuccess) checker.onSuccess(checkerCtx, data, inputVal, formEl)\n          if (payload.onSuccess) payload.onSuccess()\n        })\n        .catch((err) => {\n          // 请求失败\n          btnTextSet(String(err.msg || String(err)))\n\n          if (checker.onError) checker.onError(checkerCtx, err, inputVal, formEl)\n\n          // 错误显示 3s 后恢复按钮\n          const tf = setTimeout(() => btnTextRestore(), 3000)\n          $input.onfocus = () => {\n            btnTextRestore()\n            clearTimeout(tf)\n          }\n        })\n\n      return false\n    })\n\n    // 取消按钮\n    dialog.setNo(() => {\n      close()\n      if (payload.onCancel) payload.onCancel()\n      return false\n    })\n\n    if (hideInteractInput) {\n      $input.style.display = 'none'\n      dialog.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!.style.display = 'none'\n    }\n\n    // 层装载 dialog 元素\n    layer.getEl().append(dialog.$el)\n\n    // onMount 回调\n    if (payload.onMount) payload.onMount(dialog.$el)\n  }\n}\n\nexport interface Checker<T = any> {\n  el?: HTMLElement\n  inputType?: 'password' | 'text'\n  body: (checker: CheckerCtx) => HTMLElement\n  request: (checker: CheckerCtx, inputVal: string) => Promise<T>\n  onSuccess?: (checker: CheckerCtx, respData: T, inputVal: string, formEl: HTMLElement) => void\n  onError?: (checker: CheckerCtx, errData: any, inputVal: string, formEl: HTMLElement) => void\n}\n\ninterface CheckerStore {\n  val?: string\n  img_data?: string\n  iframe?: string\n}\n\nexport interface CheckerCtx {\n  get<K extends keyof CheckerStore>(key: K): CheckerStore[K]\n  set<K extends keyof CheckerStore>(key: K, val: CheckerStore[K]): void\n  getOpts(): CheckerLauncherOptions\n  getApi(): Api\n  getUser(): User\n  hideInteractInput(): void\n  triggerSuccess(): void\n  cancel(): void\n}\n","import type { ContextApi } from '@/types'\n\nexport default abstract class Component {\n  public $el!: HTMLElement\n  public get conf() {\n    return this.ctx.conf\n  }\n\n  public constructor(\n    public ctx: ContextApi\n  ) {}\n\n  getEl() {\n    return this.$el\n  }\n}\n","export default \"<div class=\\\"atk-main-editor\\\">\\n  <div class=\\\"atk-header\\\">\\n    <input name=\\\"nick\\\" class=\\\"atk-nick\\\" type=\\\"text\\\" required=\\\"required\\\">\\n    <input name=\\\"email\\\" class=\\\"atk-email\\\" type=\\\"email\\\" required=\\\"required\\\">\\n    <input name=\\\"link\\\" class=\\\"atk-link\\\" type=\\\"url\\\">\\n  </div>\\n  <div class=\\\"atk-textarea-wrap\\\">\\n    <textarea class=\\\"atk-textarea\\\"></textarea>\\n  </div>\\n  <div class=\\\"atk-plug-panel-wrap\\\" style=\\\"display: none;\\\"></div>\\n  <div class=\\\"atk-bottom\\\">\\n    <div class=\\\"atk-item atk-bottom-left\\\">\\n      <span class=\\\"atk-state-wrap\\\"></span>\\n      <span class=\\\"atk-plug-btn-wrap\\\"></span>\\n    </div>\\n    <div class=\\\"atk-item\\\">\\n      <button type=\\\"button\\\" class=\\\"atk-send-btn\\\"></button>\\n    </div>\\n  </div>\\n  <div class=\\\"atk-notify-wrap\\\"></div>\\n</div>\\n\"","import * as Utils from '../lib/utils'\nimport EditorHTML from './editor.html?raw'\n\nconst Sel = {\n  $header: '.atk-header',\n  $nick: '.atk-header [name=\"nick\"]',\n  $email: '.atk-header [name=\"email\"]',\n  $link: '.atk-header [name=\"link\"]',\n  $textareaWrap: '.atk-textarea-wrap',\n  $textarea: '.atk-textarea',\n  $bottom: '.atk-bottom',\n  $submitBtn: '.atk-send-btn',\n  $notifyWrap: '.atk-notify-wrap',\n  $bottomLeft: '.atk-bottom-left',\n  $stateWrap: '.atk-state-wrap',\n  $plugBtnWrap: '.atk-plug-btn-wrap',\n  $plugPanelWrap: '.atk-plug-panel-wrap',\n}\n\nexport interface EditorUI extends Record<keyof typeof Sel, HTMLElement> {\n  $el: HTMLElement\n  $nick: HTMLInputElement\n  $email: HTMLInputElement\n  $link: HTMLInputElement\n  $textarea: HTMLTextAreaElement\n  $submitBtn: HTMLButtonElement\n  $sendReplyBtn?: HTMLElement\n  $editCancelBtn?: HTMLElement\n}\n\nexport function render() {\n  const $el = Utils.createElement(EditorHTML)\n  const ui = { $el }\n  Object.entries(Sel).forEach(([k, sel]) => {\n    ui[k] = $el.querySelector(sel)\n  })\n  return ui as EditorUI\n}\n","import type { CommentData, EditorState } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport type PlugKit from './_kit'\n\n/**\n * Editor 插件\n */\ninterface EditorPlug {\n  $btn?: HTMLElement\n  $panel?: HTMLElement\n  contentTransformer?(rawContent: string): string\n  editorStateEffectWhen?: EditorState\n  editorStateEffect?(comment: CommentData): () => void\n}\n\nclass EditorPlug {\n  constructor(\n    protected kit: PlugKit\n  ) {\n  }\n\n  /** Use plug btn will add a btn on the bottom of editor */\n  useBtn(html: string = '<div></div>') {\n    this.$btn = Utils.createElement(`<span class=\"atk-plug-btn\">${html}</span>`)\n    return this.$btn\n  }\n\n  /** Use plug panel will show the panel when btn is clicked */\n  usePanel(html: string = '<div></div>') {\n    this.$panel = Utils.createElement(html)\n    return this.$panel\n  }\n\n  /** Use the content transformer to handle the content of the last submit by the editor */\n  useContentTransformer(func: (raw: string) => string) {\n    this.contentTransformer = func\n  }\n\n  /** Listen the event of panel show */\n  usePanelShow(func: () => void) {\n    this.kit.useEvents().on('panel-show', (aPlug) => {\n      if (aPlug === this) func()\n    })\n  }\n\n  /** Listen the event of panel hide */\n  usePanelHide(func: () => void) {\n    this.kit.useEvents().on('panel-hide', (aPlug) => {\n      if (aPlug === this) func()\n    })\n  }\n\n  /** Use editor state modifier */\n  useEditorStateEffect(stateName: EditorState, effectFn: (comment: CommentData) => () => void) {\n    this.editorStateEffectWhen = stateName\n    this.editorStateEffect = effectFn\n  }\n}\n\nexport default EditorPlug\n","import * as Utils from '@/lib/utils'\nimport EditorPlug from './_plug'\n\nexport default class Mover extends EditorPlug {\n  private isMoved = false\n\n  move(afterEl: HTMLElement) {\n    if (this.isMoved) return\n    this.isMoved = true\n\n    const editorEl = this.kit.useUI().$el\n\n    editorEl.after(Utils.createElement('<div class=\"atk-editor-travel-placeholder\"></div>'))\n\n    const $travelPlace = Utils.createElement('<div></div>')\n    afterEl.after($travelPlace)\n    $travelPlace.replaceWith(editorEl)\n\n    editorEl.classList.add('atk-fade-in') // 添加渐入动画\n    editorEl.classList.add('editor-traveling')\n  }\n\n  back() {\n    if (!this.isMoved) return\n    this.isMoved = false\n    this.kit.useGlobalCtx().$root.querySelector('.atk-editor-travel-placeholder')?.replaceWith(this.kit.useUI().$el)\n    this.kit.useUI().$el.classList.remove('editor-traveling')\n  }\n}\n","import type { EditorState, CommentData } from '@/types'\nimport * as Ui from '@/lib/ui'\nimport type Editor from './editor'\nimport Mover from '../plugins/editor/mover'\n\nexport default class EditorStateManager {\n  constructor(private editor: Editor) {}\n\n  private stateCurt: EditorState = 'normal'\n  private stateUnmountFn: (() => void)|null = null\n\n  /** Get current state */\n  get() {\n    return this.stateCurt\n  }\n\n  /**\n   * Switch editor state\n   *\n   * @param state The state to switch\n   * @param payload The cause of state switch\n   */\n  switch(state: EditorState, payload?: { $comment: HTMLElement, comment: CommentData }) {\n    // trigger unmount\n    if (this.stateUnmountFn) {\n      this.stateUnmountFn()\n      this.stateUnmountFn = null\n\n      // move editor back to the initial position\n      this.editor.getPlugs()?.get(Mover)?.back()\n    }\n\n    // invoke effect function and save unmount function\n    if (state !== 'normal' && payload) {\n      // move editor position\n      let moveAfterEl = payload.$comment\n      if (!this.editor.conf.flatMode) moveAfterEl = moveAfterEl.querySelector<HTMLElement>('.atk-footer')!\n      this.editor.getPlugs()?.get(Mover)?.move(moveAfterEl)\n\n      const $relative = this.editor.ctx.conf.scrollRelativeTo && this.editor.ctx.conf.scrollRelativeTo()\n      Ui.scrollIntoView(this.editor.getUI().$el, true, $relative)\n\n      const plugin = this.editor.getPlugs()?.getPlugs().find(p => p.editorStateEffectWhen === state)\n      if (plugin && plugin.editorStateEffect) {\n        this.stateUnmountFn = plugin.editorStateEffect(payload.comment)\n      }\n    }\n\n    // change current state\n    this.stateCurt = state\n  }\n}\n","import type { CommentData, ContextApi, EditorApi } from '@/types'\nimport Component from '../lib/component'\nimport * as Ui from '../lib/ui'\nimport marked from '../lib/marked'\nimport { render, EditorUI } from './ui'\nimport EditorStateManager from './state'\n\nclass Editor extends Component implements EditorApi {\n  private ui: EditorUI\n  private state: EditorStateManager\n\n  getUI() { return this.ui }\n  getPlugs() { return this.ctx.get('editorPlugs') }\n  getState() { return this.state.get() }\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    // init editor ui\n    this.ui = render()\n    this.$el = this.ui.$el\n\n    // init state manager\n    this.state = new EditorStateManager(this)\n  }\n\n  getHeaderInputEls() {\n    return { nick: this.ui.$nick, email: this.ui.$email, link: this.ui.$link }\n  }\n\n  getContentFinal() {\n    let content = this.getContentRaw()\n\n    // plug hook: final content transformer\n    const plugs = this.getPlugs()\n    if (plugs) content = plugs.getTransformedContent(content)\n\n    return content\n  }\n\n  getContentRaw() {\n    return this.ui.$textarea.value || ''\n  }\n\n  getContentMarked() {\n    return marked(this.getContentFinal())\n  }\n\n  setContent(val: string) {\n    this.ui.$textarea.value = val\n\n    // plug hook: content updated\n    this.getPlugs()?.getEvents().trigger('content-updated', val)\n  }\n\n  insertContent(val: string) {\n    if ((document as any).selection) {\n      this.ui.$textarea.focus();\n      (document as any).selection.createRange().text = val\n      this.ui.$textarea.focus()\n    } else if (this.ui.$textarea.selectionStart || this.ui.$textarea.selectionStart === 0) {\n      const sStart = this.ui.$textarea.selectionStart\n      const sEnd = this.ui.$textarea.selectionEnd\n      const sT = this.ui.$textarea.scrollTop\n      this.setContent(this.ui.$textarea.value.substring(0, sStart) + val + this.ui.$textarea.value.substring(sEnd, this.ui.$textarea.value.length))\n      this.ui.$textarea.focus()\n      this.ui.$textarea.selectionStart = sStart + val.length\n      this.ui.$textarea.selectionEnd = sStart + val.length\n      this.ui.$textarea.scrollTop = sT\n    } else {\n      this.ui.$textarea.focus()\n      this.ui.$textarea.value += val\n    }\n  }\n\n  focus() {\n    this.ui.$textarea.focus()\n  }\n\n  reset() {\n    this.setContent('')\n    this.resetState()\n  }\n\n  resetState() {\n    this.state.switch('normal')\n  }\n\n  setReply(comment: CommentData, $comment: HTMLElement) {\n    this.state.switch('reply', { comment, $comment })\n  }\n\n  setEditComment(comment: CommentData, $comment: HTMLElement) {\n    this.state.switch('edit', { comment, $comment })\n  }\n\n  showNotify(msg: string, type: any) {\n    Ui.showNotify(this.ui.$notifyWrap, msg, type)\n  }\n\n  showLoading() {\n    Ui.showLoading(this.ui.$el)\n  }\n\n  hideLoading() {\n    Ui.hideLoading(this.ui.$el)\n  }\n\n  submit() {\n    this.ctx.trigger('editor-submit')\n  }\n}\n\nexport default Editor\n","import type { ContextApi, SidebarShowPayload } from '@/types'\nimport Component from '@/lib/component'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport SidebarHTML from './sidebar-layer.html?raw'\nimport type { Layer } from './layer'\n\nexport default class SidebarLayer extends Component {\n  public layer?: Layer\n  public $header: HTMLElement\n  public $closeBtn: HTMLElement\n  public $iframeWrap: HTMLElement\n  public $iframe?: HTMLIFrameElement\n\n  constructor(ctx: ContextApi) {\n    super(ctx)\n\n    this.$el = Utils.createElement(SidebarHTML)\n    this.$header = this.$el.querySelector('.atk-sidebar-header')!\n    this.$closeBtn = this.$header.querySelector('.atk-sidebar-close')!\n    this.$iframeWrap = this.$el.querySelector('.atk-sidebar-iframe-wrap')!\n\n    this.$closeBtn.onclick = () => {\n      this.hide()\n    }\n\n    // event\n    this.ctx.on('user-changed', () => { this.refreshOnShow = true })\n  }\n\n  /** Refresh iFrame on show */\n  private refreshOnShow = true\n\n  /** Animation timer */\n  private animTimer?: any = undefined\n\n  /** 显示 */\n  public async show(conf: SidebarShowPayload = {}) {\n    this.$el.style.transform = '' // 动画清除，防止二次打开失效\n\n    // init layer\n    this.initLayer()\n    this.layer!.show()\n\n    // init iframe\n    if (this.refreshOnShow) {\n      this.refreshOnShow = false\n      this.$iframeWrap.innerHTML = ''\n      this.$iframe = this.createIframe(conf.view)\n      this.$iframeWrap.append(this.$iframe)\n    } else {\n      // Sync Dark Mode (reload iframe if not match)\n      const $iframe = this.$iframe!\n      const iFrameSrc = $iframe.src\n      if (this.conf.darkMode !== iFrameSrc.includes('darkMode=1')) {\n        this.iframeLoad($iframe, (this.conf.darkMode)\n          ? iFrameSrc.concat('&darkMode=1')\n          : iFrameSrc.replace('&darkMode=1', ''))\n      }\n    }\n\n    // 管理员身份验证 (若身份失效，弹出验证窗口)\n    this.authCheck({\n      onSuccess: () => this.show(conf) // retry show after auth check\n    })\n\n    // 执行滑动显示动画\n    this.animTimer = setTimeout(() => {\n      this.animTimer = undefined\n      this.$el.style.transform = 'translate(0, 0)'\n\n      setTimeout(() => {\n        this.ctx.getData().updateNotifies([])\n      }, 0)\n\n      this.ctx.trigger('sidebar-show')\n    }, 100)\n  }\n\n  /** 隐藏 */\n  public hide() {\n    this.layer?.hide()\n  }\n\n  // --------------------------------------------------\n\n  private async authCheck(opts: { onSuccess: () => void }) {\n    const data = (await this.ctx.getApi().user.getUserStatus({\n      ...this.ctx.getApi().getUserFields()\n    })).data\n    if (data.is_admin && !data.is_login) {\n      this.refreshOnShow = true\n\n      // show checker layer\n      this.ctx.checkAdmin({\n        onSuccess: () => {\n          setTimeout(() => {\n            opts.onSuccess()\n          }, 500)\n        },\n        onCancel: () => {\n          this.hide()\n        }\n      })\n\n      // hide sidebar layer\n      this.hide()\n    }\n  }\n\n  private initLayer() {\n    if (this.layer) return\n\n    this.layer = this.ctx.get('layerManager').create('sidebar', this.$el)\n    this.layer.setOnAfterHide(() => {\n      // 防止评论框被吞\n      this.ctx.editorResetState()\n\n      // interrupt animation\n      this.animTimer && clearTimeout(this.animTimer)\n\n      // perform transform\n      this.$el.style.transform = ''\n\n      // trigger event\n      this.ctx.trigger('sidebar-hide')\n    })\n  }\n\n  private createIframe(view?: string) {\n    const $iframe = Utils.createElement<HTMLIFrameElement>('<iframe referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>')\n\n    // 准备 Iframe 参数\n    const baseURL = (import.meta.env.DEV)  ? 'http://localhost:23367/'\n      : Utils.getURLBasedOnApi({\n        base: this.ctx.conf.server,\n        path: '/sidebar/',\n      })\n\n    const query: any = {\n      pageKey: this.conf.pageKey,\n      site: this.conf.site || '',\n      user: JSON.stringify(this.ctx.get('user').getData()),\n      time: +new Date()\n    }\n\n    if (view) query.view = view\n    if (this.conf.darkMode) query.darkMode = '1'\n\n    const urlParams = new URLSearchParams(query);\n    this.iframeLoad($iframe, `${baseURL}?${urlParams.toString()}`)\n\n    return $iframe\n  }\n\n  private iframeLoad($iframe: HTMLIFrameElement, src: string) {\n    $iframe.src = src\n\n    // 加载动画\n    Ui.showLoading(this.$iframeWrap)\n    $iframe.onload = () => {\n      Ui.hideLoading(this.$iframeWrap)\n    }\n  }\n}\n","export default \"<div class=\\\"atk-sidebar-layer\\\">\\n  <div class=\\\"atk-sidebar-inner\\\">\\n    <div class=\\\"atk-sidebar-header\\\">\\n      <div class=\\\"atk-sidebar-close\\\"><i class=\\\"atk-icon atk-icon-close\\\"></i></div>\\n    </div>\\n    <div class=\\\"atk-sidebar-iframe-wrap\\\"></div>\\n  </div>\\n</div>\\n\"","import type { CommentNode } from '@/comment'\nimport * as Ui from '@/lib/ui'\nimport * as ListNest from '@/list/nest'\nimport type { LayoutStrategyCreator } from '.'\n\nexport const createNestStrategy: LayoutStrategyCreator = (opts) => ({\n  import: (comments) => {\n    // 遍历 root 评论\n    const rootNodes = ListNest.makeNestCommentNodeList(comments, opts.nestSortBy, opts.nestMax)\n    rootNodes.forEach((rootNode: ListNest.CommentNode) => {\n      const rootC = opts.createCommentNode(rootNode.comment)\n\n      // 显示并播放渐入动画\n      opts.$commentsWrap?.appendChild(rootC.getEl())\n      rootC.getRender().playFadeAnim()\n\n      // 加载子评论\n      const loadChildren = (parentC: CommentNode, parentNode: ListNest.CommentNode) => {\n        parentNode.children.forEach((node: ListNest.CommentNode) => {\n          const childD = node.comment\n          const childC = opts.createCommentNode(childD, parentC.getData())\n\n          // 插入到父评论中\n          parentC.putChild(childC)\n\n          // 递归加载子评论\n          loadChildren(childC, node)\n        })\n      }\n      loadChildren(rootC, rootNode)\n\n      // 限高检测\n      rootC.getRender().checkHeightLimit()\n    })\n  },\n  insert: (comment, replyComment) => {\n    // 嵌套模式\n    const node = opts.createCommentNode(comment, replyComment)\n\n    if (comment.rid === 0) {\n      // root评论 新增\n      opts.$commentsWrap?.prepend(node.getEl())\n    } else {\n      // 子评论 新增\n      const parent = opts.findCommentNode(comment.rid)\n      if (parent) {\n        parent.putChild(node, (opts.nestSortBy === 'DATE_ASC' ? 'append' : 'prepend'))\n\n        // 若父评论存在 “子评论部分” 限高，取消限高\n        node.getParents().forEach((p) => {\n          p.getRender().heightLimitRemoveForChildren()\n        })\n      }\n    }\n\n    node.getRender().checkHeightLimit()\n\n    node.scrollIntoView() // 滚动到可以见\n    node.getRender().playFadeAnim() // 播放评论渐出动画\n  }\n})\n","import type { CommentData } from '@/types'\n\nexport type CommentNode = {\n  id: number\n  comment: CommentData\n  children: CommentNode[]\n  parent?: CommentNode\n  level: number\n}\n\nexport type SortByType = 'DATE_DESC'|'DATE_ASC'|'SRC_INDEX'|'VOTE_UP_DESC'\n\n// 构建树状结构列表\nexport function makeNestCommentNodeList(srcData: CommentData[], sortBy: SortByType = 'DATE_DESC', nestMax = 2) {\n  const nodeList: CommentNode[] = []\n\n  const roots = srcData.filter((o) => o.rid === 0)\n  roots.forEach((root: CommentData) => {\n    const rootNode: CommentNode = {\n      id: root.id,\n      comment: root,\n      children: [],\n      level: 1,\n    }\n\n    rootNode.parent = rootNode\n    nodeList.push(rootNode)\n\n    ;(function loadChildren(parentNode: CommentNode) {\n      const children = srcData.filter((o) => o.rid === parentNode.id)\n      if (children.length === 0) return\n      if (parentNode.level >= nestMax) parentNode = parentNode.parent!\n      children.forEach((child: CommentData) => {\n        const childNode: CommentNode = {\n          id: child.id,\n          comment: child,\n          children: [],\n          parent: parentNode,\n          level: parentNode.level + 1,\n        }\n\n        parentNode.children.push(childNode)\n        loadChildren(childNode)\n      })\n    })(rootNode)\n  })\n\n  // 排序\n  const sortFunc = (a: CommentNode, b: CommentNode): number => {\n    let v = a.id - b.id\n    if (sortBy === 'DATE_ASC') v = +new Date(a.comment.date) - +new Date(b.comment.date)\n    else if (sortBy === 'DATE_DESC') v = +new Date(b.comment.date) - +new Date(a.comment.date)\n    else if (sortBy === 'SRC_INDEX') v = srcData.indexOf(a.comment) - srcData.indexOf(b.comment)\n    else if (sortBy === 'VOTE_UP_DESC') v = b.comment.vote_up - a.comment.vote_up\n    return v\n  }\n\n  (function sortLevels(nodes: CommentNode[]) {\n    nodes.forEach((node) => {\n      node.children = node.children.sort(sortFunc)\n      sortLevels(node.children)\n    })\n  })(nodeList)\n\n  return nodeList\n}\n","import type { CommentData } from '@/types'\nimport * as Ui from '@/lib/ui'\nimport type { LayoutStrategyCreator, LayoutOptions } from '.'\n\nexport const createFlatStrategy: LayoutStrategyCreator = (opts) => ({\n  import: (comments) => {\n    comments.forEach((comment: CommentData) => {\n      const replyComment = (comment.rid === 0 ? undefined : comments.find(c => c.id === comment.rid))\n      insertComment(opts, 'append', comment, replyComment)\n    })\n  },\n  insert: (comment, replyComment) => {\n    const node = insertComment(opts, 'prepend', comment, replyComment)\n    node.scrollIntoView()\n  }\n})\n\n/** 导入评论 · 平铺模式 */\nfunction insertComment(opts: LayoutOptions, insertMode: 'append'|'prepend', comment: CommentData, replyComment?: CommentData | undefined) {\n  if (comment.is_collapsed) comment.is_allow_reply = false\n  const node = opts.createCommentNode(comment, replyComment)\n\n  // 可见评论添加到界面\n  // 注：不可见评论用于显示 “引用内容”\n  if (comment.visible) {\n    const $comment = node.getEl()\n    const $listCommentsWrap = opts.$commentsWrap\n    if (insertMode === 'append') $listCommentsWrap?.append($comment)\n    if (insertMode === 'prepend') $listCommentsWrap?.prepend($comment)\n    node.getRender().playFadeAnim()\n  }\n\n  // 平铺评论插入后 · 内容限高检测\n  // 插入列表的评论 (visible=true) 和关联的评论 (visible=false) 都需要检测\n  node.getRender().checkHeightLimit()\n\n  return node\n}\n","import type { CommentData } from '@/types'\nimport type { CommentNode } from '@/comment'\nimport * as ListNest from '../nest'\nimport { createNestStrategy } from './nest'\nimport { createFlatStrategy } from './flat'\n\nexport interface LayoutOptions {\n  /** The comments wrap of list */\n  $commentsWrap: HTMLElement\n  nestSortBy: ListNest.SortByType\n  nestMax: number\n  flatMode: boolean\n\n  createCommentNode(comment: CommentData, replyComment?: CommentData): CommentNode\n  findCommentNode(id: number): CommentNode|undefined\n}\n\nexport interface LayoutStrategy {\n  import(comments: CommentData[]): void\n  insert(comment: CommentData, replyComment?: CommentData): void\n}\n\nexport type LayoutStrategyCreator = (opts: LayoutOptions) => LayoutStrategy\n\nexport class ListLayout {\n  constructor(private options: LayoutOptions) {}\n\n  private getStrategy() {\n    return this.options.flatMode ? createFlatStrategy(this.options) : createNestStrategy(this.options)\n  }\n\n  import(comments: CommentData[]) {\n    this.getStrategy().import(comments)\n  }\n\n  insert(comment: CommentData, replyComment?: CommentData) {\n    this.getStrategy().insert(comment, replyComment)\n  }\n}\n","import * as Utils from '../lib/utils'\nimport $t from '../i18n'\n\nexport interface IHeightLimitConf {\n  /** Post expand btn click */\n  postExpandBtnClick?: (e: MouseEvent) => void\n  /** Allow Scroll */\n  scrollable?: boolean\n}\n\nexport interface IHeightLimitRule {\n  /** Target element need to check */\n  el: HTMLElement|null|undefined\n\n  /** Max height (unit: px) */\n  max: number\n\n  /** Whether or not the element contains `<img />` */\n  imgContains?: boolean\n}\n\nexport type THeightLimitRuleSet = IHeightLimitRule[]\n\n/** Check all elements below the max height limit */\nexport function check(conf: IHeightLimitConf, rules: THeightLimitRuleSet) {\n  rules.forEach(({\n    el, max: maxHeight, imgContains\n  }) => {\n    const _apply = () => {\n      if (!el) return\n      if (!conf.scrollable)\n        applyHeightLimit({ el, maxHeight, postBtnClick: conf.postExpandBtnClick })\n      else\n        applyScrollableHeightLimit({ el, maxHeight })\n    }\n\n    // checking\n    const _check = () => {\n      if (el && Utils.getHeight(el) > maxHeight) _apply() // 是否超过高度\n    }\n    _check() // check now\n    if (imgContains && el) // check again if img contains\n      Utils.onImagesLoaded(el, () => _check())\n  })\n}\n\n/** Height limit CSS class name */\nconst HEIGHT_LIMIT_CSS = 'atk-height-limit'\n\n/** Apply height limit on an element and add expand btn */\nexport function applyHeightLimit(obj: {\n  el: HTMLElement,\n  maxHeight: number,\n  postBtnClick?: (e: MouseEvent) => void\n}) {\n  if (!obj.el) return\n  if (!obj.maxHeight) return\n  if (obj.el.classList.contains(HEIGHT_LIMIT_CSS)) return\n\n  obj.el.classList.add(HEIGHT_LIMIT_CSS)\n  obj.el.style.height = `${obj.maxHeight}px`\n  obj.el.style.overflow = 'hidden'\n\n  /* Expand button */\n  const $expandBtn = Utils.createElement(`<div class=\"atk-height-limit-btn\">${$t('readMore')}</span>`)\n  $expandBtn.onclick = (e) => {\n    e.stopPropagation()\n    disposeHeightLimit(obj.el)\n\n    if (obj.postBtnClick) obj.postBtnClick(e)\n  }\n  obj.el.append($expandBtn)\n}\n\n/** Dispose height limit on an element and remove expand btn */\nexport function disposeHeightLimit($el: HTMLElement) {\n  if (!$el) return\n  if (!$el.classList.contains(HEIGHT_LIMIT_CSS)) return\n\n  $el.classList.remove(HEIGHT_LIMIT_CSS)\n  Array.from($el.children).forEach((e) => {\n    if (e.classList.contains('atk-height-limit-btn')) e.remove()\n  })\n  $el.style.height = ''\n  $el.style.overflow = ''\n}\n\n/** Height limit scrollable CSS class name */\nconst HEIGHT_LIMIT_SCROLL_CSS = 'atk-height-limit-scroll'\n\n/** Apply scrollable height limit */\nexport function applyScrollableHeightLimit(obj: {\n  el: HTMLElement,\n  maxHeight: number\n}) {\n  if (!obj.el) return\n  if (obj.el.classList.contains(HEIGHT_LIMIT_SCROLL_CSS)) return\n  obj.el.classList.add(HEIGHT_LIMIT_SCROLL_CSS)\n  obj.el.style.height = `${obj.maxHeight}px`\n}\n","import $t from '@/i18n'\nimport * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * 评论头部界面\n */\nexport default function renderHeader(r: Render) {\n  Object.entries({\n    renderNick, renderVerifyBadge, renderDate, renderUABadge\n  }).forEach(([name, render]) => {\n    render(r)\n  })\n}\n\nfunction renderNick(r: Render) {\n  r.$headerNick = r.$el.querySelector<HTMLElement>('.atk-nick')!\n\n  if (r.data.link) {\n    const $nickA = Utils.createElement<HTMLLinkElement>('<a target=\"_blank\" rel=\"noreferrer noopener nofollow\"></a>')\n    $nickA.innerText = r.data.nick\n    $nickA.href = Utils.isValidURL(r.data.link) ? r.data.link : `https://${r.data.link}`\n    r.$headerNick.append($nickA)\n  } else {\n    r.$headerNick.innerText = r.data.nick\n  }\n}\n\nfunction renderVerifyBadge(ctx: Render) {\n  ctx.$headerBadgeWrap = ctx.$el.querySelector<HTMLElement>('.atk-badge-wrap')!\n  ctx.$headerBadgeWrap.innerHTML = ''\n\n  const badgeText = ctx.data.badge_name\n  const badgeColor = ctx.data.badge_color\n  if (badgeText) {\n    const $badge = Utils.createElement(`<span class=\"atk-badge\"></span>`)\n    $badge.innerText = badgeText.replace('管理员', $t('admin')) // i18n patch\n    $badge.style.backgroundColor = badgeColor || ''\n    ctx.$headerBadgeWrap.append($badge)\n  }\n\n  if (ctx.data.is_pinned) {\n    const $pinnedBadge = Utils.createElement(`<span class=\"atk-pinned-badge\">${$t('pin')}</span>`) // 置顶徽章\n    ctx.$headerBadgeWrap.append($pinnedBadge)\n  }\n}\n\nfunction renderDate(ctx: Render) {\n  const $date = ctx.$el.querySelector<HTMLElement>('.atk-date')!\n  $date.innerText = ctx.comment.getDateFormatted()\n  $date.setAttribute('data-atk-comment-date', String(+new Date(ctx.data.date)))\n}\n\nfunction renderUABadge(ctx: Render) {\n  if (!ctx.opts.uaBadge && !ctx.data.ip_region) return\n\n  let $uaWrap = ctx.$header.querySelector('atk-ua-wrap')\n  if (!$uaWrap) {\n    $uaWrap = Utils.createElement(`<span class=\"atk-ua-wrap\"></span>`)\n    ctx.$header.append($uaWrap)\n  }\n\n  $uaWrap.innerHTML = ''\n\n  if (ctx.data.ip_region) {\n    const $regionBadge = Utils.createElement(`<span class=\"atk-region-badge\"></span>`)\n    $regionBadge.innerText = ctx.data.ip_region\n    $uaWrap.append($regionBadge)\n  }\n\n  if (ctx.opts.uaBadge) {\n    const { browser, os } = ctx.comment.getUserUA()\n    if (String(browser).trim()) {\n      const $uaBrowser = Utils.createElement(`<span class=\"atk-ua ua-browser\"></span>`)\n      $uaBrowser.innerText = browser\n      $uaWrap.append($uaBrowser)\n    }\n\n    if (String(os).trim()) {\n      const $usOS = Utils.createElement(`<span class=\"atk-ua ua-os\"></span>`)\n      $usOS.innerText = os\n      $uaWrap.append($usOS)\n    }\n  }\n}\n","import $t from '@/i18n'\nimport * as Utils from '../lib/utils'\n\ninterface ActionBtnOptions {\n  /** 按钮文字 (动态/静态) */\n  text: (() => string) | string\n\n  /** 仅管理员可用 */\n  adminOnly?: boolean\n\n  /** 确认操作 */\n  confirm?: boolean\n\n  /** 确认时提示文字 */\n  confirmText?: string\n}\n\n/**\n * 通用操作按钮\n */\nexport default class ActionBtn {\n  private opts: ActionBtnOptions\n  public $el: HTMLElement\n\n  public isLoading = false // 正在加载\n\n  public msgRecTimer?: number // 消息显示复原定时器\n  public msgRecTimerFunc?: Function // 消息显示复原操作\n  public get isMessaging() { return !!this.msgRecTimer } // 消息正在显示\n\n  public isConfirming = false // 正在确认\n  public confirmRecTimer?: number // 确认消息复原定时器\n\n  /** 构造函数 */\n  constructor(opts: ActionBtnOptions|string|(() => string)) {\n    this.$el = Utils.createElement(`<span class=\"atk-common-action-btn\"></span>`)\n\n    this.opts = (typeof opts !== 'object') ? ({ text: opts }) : opts\n    this.$el.innerText = this.getText()\n\n    // 仅管理员可操作\n    if (this.opts.adminOnly) this.$el.setAttribute('atk-only-admin-show', '')\n  }\n\n  /** 将按钮装载到指定元素 */\n  public appendTo(dom: HTMLElement) {\n    dom.append(this.$el)\n    return this\n  }\n\n  /** 获取按钮文字（动态/静态） */\n  private getText() {\n    return (typeof this.opts.text === 'string') ? this.opts.text : this.opts.text()\n  }\n\n  /** 设置点击事件 */\n  public setClick(func: Function) {\n    this.$el.onclick = (e) => {\n      e.stopPropagation() // 防止穿透\n\n      // 按钮处于加载状态，禁止点击\n      if (this.isLoading) {\n        return\n      }\n\n      // 操作确认\n      if (this.opts.confirm && !this.isMessaging) {\n        const confirmRestore = () => {\n          this.isConfirming = false\n          this.$el.classList.remove('atk-btn-confirm')\n          this.$el.innerText = this.getText()\n        }\n\n        if (!this.isConfirming) {\n          this.isConfirming = true\n          this.$el.classList.add('atk-btn-confirm')\n          this.$el.innerText = this.opts.confirmText || $t('actionConfirm')\n          this.confirmRecTimer = window.setTimeout(() => confirmRestore(), 5000)\n          return\n        }\n\n        if (this.confirmRecTimer) window.clearTimeout(this.confirmRecTimer)\n        confirmRestore()\n      }\n\n      // 立刻释放掉原有的定时器（当显示消息后，用户立刻点击时）\n      if (this.msgRecTimer) {\n        this.fireMsgRecTimer()\n        this.clearMsgRecTimer()\n        return\n      }\n\n      // 触发设定的点击事件\n      func()\n    }\n  }\n\n  /** 文字刷新（动态/静态） */\n  public updateText(text?: (() => string) | string) {\n    if (text) this.opts.text = text\n    this.setLoading(false)\n    this.$el.innerText = this.getText()\n  }\n\n  /** 设置加载状态 */\n  public setLoading(value: boolean, loadingText?: string) {\n    if (this.isLoading === value) return\n    this.isLoading = value\n    if (value) {\n      this.$el.classList.add('atk-btn-loading')\n      this.$el.innerText = loadingText || `${$t('loading')}...`\n    } else {\n      this.$el.classList.remove('atk-btn-loading')\n      this.$el.innerText = this.getText()\n    }\n  }\n\n  /** 错误消息 */\n  public setError(text: string) {\n    this.setMsg(text, 'atk-btn-error')\n  }\n\n  /** 警告消息 */\n  public setWarn(text: string) {\n    this.setMsg(text, 'atk-btn-warn')\n  }\n\n  /** 成功消息 */\n  public setSuccess(text: string) {\n    this.setMsg(text, 'atk-btn-success')\n  }\n\n  /** 设置消息 */\n  public setMsg(text: string, className?: string, duringTime?: number, after?: Function) {\n    this.setLoading(false)\n    if (className) this.$el.classList.add(className)\n    this.$el.innerText = text\n\n    // 设定复原 timer\n    this.setMsgRecTimer(() => {\n      this.$el.innerText = this.getText()\n      if (className) this.$el.classList.remove(className)\n      if (after) after()\n    }, duringTime || 2500) // 消息默认显示持续 2500s\n  }\n\n  /** 设置消息复原操作定时器 */\n  private setMsgRecTimer(func: Function, duringTime: number) {\n    this.fireMsgRecTimer()\n    this.clearMsgRecTimer()\n\n    this.msgRecTimerFunc = func\n    this.msgRecTimer = window.setTimeout(() => {\n      func()\n      this.clearMsgRecTimer()\n    }, duringTime)\n  }\n\n  /** 立刻触发器复原定时器 */\n  private fireMsgRecTimer() {\n    if (this.msgRecTimerFunc) this.msgRecTimerFunc()\n  }\n\n  /** 仅清除 timer */\n  private clearMsgRecTimer() {\n    if (this.msgRecTimer) window.clearTimeout(this.msgRecTimer)\n    this.msgRecTimer = undefined\n    this.msgRecTimerFunc = undefined\n  }\n}\n","import $t from '@/i18n'\nimport * as Utils from '../../lib/utils'\nimport ActionBtn from '../../components/action-btn'\nimport type Render from '../render'\n\n/**\n * 评论操作按钮界面\n */\nexport default function renderActions(r: Render) {\n  Object.entries({\n    renderVote, renderReply,\n    // 管理员操作\n    renderCollapse, renderModerator, renderPin, renderEdit, renderDel\n  }).forEach(([name, render]) => {\n    render(r)\n  })\n}\n\n\n// 操作按钮 - 投票\nfunction renderVote(r: Render) {\n  if (!r.opts.vote) return // 关闭投票功能\n\n  // 赞同按钮\n  r.voteBtnUp = new ActionBtn(() => `${$t('voteUp')} (${r.data.vote_up || 0})`).appendTo(r.$actions)\n  r.voteBtnUp.setClick(() => {\n    r.comment.getActions().vote('up')\n  })\n\n  // 反对按钮\n  if (r.opts.voteDown) {\n    r.voteBtnDown = new ActionBtn(() => `${$t('voteDown')} (${r.data.vote_down || 0})`).appendTo(r.$actions)\n    r.voteBtnDown.setClick(() => {\n      r.comment.getActions().vote('down')\n    })\n  }\n}\n\n// 操作按钮 - 回复\nfunction renderReply(r: Render) {\n  if (!r.data.is_allow_reply) return // 不允许回复\n\n  const replyBtn = Utils.createElement(`<span>${$t('reply')}</span>`)\n  r.$actions.append(replyBtn)\n  replyBtn.addEventListener('click', (e) => {\n    e.stopPropagation() // 防止穿透\n    r.opts.replyComment(r.data, r.$el)\n  })\n}\n\n// 操作按钮 - 折叠\nfunction renderCollapse(r: Render) {\n  const collapseBtn = new ActionBtn({\n    text: () => (r.data.is_collapsed ? $t('expand') : $t('collapse')),\n    adminOnly: true\n  })\n  collapseBtn.appendTo(r.$actions)\n  collapseBtn.setClick(() => {\n    r.comment.getActions().adminEdit('collapsed', collapseBtn)\n  })\n}\n\n// 操作按钮 - 审核\nfunction renderModerator(r: Render) {\n  const pendingBtn = new ActionBtn({\n    text: () => (r.data.is_pending ? $t('pending') : $t('approved')),\n    adminOnly: true\n  })\n  pendingBtn.appendTo(r.$actions)\n  pendingBtn.setClick(() => {\n    r.comment.getActions().adminEdit('pending', pendingBtn)\n  })\n}\n\n// 操作按钮 - 置顶\nfunction renderPin(r: Render) {\n  const pinnedBtn = new ActionBtn({\n    text: () => (r.data.is_pinned ? $t('unpin') : $t('pin')),\n    adminOnly: true\n  })\n  pinnedBtn.appendTo(r.$actions)\n  pinnedBtn.setClick(() => {\n    r.comment.getActions().adminEdit('pinned', pinnedBtn)\n  })\n}\n\n// 操作按钮 - 编辑\nfunction renderEdit(r: Render) {\n  const editBtn = new ActionBtn({\n    text: $t('edit'),\n    adminOnly: true\n  })\n  editBtn.appendTo(r.$actions)\n  editBtn.setClick(() => {\n    r.opts.editComment(r.data, r.$el)\n  })\n}\n\n// 操作按钮 - 删除\nfunction renderDel(r: Render) {\n  const delBtn = new ActionBtn({\n    text: $t('delete'),\n    confirm: true,\n    confirmText: $t('deleteConfirm'),\n    adminOnly: true,\n  })\n  delBtn.appendTo(r.$actions)\n  delBtn.setClick(() => {\n    r.comment.getActions().adminDelete(delBtn)\n  })\n}\n","import type Render from '../render'\nimport Avatar from './avatar'\nimport Header from './header'\nimport Content from './content'\nimport ReplyAt from './reply-at'\nimport ReplyTo from './reply-to'\nimport Pending from './pending'\nimport Actions from './actions'\n\nconst Renders = {\n  Avatar, Header, Content, ReplyAt,\n  ReplyTo, Pending, Actions\n}\n\nexport default function loadRenders(r: Render) {\n  Object.entries(Renders).forEach(([ name, render ]) => {\n    render(r)\n  })\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * 评论头像界面\n */\nexport default function renderAvatar(r: Render) {\n  const $avatar = r.$el.querySelector<HTMLElement>('.atk-avatar')!\n  const $avatarImg = Utils.createElement<HTMLImageElement>('<img />')\n\n  const avatarURLBuilder = r.opts.avatarURLBuilder\n  $avatarImg.src = avatarURLBuilder ? avatarURLBuilder(r.data) : r.comment.getGravatarURL()\n\n  if (r.data.link) {\n    const $avatarA = Utils.createElement<HTMLLinkElement>('<a target=\"_blank\" rel=\"noreferrer noopener nofollow\"></a>')\n    $avatarA.href = Utils.isValidURL(r.data.link) ? r.data.link : `https://${r.data.link}`\n    $avatarA.append($avatarImg)\n    $avatar.append($avatarA)\n  } else {\n    $avatar.append($avatarImg)\n  }\n}\n","import $t from '@/i18n'\nimport * as Utils from '../../lib/utils'\nimport * as Ui from '../../lib/ui'\nimport type Render from '../render'\n\n/**\n * 评论内容界面\n */\nexport default function renderContent(r: Render) {\n  if (!r.data.is_collapsed) {\n    r.$content.innerHTML = r.comment.getContentMarked()\n    r.$content.classList.remove('atk-hide', 'atk-collapsed')\n    return\n  }\n\n  // 内容 & 折叠\n  r.$content.classList.add('atk-hide', 'atk-type-collapsed')\n  const collapsedInfoEl = Utils.createElement(`\n    <div class=\"atk-collapsed\">\n      <span class=\"atk-text\">${$t('collapsedMsg')}</span>\n      <span class=\"atk-show-btn\">${$t('expand')}</span>\n    </div>`)\n  r.$body.insertAdjacentElement('beforeend', collapsedInfoEl)\n\n  const contentShowBtn = collapsedInfoEl.querySelector<HTMLElement>('.atk-show-btn')!\n  contentShowBtn.addEventListener('click', (e) => {\n    e.stopPropagation() // 防止穿透\n\n    if (r.$content.classList.contains('atk-hide')) {\n      r.$content.innerHTML = r.comment.getContentMarked()\n      r.$content.classList.remove('atk-hide')\n      Ui.playFadeInAnim(r.$content)\n      contentShowBtn.innerText = $t('collapse')\n    } else {\n      r.$content.innerHTML = ''\n      r.$content.classList.add('atk-hide')\n      contentShowBtn.innerText = $t('expand')\n    }\n  })\n}\n","import * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * 层级嵌套模式显示 AT 界面\n */\nexport default function renderReplyAt(r: Render) {\n  if (r.opts.flatMode || r.data.rid === 0) return // not 平铺模式 或 根评论\n  if (!r.opts.replyTo) return\n\n  r.$replyAt = Utils.createElement(`<span class=\"atk-item atk-reply-at\"><span class=\"atk-arrow\"></span><span class=\"atk-nick\"></span></span>`)\n  r.$replyAt.querySelector<HTMLElement>('.atk-nick')!.innerText = `${r.opts.replyTo.nick}`\n  r.$replyAt.onclick = () => { r.comment.getActions().goToReplyComment() }\n\n  r.$headerBadgeWrap.insertAdjacentElement('afterend', r.$replyAt)\n}\n","import * as Utils from '@/lib/utils'\nimport marked from '@/lib/marked'\nimport $t from '@/i18n'\nimport type Render from '../render'\n\n/**\n * 关联评论显示 (被回复的评论)\n */\nexport default function renderReplyTo(r: Render) {\n  if (!r.opts.flatMode) return // 仅平铺模式显示\n  if (!r.opts.replyTo) return\n\n  r.$replyTo = Utils.createElement(`\n    <div class=\"atk-reply-to\">\n      <div class=\"atk-meta\">${$t('reply')} <span class=\"atk-nick\"></span>:</div>\n      <div class=\"atk-content\"></div>\n    </div>`)\n\n  // Comment author name\n  const $nick = r.$replyTo.querySelector<HTMLElement>('.atk-nick')!\n  $nick.innerText = `@${r.opts.replyTo.nick}`\n  $nick.onclick = () => { r.comment.getActions().goToReplyComment() }\n\n  // Comment content\n  let replyContent = marked(r.opts.replyTo.content)\n  if (r.opts.replyTo.is_collapsed) replyContent = `[${$t('collapsed')}]`\n  r.$replyTo.querySelector<HTMLElement>('.atk-content')!.innerHTML = replyContent\n\n  // Mount the replyTo element\n  r.$body.prepend(r.$replyTo)\n}\n","import $t from '@/i18n'\nimport * as Utils from '../../lib/utils'\nimport type Render from '../render'\n\n/**\n * 待审核状态界面\n */\nexport default function renderPending(r: Render) {\n  if (!r.data.is_pending) return\n\n  const pendingEl = Utils.createElement(`<div class=\"atk-pending\">${$t('pendingMsg')}</div>`)\n  r.$body.prepend(pendingEl)\n}\n","import type { CommentNode } from '.'\nimport ActionBtn from '../components/action-btn'\nimport * as Utils from '../lib/utils'\nimport * as Ui from '../lib/ui'\n\nimport * as HeightLimit from './height-limit'\nimport CommentHTML from './comment.html?raw'\nimport loadRenders from './renders'\n\nexport default class Render {\n  public comment: CommentNode\n\n  public get data() { return this.comment.getData() }\n  public get opts() { return this.comment.getOpts() }\n\n  public $el!: HTMLElement\n  public $main!: HTMLElement\n  public $header!: HTMLElement\n  public $headerNick!: HTMLElement\n  public $headerBadgeWrap!: HTMLElement\n  public $body!: HTMLElement\n  public $content!: HTMLElement\n  public $childrenWrap!: HTMLElement|null\n  public $actions!: HTMLElement\n  public voteBtnUp?: ActionBtn\n  public voteBtnDown?: ActionBtn\n\n  public $replyTo?: HTMLElement // 回复评论内容 (平铺下显示)\n  public $replyAt?: HTMLElement // 回复 AT（层级嵌套下显示）\n\n  public constructor(comment: CommentNode) {\n    this.comment = comment\n  }\n\n  /**\n   * Render the comment ui\n   *\n   * If comment data is updated, call this method to re-render the comment ui.\n   * The method will be called multiple times, so it should be idempotent.\n   *\n   * Renders may add event listeners to the comment ui, so it should be called only once or override the original.\n   * Please be aware of the memory leak caused by the event listener.\n   */\n  public render() {\n    // init ui elements\n    this.$el = Utils.createElement(CommentHTML)\n\n    this.$main = this.$el.querySelector('.atk-main')!\n    this.$header = this.$el.querySelector('.atk-header')!\n    this.$body = this.$el.querySelector('.atk-body')!\n    this.$content = this.$body.querySelector('.atk-content')!\n    this.$actions = this.$el.querySelector('.atk-actions')!\n\n    this.$el.setAttribute('id', `atk-comment-${this.data.id}`)\n\n    // call all renders\n    loadRenders(this)\n\n    // append children wrap if exists\n    if (this.$childrenWrap) {\n      this.$main.append(this.$childrenWrap)\n    }\n\n    return this.$el\n  }\n\n  /** 内容限高检测 */\n  public checkHeightLimit() {\n    const conf = this.opts.heightLimit\n    if (!conf || !conf.content || !conf.children) return // 关闭限高\n\n    const contentMaxH = conf.content\n    const childrenMaxH = conf.children\n\n    HeightLimit.check({\n      postExpandBtnClick: () => {\n        // 子评论数仅有 1，直接取消限高\n        const children = this.comment.getChildren()\n        if (children.length === 1) HeightLimit.disposeHeightLimit(children[0].getRender().$content)\n      },\n      scrollable: conf.scrollable\n    }, [\n      // 评论内容限高\n      { el: this.$content, max: contentMaxH, imgContains: true },\n      { el: this.$replyTo, max: contentMaxH, imgContains: true },\n      // 子评论区域限高（仅嵌套模式）\n      { el: this.$childrenWrap, max: childrenMaxH, imgContains: false }\n    ])\n  }\n\n  /** 子评论区域移除限高 */\n  public heightLimitRemoveForChildren() {\n    if (!this.$childrenWrap) return\n    HeightLimit.disposeHeightLimit(this.$childrenWrap)\n  }\n\n  /** 渐出动画 */\n  playFadeAnim() {\n    Ui.playFadeInAnim(this.comment.getRender().$el)\n  }\n\n  /** 渐出动画 · 评论内容区域 */\n  playFadeAnimForBody() {\n    Ui.playFadeInAnim(this.comment.getRender().$body)\n  }\n\n  /** Perform the flash animation */\n  playFlashAnim() {\n    // Make sure the class is removed\n    this.$el.classList.remove('atk-flash-once')\n    window.setTimeout(() => {\n      // Add the class to perform the animation\n      this.$el.classList.add('atk-flash-once')\n    }, 150)\n  }\n\n  /** 获取子评论 Wrap */\n  public getChildrenWrap() {\n    if (!this.$childrenWrap) {\n      // if not exists, create a new one\n      this.$childrenWrap = Utils.createElement('<div class=\"atk-comment-children\"></div>')\n      this.$main.append(this.$childrenWrap)\n    }\n    return this.$childrenWrap\n  }\n\n  /** 设置已读 */\n  public setUnread(val: boolean) {\n    if (val) this.$el.classList.add('atk-unread')\n    else this.$el.classList.remove('atk-unread')\n  }\n\n  /** 设置为可点击的评论 */\n  public setOpenable(val: boolean) {\n    if (val) this.$el.classList.add('atk-openable')\n    else this.$el.classList.remove('atk-openable')\n  }\n\n  /** 设置点击评论打开置顶 URL */\n  public setOpenURL(url: string) {\n    this.setOpenable(true)\n    this.$el.onclick = (evt) => {\n      evt.stopPropagation()\n      window.open(url)\n    }\n  }\n\n  /** 设置点击评论时的操作 */\n  public setOpenAction(action: () => void) {\n    this.setOpenable(true)\n    this.$el.onclick = (evt) => {\n      evt.stopPropagation()\n      action()\n    }\n  }\n}\n","export default \"<div class=\\\"atk-comment-wrap\\\">\\n  <div class=\\\"atk-comment\\\">\\n    <div class=\\\"atk-avatar\\\"></div>\\n    <div class=\\\"atk-main\\\">\\n      <div class=\\\"atk-header\\\">\\n        <span class=\\\"atk-item atk-nick\\\"></span>\\n        <span class=\\\"atk-badge-wrap\\\"></span>\\n        <span class=\\\"atk-item atk-date\\\"></span>\\n      </div>\\n      <div class=\\\"atk-body\\\">\\n        <div class=\\\"atk-content\\\"></div>\\n      </div>\\n      <div class=\\\"atk-footer\\\">\\n        <div class=\\\"atk-actions\\\"></div>\\n      </div>\\n    </div>\\n  </div>\\n</div>\\n\"","import ActionBtn from '@/components/action-btn'\nimport $t from '@/i18n'\nimport type { CommentNode } from '.'\n\nexport default class CommentActions {\n  private comment: CommentNode\n\n  private get data() { return this.comment.getData() }\n  private get opts() { return this.comment.getOpts() }\n  private getApi() { return this.comment.getOpts().getApi() }\n\n  public constructor(comment: CommentNode) {\n    this.comment = comment\n  }\n\n  /** 投票操作 */\n  public vote(type: 'up'|'down') {\n    const actionBtn = (type === 'up') ? this.comment.getRender().voteBtnUp : this.comment.getRender().voteBtnDown\n\n    this.getApi().votes.vote(`comment_${type}`, this.data.id, { ...this.getApi().getUserFields() })\n    .then((res) => {\n      this.data.vote_up = res.data.up\n      this.data.vote_down = res.data.down\n      this.comment.getRender().voteBtnUp?.updateText()\n      this.comment.getRender().voteBtnDown?.updateText()\n    })\n    .catch((err) => {\n      actionBtn?.setError($t('voteFail'))\n      console.log(err)\n    })\n  }\n\n  /** 管理员 - 评论状态修改 */\n  public adminEdit(type: 'collapsed'|'pending'|'pinned', btnElem: ActionBtn) {\n    if (btnElem.isLoading) return // 若正在修改中\n\n    btnElem.setLoading(true, `${$t('editing')}...`)\n\n    // 克隆并修改当前数据\n    const modify = { ...this.data }\n    if (type === 'collapsed') {\n      modify.is_collapsed = !modify.is_collapsed\n    } else if (type === 'pending') {\n      modify.is_pending = !modify.is_pending\n    } else if (type === 'pinned') {\n      modify.is_pinned = !modify.is_pinned\n    }\n\n    this.getApi().comments.updateComment(this.data.id, {\n      ...modify,\n    }).then((res) => {\n      btnElem.setLoading(false)\n\n      // 刷新当前 Comment UI\n      this.comment.setData(res.data)\n    }).catch((err) => {\n      console.error(err)\n      btnElem.setError($t('editFail'))\n    })\n  }\n\n  /** 管理员 - 评论删除 */\n  public adminDelete(btnElem: ActionBtn) {\n    if (btnElem.isLoading) return // 若正在删除中\n\n    btnElem.setLoading(true, `${$t('deleting')}...`)\n    this.getApi().comments.deleteComment(this.data.id)\n      .then(() => {\n        btnElem.setLoading(false)\n        if (this.opts.onDelete) this.opts.onDelete(this.comment)\n      })\n      .catch((e) => {\n        console.error(e)\n        btnElem.setError($t('deleteFail'))\n      })\n  }\n\n  /** 快速跳转到该评论 */\n  public goToReplyComment() {\n    const origHash = window.location.hash\n    const modifyHash = `#atk-comment-${this.data.rid}`\n\n    window.location.hash = modifyHash\n    if (modifyHash === origHash) window.dispatchEvent(new Event('hashchange')) // 强制触发事件\n  }\n}\n","import type { CommentData, ArtalkConfig, ContextApi } from '@/types'\nimport $t from '@/i18n'\nimport type { Api } from '../api'\nimport * as Ui from '../lib/ui'\nimport * as Utils from '../lib/utils'\nimport marked from '../lib/marked'\nimport UADetect from '../lib/detect'\nimport CommentUI from './render'\nimport CommentActions from './actions'\n\nexport interface CommentOptions {\n  // Hooks\n  onAfterRender?: () => void\n  onDelete?: Function\n\n  /** The comment being replied to (linked comment) */\n  replyTo?: CommentData\n\n  // Referenced from ArtalkConfig\n  flatMode: boolean\n  vote: boolean\n  voteDown: boolean\n  uaBadge: boolean\n  nestMax: number\n  gravatar: ArtalkConfig['gravatar']\n  heightLimit: ArtalkConfig['heightLimit']\n  avatarURLBuilder: ArtalkConfig['avatarURLBuilder']\n  scrollRelativeTo: ArtalkConfig['scrollRelativeTo']\n\n  // TODO: Move to plugin folder and remove from core\n  getApi: () => Api\n  replyComment: ContextApi['replyComment']\n  editComment: ContextApi['editComment']\n}\n\nexport default class CommentNode {\n  $el?: HTMLElement\n\n  private renderInstance: CommentUI\n  private actionInstance: CommentActions\n\n  private data: CommentData\n  private opts: CommentOptions\n\n  private parent: CommentNode|null\n  private children: CommentNode[] = []\n\n  private nestCurt: number // 当前嵌套层数\n\n  constructor(data: CommentData, opts: CommentOptions) {\n    this.opts = opts\n    this.data = { ...data }\n    this.data.date = this.data.date.replace(/-/g, '/') // 解决 Safari 日期解析 NaN 问题\n\n    this.parent = null\n    this.nestCurt = 1 // 现在已嵌套 n 层\n\n    this.actionInstance = new CommentActions(this)\n    this.renderInstance = new CommentUI(this)\n  }\n\n  /** 渲染 UI */\n  public render() {\n    const newEl = this.renderInstance.render()\n\n    if (this.$el) this.$el.replaceWith(newEl)\n    this.$el = newEl\n    // Please be aware of the memory leak, the $el may be replaced multiple times.\n    // If somewhere else has a reference to the old $el, it will cause a memory leak.\n    // So it's limited to use the $el reference by `getEl()`.\n    // The `getEl()` will always return the latest $el.\n\n    if (this.opts.onAfterRender) this.opts.onAfterRender()\n  }\n\n  /** 获取评论操作实例对象 */\n  public getActions() {\n    return this.actionInstance\n  }\n\n  /** 获取评论渲染器实例对象 */\n  public getRender() {\n    return this.renderInstance\n  }\n\n  /** 获取评论数据 */\n  public getData() {\n    return this.data\n  }\n\n  /** 设置数据 */\n  public setData(data: CommentData) {\n    this.data = data\n\n    this.render()\n    this.getRender().playFadeAnimForBody()\n  }\n\n  /** 获取父评论 */\n  public getParent() {\n    return this.parent\n  }\n\n  /** 获取所有子评论 */\n  public getChildren() {\n    return this.children\n  }\n\n  /** 获取当前嵌套层数 */\n  public getNestCurt() {\n    return this.nestCurt\n  }\n\n  /** 判断是否为根评论 */\n  public getIsRoot() {\n    return this.data.rid === 0\n  }\n\n  /** 获取评论 ID */\n  public getID() {\n    return this.data.id\n  }\n\n  /** 置入子评论 */\n  public putChild(childNode: CommentNode, insertMode: 'append'|'prepend' = 'append') {\n    childNode.parent = this\n    childNode.nestCurt = this.nestCurt + 1 // 嵌套层数 +1\n    this.children.push(childNode)\n\n    const $childrenWrap = this.getChildrenWrapEl()\n    const $childComment = childNode.getEl()\n    if (insertMode === 'append') $childrenWrap.append($childComment)\n    else if (insertMode === 'prepend') $childrenWrap.prepend($childComment)\n\n    childNode.getRender().playFadeAnim()\n    childNode.getRender().checkHeightLimit()  // 内容限高\n  }\n\n  /** 获取存放子评论的元素对象 */\n  public getChildrenWrapEl(): HTMLElement {\n    // console.log(this.nestCurt)\n    if (this.nestCurt >= this.opts.nestMax) {\n      return this.parent!.getChildrenWrapEl()\n    }\n    return this.getRender().getChildrenWrap()\n  }\n\n  /** 获取所有父评论 */\n  public getParents() {\n    const flattenParents: CommentNode[] = []\n    let parent = this.parent\n    while (parent) {\n      flattenParents.push(parent)\n      parent = parent.getParent()\n    }\n    return flattenParents\n  }\n\n  /**\n   * Get the element of the comment\n   *\n   * The `getEl()` will always return the latest $el after calling `render()`.\n   * Please be aware of the memory leak if you use the $el reference directly.\n   */\n  public getEl() {\n    if (!this.$el) throw new Error('comment element not initialized before `getEl()`')\n    return this.$el\n  }\n\n  /**\n   * Focus on the comment\n   *\n   * Scroll to the comment and perform flash animation\n   */\n  focus() {\n    if (!this.$el) throw new Error('comment element not initialized before `focus()`')\n\n    // 若父评论存在 “子评论部分” 限高，取消限高\n    this.getParents().forEach((p) => {\n      p.getRender().heightLimitRemoveForChildren()\n    })\n\n    // Scroll to comment\n    this.scrollIntoView()\n\n    // Perform flash animation\n    this.getRender().playFlashAnim()\n  }\n\n  scrollIntoView() {\n    this.$el && Ui.scrollIntoView(this.$el, false, this.opts.scrollRelativeTo && this.opts.scrollRelativeTo())\n  }\n\n  /**\n   * Remove the comment node\n   */\n  remove() {\n    this.$el?.remove()\n  }\n\n  /** 获取 Gravatar 头像 URL */\n  public getGravatarURL() {\n    return Utils.getGravatarURL({\n      mirror: this.opts.gravatar.mirror,\n      params: this.opts.gravatar.params,\n      emailMD5: this.data.email_encrypted,\n    })\n  }\n\n  /** 获取评论 markdown 解析后的内容 */\n  public getContentMarked() {\n    return marked(this.data.content)\n  }\n\n  /** 获取格式化后的日期 */\n  public getDateFormatted() {\n    return Utils.timeAgo(new Date(this.data.date), $t)\n  }\n\n  /** 获取用户 UserAgent 信息 */\n  public getUserUA() {\n    const info = UADetect(this.data.ua)\n    return {\n      browser: `${info.browser} ${info.version}`,\n      os: `${info.os} ${info.osVersion}`\n    }\n  }\n\n  /** 获取配置 */\n  public getOpts() {\n    return this.opts\n  }\n}\n","function Detect(userAgent?: string) {\n  const win = (window as any) || {}\n  const nav = navigator || {}\n\n  const u = String(userAgent || nav.userAgent)\n  const dest = {\n    os: '',\n    osVersion: '',\n    engine: '',\n    browser: '',\n    device: '',\n    language: '',\n    version: ''\n  }\n\n  // 内核\n  const engineMatch = {\n    Trident: u.includes('Trident') || u.includes('NET CLR'),\n    Presto: u.includes('Presto'),\n    WebKit: u.includes('AppleWebKit'),\n    Gecko: u.includes('Gecko/')\n  }\n\n  // 浏览器\n  const browserMatch = {\n    Safari: u.includes('Safari'),\n    Chrome: u.includes('Chrome') || u.includes('CriOS'),\n    IE: u.includes('MSIE') || u.includes('Trident'),\n    Edge: u.includes('Edge') || u.includes('Edg'),\n    Firefox: u.includes('Firefox') || u.includes('FxiOS'),\n    'Firefox Focus': u.includes('Focus'),\n    Chromium: u.includes('Chromium'),\n    Opera: u.includes('Opera') || u.includes('OPR'),\n    Vivaldi: u.includes('Vivaldi'),\n    Yandex: u.includes('YaBrowser'),\n    Kindle: u.includes('Kindle') || u.includes('Silk/'),\n    360: u.includes('360EE') || u.includes('360SE'),\n    UC: u.includes('UC') || u.includes(' UBrowser'),\n    QQBrowser: u.includes('QQBrowser'),\n    QQ: u.includes('QQ/'),\n    Baidu: u.includes('Baidu') || u.includes('BIDUBrowser'),\n    Maxthon: u.includes('Maxthon'),\n    Sogou: u.includes('MetaSr') || u.includes('Sogou'),\n    LBBROWSER: u.includes('LBBROWSER'),\n    '2345Explorer': u.includes('2345Explorer'),\n    TheWorld: u.includes('TheWorld'),\n    MIUI: u.includes('MiuiBrowser'),\n    Quark: u.includes('Quark'),\n    Qiyu: u.includes('Qiyu'),\n    Wechat: u.includes('MicroMessenger'),\n    Taobao: u.includes('AliApp(TB'),\n    Alipay: u.includes('AliApp(AP'),\n    Weibo: u.includes('Weibo'),\n    Douban: u.includes('com.douban.frodo'),\n    Suning: u.includes('SNEBUY-APP'),\n    iQiYi: u.includes('IqiyiApp'),\n  }\n\n  // 系统或平台\n  const osMatch = {\n    Windows: u.includes('Windows'),\n    Linux: u.includes('Linux') || u.includes('X11'),\n    'macOS': u.includes('Macintosh'),\n    Android: u.includes('Android') || u.includes('Adr'),\n    Ubuntu: u.includes('Ubuntu'),\n    FreeBSD: u.includes('FreeBSD'),\n    Debian: u.includes('Debian'),\n    'Windows Phone': u.includes('IEMobile') || u.includes('Windows Phone'),\n    BlackBerry: u.includes('BlackBerry') || u.includes('RIM'),\n    MeeGo: u.includes('MeeGo'),\n    Symbian: u.includes('Symbian'),\n    iOS: u.includes('like Mac OS X'),\n    'Chrome OS': u.includes('CrOS'),\n    WebOS: u.includes('hpwOS'),\n  }\n\n  // 设备\n  const deviceMatch = {\n    Mobile: u.includes('Mobi') || u.includes('iPh') || u.includes('480'),\n    Tablet: u.includes('Tablet') || u.includes('Pad') || u.includes('Nexus 7')\n  }\n\n  // 修正\n  if (deviceMatch.Mobile) {\n    deviceMatch.Mobile = !(u.includes('iPad'))\n  } else if (browserMatch.Chrome && u.includes('Edg')) {\n    // Chrome 内核的 Edge\n    browserMatch.Chrome = false\n    browserMatch.Edge = true\n  } else if (win.showModalDialog && win.chrome) {\n    browserMatch.Chrome = false\n    browserMatch['360'] = true\n  }\n\n  // 默认设备\n  dest.device = 'PC'\n\n  // 语言\n  dest.language = (() => {\n    const g = ((nav as any).browserLanguage || nav.language)\n    const arr = g.split('-')\n    if (arr[1]) arr[1] = arr[1].toUpperCase()\n    return arr.join('_')\n  })()\n\n  // 应用判断数据\n  const hash = {\n    engine: engineMatch,\n    browser: browserMatch,\n    os: osMatch,\n    device: deviceMatch,\n  }\n  Object.entries(hash).forEach(([type, match]) => {\n    Object.entries(match).forEach(([name, result]) => {\n      if (result === true) dest[type] = name\n    })\n  })\n\n  // 系统版本信息\n  const osVersion = {\n    Windows: () => {\n      const v = u.replace(/^.*Windows NT ([\\d.]+);.*$/, '$1')\n      const wvHash = {\n        '6.4': '10',\n        '6.3': '8.1',\n        '6.2': '8',\n        '6.1': '7',\n        '6.0': 'Vista',\n        '5.2': 'XP',\n        '5.1': 'XP',\n        '5.0': '2000',\n        '10.0': '10',\n        '11.0': '11' // 自定的，不是微软官方的判断方法\n      }\n      return wvHash[v] || v\n    },\n    Android: () => u.replace(/^.*Android ([\\d.]+);.*$/, '$1'),\n    iOS: () => u.replace(/^.*OS ([\\d_]+) like.*$/, '$1').replace(/_/g, '.'),\n    Debian: () => u.replace(/^.*Debian\\/([\\d.]+).*$/, '$1'),\n    'Windows Phone': () => u.replace(/^.*Windows Phone( OS)? ([\\d.]+);.*$/, '$2'),\n    'macOS': () => u.replace(/^.*Mac OS X ([\\d_]+).*$/, '$1').replace(/_/g, '.'),\n    WebOS: () => u.replace(/^.*hpwOS\\/([\\d.]+);.*$/, '$1')\n  }\n\n  dest.osVersion = ''\n  if (osVersion[dest.os]) {\n    dest.osVersion = osVersion[dest.os]()\n    if (dest.osVersion === u) {\n      dest.osVersion = ''\n    }\n  }\n\n  // 浏览器版本信息\n  const version = {\n    Safari: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\n    Chrome: () => u.replace(/^.*Chrome\\/([\\d.]+).*$/, '$1').replace(/^.*CriOS\\/([\\d.]+).*$/, '$1'),\n    IE: () => u.replace(/^.*MSIE ([\\d.]+).*$/, '$1').replace(/^.*rv:([\\d.]+).*$/, '$1'),\n    Edge: () => u.replace(/^.*(Edge|Edg|Edg[A-Z]{1})\\/([\\d.]+).*$/, '$2'),\n    Firefox: () => u.replace(/^.*Firefox\\/([\\d.]+).*$/, '$1').replace(/^.*FxiOS\\/([\\d.]+).*$/, '$1'),\n    'Firefox Focus': () => u.replace(/^.*Focus\\/([\\d.]+).*$/, '$1'),\n    Chromium: () => u.replace(/^.*Chromium\\/([\\d.]+).*$/, '$1'),\n    Opera: () => u.replace(/^.*Opera\\/([\\d.]+).*$/, '$1').replace(/^.*OPR\\/([\\d.]+).*$/, '$1'),\n    Vivaldi: () => u.replace(/^.*Vivaldi\\/([\\d.]+).*$/, '$1'),\n    Yandex: () => u.replace(/^.*YaBrowser\\/([\\d.]+).*$/, '$1'),\n    Kindle: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\n    Maxthon: () => u.replace(/^.*Maxthon\\/([\\d.]+).*$/, '$1'),\n    QQBrowser: () => u.replace(/^.*QQBrowser\\/([\\d.]+).*$/, '$1'),\n    QQ: () => u.replace(/^.*QQ\\/([\\d.]+).*$/, '$1'),\n    Baidu: () => u.replace(/^.*BIDUBrowser[\\s/]([\\d.]+).*$/, '$1'),\n    UC: () => u.replace(/^.*UC?Browser\\/([\\d.]+).*$/, '$1'),\n    Sogou: () => u.replace(/^.*SE ([\\d.X]+).*$/, '$1').replace(/^.*SogouMobileBrowser\\/([\\d.]+).*$/, '$1'),\n    '2345Explorer': () => u.replace(/^.*2345Explorer\\/([\\d.]+).*$/, '$1'),\n    TheWorld: () => u.replace(/^.*TheWorld ([\\d.]+).*$/, '$1'),\n    MIUI: () => u.replace(/^.*MiuiBrowser\\/([\\d.]+).*$/, '$1'),\n    Quark: () => u.replace(/^.*Quark\\/([\\d.]+).*$/, '$1'),\n    Qiyu: () => u.replace(/^.*Qiyu\\/([\\d.]+).*$/, '$1'),\n    Wechat: () => u.replace(/^.*MicroMessenger\\/([\\d.]+).*$/, '$1'),\n    Taobao: () => u.replace(/^.*AliApp\\(TB\\/([\\d.]+).*$/, '$1'),\n    Alipay: () => u.replace(/^.*AliApp\\(AP\\/([\\d.]+).*$/, '$1'),\n    Weibo: () => u.replace(/^.*weibo__([\\d.]+).*$/, '$1'),\n    Douban: () => u.replace(/^.*com.douban.frodo\\/([\\d.]+).*$/, '$1'),\n    Suning: () => u.replace(/^.*SNEBUY-APP([\\d.]+).*$/, '$1'),\n    iQiYi: () => u.replace(/^.*IqiyiVersion\\/([\\d.]+).*$/, '$1'),\n  }\n\n  dest.version = ''\n  if (version[dest.browser]) {\n    dest.version = version[dest.browser]()\n    if (dest.version === u) {\n      dest.version = ''\n    }\n  }\n\n  // 简化版本号\n  /* if (_this.osVersion.indexOf('.')) {\n    _this.osVersion = _this.osVersion.substring(0, _this.osVersion.indexOf('.'))\n  } */\n  if (dest.version.indexOf('.')) {\n    dest.version = dest.version.substring(0, dest.version.indexOf('.'))\n  }\n\n  // 修正\n  if (dest.os === 'iOS' && u.includes('iPad')) {\n    dest.os = 'iPadOS'\n  } else if (dest.browser === 'Edge' && !u.includes('Edg')) {\n    dest.engine = 'EdgeHTML'\n  } else if (dest.browser === 'MIUI') {\n    dest.os = 'Android'\n  } else if (dest.browser === 'Chrome' && Number(dest.version) > 27) {\n    dest.engine = 'Blink'\n  } else if (dest.browser === 'Opera' && Number(dest.version) > 12) {\n    dest.engine = 'Blink'\n  } else if (dest.browser === 'Yandex') {\n    dest.engine = 'Blink'\n  } else if (dest.browser === undefined) {\n    dest.browser = 'Unknow App'\n  }\n\n  return dest\n}\n\nexport default Detect\n","import * as Utils from '../lib/utils'\n\nexport interface ReadMoreBtnOptions {\n  /** 回调函数 */\n  onClick: (offset: number) => void\n\n  pageSize: number\n\n  text?: string\n}\n\n/**\n * 阅读更多按钮\n */\nexport default class ReadMoreBtn {\n  public opts: ReadMoreBtnOptions\n  public $el: HTMLElement\n  private $loading: HTMLElement\n  private $text: HTMLElement\n  private offset: number = 0\n  private total: number = 0\n  private origText: string = 'Load More'\n\n  /** 是否有更多内容 */\n  get hasMore() {\n    return this.total > (this.offset + this.opts.pageSize)\n  }\n\n  public constructor(opts: ReadMoreBtnOptions) {\n    this.opts = opts\n    this.origText = this.opts.text || this.origText\n\n    this.$el = Utils.createElement(\n    `<div class=\"atk-list-read-more\" style=\"display: none;\">\n      <div class=\"atk-list-read-more-inner\">\n        <div class=\"atk-loading-icon\" style=\"display: none;\"></div>\n        <span class=\"atk-text\">${this.origText}</span>\n      </div>\n    </div>`)\n\n    this.$loading = this.$el.querySelector<HTMLElement>('.atk-loading-icon')!\n    this.$text = this.$el.querySelector<HTMLElement>('.atk-text')!\n\n    this.$el.onclick = () => { this.click() }\n  }\n\n  click() {\n    if (this.hasMore) this.opts.onClick(this.offset + this.opts.pageSize)\n    this.checkDisabled()\n  }\n\n  /** 显示 */\n  show() {\n    this.$el.style.display = ''\n  }\n\n  /** 隐藏 */\n  hide() {\n    this.$el.style.display = 'none'\n  }\n\n  /** 加载 */\n  setLoading (isLoading: boolean) {\n    this.$loading.style.display = isLoading ? '' : 'none'\n    this.$text.style.display = isLoading ? 'none' : ''\n  }\n\n  /** 错误提示 */\n  showErr(errMsg: string) {\n    this.setLoading(false)\n\n    this.$text.innerText = errMsg\n    this.$el.classList.add('atk-err')\n    window.setTimeout(() => {\n      this.$text.innerText = this.origText\n      this.$el.classList.remove('atk-err')\n    }, 2000) // 2s后错误提示复原\n  }\n\n  /** 更新数据 */\n  public update(offset: number, total: number) {\n    this.offset = offset\n    this.total = total\n\n    this.checkDisabled()\n  }\n\n  public checkDisabled() {\n    if (this.hasMore) this.show()\n    else this.hide()\n  }\n}\n","import type { ListFetchParams } from '@/types'\nimport ReadMoreBtn from '@/components/read-more-btn'\nimport $t from '@/i18n'\nimport type { Paginator, IPgHolderOpt } from '.'\n\n/**\n * 阅读更多形式的分页\n */\nexport default class ReadMorePaginator implements Paginator {\n  private instance!: ReadMoreBtn\n  private onReachedBottom: (() => void) | null = null\n  private opt!: IPgHolderOpt\n\n  create(opt: IPgHolderOpt) {\n    this.opt = opt\n\n    this.instance = new ReadMoreBtn({\n      pageSize: opt.pageSize,\n      onClick: async (o) => {\n        opt.ctx.fetch({\n          offset: o,\n        })\n      },\n      text: $t('loadMore'),\n    })\n\n    // 滚动到底部自动加载\n    if (opt.readMoreAutoLoad) {\n      this.onReachedBottom = () => {\n        if (!this.instance.hasMore || this.opt.ctx.getData().getLoading()) return\n        this.instance.click()\n      }\n      this.opt.ctx.on('list-reach-bottom', this.onReachedBottom)\n    }\n\n    return this.instance.$el\n  }\n\n  setLoading(val: boolean) {\n    this.instance.setLoading(val)\n  }\n\n  update(offset: number, total: number) {\n    this.instance.update(offset, total)\n  }\n\n  showErr(msg: string) {\n    this.instance.showErr(msg)\n  }\n\n  next() {\n    this.instance.click()\n  }\n\n  getHasMore(): boolean {\n    return this.instance.hasMore\n  }\n\n  getIsClearComments(params: { offset?: number }): boolean {\n    return params.offset === 0\n  }\n\n  dispose(): void {\n    this.onReachedBottom && this.opt.ctx.off('list-reach-bottom', this.onReachedBottom)\n    this.instance.$el.remove()\n  }\n}\n","import * as Utils from '../lib/utils'\nimport * as Ui from '../lib/ui'\n\nexport interface PaginationOptions {\n  /** 每页条数 */\n  pageSize: number\n\n  /** 回调函数 */\n  onChange: (offset: number) => void\n}\n\nexport default class Pagination {\n  private opts: PaginationOptions\n  public total: number\n  public $el: HTMLElement\n  public $input: HTMLInputElement\n  public inputTimer?: number\n  public $prevBtn: HTMLElement\n  public $nextBtn: HTMLElement\n\n  public page: number = 1\n  get pageSize(): number {\n    return this.opts.pageSize\n  }\n  get offset(): number {\n    return this.pageSize * (this.page - 1)\n  }\n  get maxPage(): number {\n    return Math.ceil(this.total / this.pageSize)\n  }\n\n  public constructor(total: number, opts: PaginationOptions) {\n    this.total = total\n    this.opts = opts\n\n    this.$el = Utils.createElement(\n      `<div class=\"atk-pagination-wrap\">\n        <div class=\"atk-pagination\">\n          <div class=\"atk-btn atk-btn-prev\" aria-label=\"Previous page\">\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z\"></path></svg>\n          </div>\n          <input type=\"text\" class=\"atk-input\" aria-label=\"Enter the number of page\" />\n          <div class=\"atk-btn atk-btn-next\" aria-label=\"Next page\">\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z\"></path></svg>\n          </div>\n        </div>\n      </div>`)\n    this.$input = this.$el.querySelector('.atk-input')!\n    this.$input.value = `${this.page}`\n\n    this.$input.oninput = () => this.input()\n    this.$input.onkeydown = (e) => this.keydown(e)\n\n    this.$prevBtn = this.$el.querySelector('.atk-btn-prev')!\n    this.$nextBtn = this.$el.querySelector('.atk-btn-next')!\n\n    this.$prevBtn.onclick = () => this.prev()\n    this.$nextBtn.onclick = () => this.next()\n\n    this.checkDisabled()\n  }\n\n  public update(offset: number, total: number) {\n    this.page = Math.ceil(offset / this.pageSize) + 1\n    this.total = total\n\n    this.setInput(this.page)\n    this.checkDisabled()\n  }\n\n  public setInput(page: number) {\n    this.$input.value = `${page}`\n  }\n\n  public input(now: boolean = false) {\n    window.clearTimeout(this.inputTimer)\n\n    const value = this.$input.value.trim()\n\n    const modify = () => {\n      if (value === '') { this.setInput(this.page);return }\n      let page = Number(value)\n      if (Number.isNaN(page)) { this.setInput(this.page);return }\n      if (page < 1) { this.setInput(this.page);return }\n      if (page > this.maxPage) { this.setInput(this.maxPage);page = this.maxPage }\n      this.change(page)\n    }\n\n    // 延迟 800ms 执行\n    if (!now) this.inputTimer = window.setTimeout(() => modify(), 800)\n    else modify()\n  }\n\n  public prev() {\n    const page = this.page - 1\n    if (page < 1) { return }\n    this.change(page)\n  }\n\n  public next() {\n    const page = this.page + 1\n    if (page > this.maxPage) { return }\n    this.change(page)\n  }\n\n  public getHasMore() {\n    return this.page + 1 <= this.maxPage\n  }\n\n  public change(page: number) {\n    this.page = page\n    this.opts.onChange(this.offset)\n    this.setInput(page)\n    this.checkDisabled()\n  }\n\n  public checkDisabled() {\n    if (this.page + 1 > this.maxPage) {\n      this.$nextBtn.classList.add('atk-disabled')\n    } else {\n      this.$nextBtn.classList.remove('atk-disabled')\n    }\n\n    if (this.page - 1 < 1) {\n      this.$prevBtn.classList.add('atk-disabled')\n    } else {\n      this.$prevBtn.classList.remove('atk-disabled')\n    }\n  }\n\n  public keydown(e: KeyboardEvent) {\n    const keyCode = e.keyCode || e.which\n\n    if (keyCode === 38) {\n      // 上键\n      const page = Number(this.$input.value) + 1\n      if (page > this.maxPage) { return }\n      this.setInput(page);\n      this.input()\n    } else if (keyCode === 40) {\n      // 下键\n      const page = Number(this.$input.value) - 1\n      if (page < 1) { return }\n      this.setInput(page)\n      this.input()\n    } else if (keyCode === 13) {\n      // 回车\n      this.input(true)\n    }\n  }\n\n  /** 加载 */\n  setLoading (isLoading: boolean) {\n    if (isLoading) Ui.showLoading(this.$el)\n    else Ui.hideLoading(this.$el)\n  }\n}\n","import PaginationComponent from '@/components/pagination'\nimport type { Paginator, IPgHolderOpt } from '.'\n\n/**\n * 翻页形式的分页\n */\nexport default class UpDownPaginator implements Paginator {\n  private instance!: PaginationComponent\n\n  create(opt: IPgHolderOpt) {\n    this.instance = new PaginationComponent(opt.total, {\n      pageSize: opt.pageSize,\n      onChange: async (o) => {\n        opt.ctx.editorResetState() // 防止评论框被吞\n\n        opt.ctx.fetch({\n          offset: o,\n          onSuccess: () => {\n            opt.ctx.listGotoFirst()\n          }\n        })\n      }\n    })\n\n    return this.instance.$el\n  }\n\n  setLoading(val: boolean) {\n    this.instance.setLoading(val)\n  }\n\n  update(offset: number, total: number) {\n    this.instance.update(offset, total)\n  }\n\n  next() {\n    this.instance.next()\n  }\n\n  getHasMore(): boolean {\n    return this.instance.getHasMore()\n  }\n\n  getIsClearComments(): boolean {\n    return true\n  }\n\n  dispose(): void {\n    this.instance.$el.remove()\n  }\n}\n","import type { ArtalkConfig, ContextApi } from '@/types'\nimport $t from '@/i18n'\nimport { Paginator } from './paginator'\nimport ReadMorePaginator from './paginator/read-more'\nimport UpDownPaginator from './paginator/up-down'\n\nfunction createPaginatorByConf(conf: Pick<ArtalkConfig, 'pagination'>): Paginator {\n  if (conf.pagination.readMore) return new ReadMorePaginator()\n  return new UpDownPaginator()\n}\n\nfunction getPageDataByLastData(ctx: ContextApi): { offset: number, total: number } {\n  const last = ctx.getData().getListLastFetch()\n  const r = { offset: 0, total: 0 }\n  if (!last) return r\n\n  r.offset = last.params.offset\n  if (last.data) r.total = last.params.flatMode ? last.data.count : last.data.roots_count\n\n  return r\n}\n\nexport const initListPaginatorFunc = (ctx: ContextApi) => {\n  let paginator: Paginator|null = null\n\n  // Init paginator when conf loaded\n  ctx.watchConf(['pagination', 'locale'], (conf) => {\n    const list = ctx.get('list')\n\n    if (paginator) paginator.dispose() // if had been init, dispose it\n\n    // create paginator instance\n    paginator = createPaginatorByConf(conf)\n\n    // create paginator dom\n    const { offset, total } = getPageDataByLastData(ctx)\n    const $paginator = paginator.create({\n      ctx, pageSize: conf.pagination.pageSize, total,\n\n      readMoreAutoLoad: conf.pagination.autoLoad,\n    })\n\n    // mount paginator dom\n    list.$commentsWrap.after($paginator)\n\n    // update paginator info\n    paginator?.update(offset, total)\n  })\n\n  // When list loaded\n  ctx.on('list-loaded', (comments) => {\n    // update paginator info\n    const { offset, total } = getPageDataByLastData(ctx)\n    paginator?.update(offset, total)\n  })\n\n  // When list fetch\n  ctx.on('list-fetch', (params) => {\n    // if clear comments when fetch new page data\n    if (ctx.getData().getComments().length > 0 && paginator?.getIsClearComments(params)) {\n      ctx.getData().clearComments()\n    }\n  })\n\n  // When list error\n  ctx.on('list-failed', () => {\n    paginator?.showErr?.($t('loadFail'))\n  })\n\n  // loading\n  ctx.on('list-fetch', (params) => {\n    paginator?.setLoading(true)\n  })\n  ctx.on('list-fetched', ({ params }) => {\n    paginator?.setLoading(false)\n  })\n}\n","import type { ContextApi } from '@/types'\nimport Component from '@/lib/component'\nimport * as Utils from '@/lib/utils'\nimport { CommentNode } from '@/comment'\nimport ListHTML from './list.html?raw'\nimport { ListLayout } from './layout'\nimport { createCommentNode } from './comment'\nimport { initListPaginatorFunc } from './page'\n\nexport default class List extends Component {\n  /** 列表评论集区域元素 */\n  $commentsWrap!: HTMLElement\n  public getCommentsWrapEl() { return this.$commentsWrap }\n\n  protected commentNodes: CommentNode[] = []\n  getCommentNodes() { return this.commentNodes }\n\n  constructor (ctx: ContextApi) {\n    super(ctx)\n\n    // Init base element\n    this.$el = Utils.createElement(ListHTML)\n    this.$commentsWrap = this.$el.querySelector('.atk-list-comments-wrap')!\n\n    // Init paginator\n    initListPaginatorFunc(ctx)\n\n    // Bind events\n    this.initCrudEvents()\n  }\n\n  getListLayout({ forceFlatMode }: { forceFlatMode?: boolean } = {}) {\n    return new ListLayout({\n      $commentsWrap: this.$commentsWrap,\n      nestSortBy: this.ctx.conf.nestSort,\n      nestMax: this.ctx.conf.nestMax,\n      flatMode: typeof forceFlatMode === 'boolean' ? forceFlatMode : this.ctx.conf.flatMode as boolean,\n      // flatMode must be boolean because it had been handled when Artalk.init\n      createCommentNode: (d, r) => {\n        const node = createCommentNode(this.ctx, d, r, { forceFlatMode })\n        this.commentNodes.push(node) // store node instance\n        return node\n      },\n      findCommentNode: (id) => this.commentNodes.find(c => c.getID() === id),\n    })\n  }\n\n  private initCrudEvents() {\n    this.ctx.on('list-load', (comments) => {\n      // 导入数据\n      this.getListLayout().import(comments)\n    })\n\n    this.ctx.on('list-loaded', (comments) => {\n      if (comments.length === 0) {\n        this.commentNodes = []\n        this.$commentsWrap.innerHTML = ''\n      }\n    })\n\n    // When comment insert\n    this.ctx.on('comment-inserted', (comment) => {\n      this.getListLayout().insert(comment)\n    })\n\n    // When comment delete\n    this.ctx.on('comment-deleted', (comment) => {\n      const node = this.commentNodes.find(c => c.getID() === comment.id)\n      if (!node) { console.error(`comment node id=${comment.id} not found`);return }\n      node.remove()\n      this.commentNodes = this.commentNodes.filter(c => c.getID() !== comment.id)\n      // TODO: remove child nodes\n    })\n\n    // When comment update\n    this.ctx.on('comment-updated', (comment) => {\n      const node = this.commentNodes.find(c => c.getID() === comment.id)\n      node && node.setData(comment)\n    })\n  }\n}\n","export default \"<div class=\\\"atk-list\\\">\\n  <div class=\\\"atk-list-header\\\">\\n    <div class=\\\"atk-comment-count\\\">\\n      <div class=\\\"atk-text\\\"></div>\\n    </div>\\n    <div class=\\\"atk-right-action\\\">\\n      <span data-action=\\\"admin-close-comment\\\" class=\\\"atk-hide\\\" atk-only-admin-show></span>\\n      <span data-action=\\\"open-sidebar\\\" class=\\\"atk-hide atk-on\\\">\\n        <span class=\\\"atk-unread-badge\\\" style=\\\"display: none;\\\"></span>\\n        <div class=\\\"atk-text\\\"></div>\\n      </span>\\n    </div>\\n  </div>\\n  <div class=\\\"atk-list-body\\\">\\n    <div class=\\\"atk-list-comments-wrap\\\"></div>\\n  </div>\\n  <div class=\\\"atk-list-footer\\\">\\n    <div class=\\\"atk-copyright\\\"></div>\\n  </div>\\n</div>\\n\"","import type { ContextApi, CommentData } from '@/types'\nimport { CommentNode } from '@/comment'\n\ninterface CreateCommentNodeOptions {\n  forceFlatMode?: boolean\n}\n\nexport function createCommentNode(ctx: ContextApi, comment: CommentData, replyComment?: CommentData, opts?: CreateCommentNodeOptions): CommentNode {\n  const instance = new CommentNode(comment, {\n    onAfterRender: () => {\n      ctx.trigger('comment-rendered', instance)\n    },\n    onDelete: (c: CommentNode) => {\n      ctx.getData().deleteComment(c.getID())\n    },\n\n    replyTo: replyComment,\n\n    // TODO simplify reference\n    flatMode: typeof opts?.forceFlatMode === 'boolean' ? opts?.forceFlatMode : ctx.conf.flatMode as boolean,\n    gravatar: ctx.conf.gravatar,\n    nestMax: ctx.conf.nestMax,\n    heightLimit: ctx.conf.heightLimit,\n    avatarURLBuilder: ctx.conf.avatarURLBuilder,\n    scrollRelativeTo: ctx.conf.scrollRelativeTo,\n    vote: ctx.conf.vote,\n    voteDown: ctx.conf.voteDown,\n    uaBadge: ctx.conf.uaBadge,\n\n    // TODO: move to plugin folder and remove from core\n    getApi: () => ctx.getApi(),\n    replyComment: (c, $el) => ctx.replyComment(c, $el),\n    editComment: (c, $el) => ctx.editComment(c, $el)\n  })\n\n  // 渲染元素\n  instance.render()\n\n  return instance\n}\n","import * as Ui from '@/lib/ui'\n\nlet bodyOrgOverflow: string\nlet bodyOrgPaddingRight: string\n\nexport function getScrollbarHelper() {\n  return {\n    init() {\n      bodyOrgOverflow = document.body.style.overflow\n      bodyOrgPaddingRight = document.body.style.paddingRight\n    },\n\n    unlock() {\n      document.body.style.overflow = bodyOrgOverflow\n      document.body.style.paddingRight = bodyOrgPaddingRight\n    },\n\n    lock() {\n      document.body.style.overflow = 'hidden'\n      const barPaddingRight = parseInt(window.getComputedStyle(document.body, null).getPropertyValue('padding-right'), 10)\n      document.body.style.paddingRight = `${Ui.getScrollBarWidth() + barPaddingRight || 0}px`\n    }\n  }\n}\n","export interface LayerOptions {\n  onShow: () => void\n  onHide: () => void\n}\n\nexport class Layer {\n  private allowMaskClose = true\n  private onAfterHide?: () => void\n\n  constructor(\n    private $el: HTMLElement,\n    private opts: LayerOptions\n  ) {\n  }\n\n  setOnAfterHide(func: () => void) {\n    this.onAfterHide = func\n  }\n\n  setAllowMaskClose(allow: boolean) {\n    this.allowMaskClose = allow\n  }\n\n  getAllowMaskClose() {\n    return this.allowMaskClose\n  }\n\n  getEl() {\n    return this.$el\n  }\n\n  show() {\n    this.opts.onShow()\n    this.$el.style.display = ''\n  }\n\n  async hide() {\n    this.opts.onHide()\n    this.$el.style.display = 'none'\n    this.onAfterHide && this.onAfterHide()\n  }\n\n  async destroy() {\n    this.opts.onHide()\n    this.$el.remove()\n    this.onAfterHide && this.onAfterHide()\n  }\n}\n","import * as Utils from '@/lib/utils'\nimport { getScrollbarHelper } from './scrollbar-helper'\nimport { Layer } from './layer'\n\nexport class LayerWrap {\n  private $wrap: HTMLElement\n  private $mask: HTMLElement\n  private items: Layer[] = []\n\n  constructor() {\n    this.$wrap = Utils.createElement(\n      `<div class=\"atk-layer-wrap\" style=\"display: none;\"><div class=\"atk-layer-mask\"></div></div>`\n    )\n    this.$mask = this.$wrap.querySelector<HTMLElement>('.atk-layer-mask')!\n  }\n\n  createItem(name: string, el?: HTMLElement) {\n    // init element\n    el = el || this.createItemElement(name)\n    el.setAttribute('data-layer-name', name)\n    this.$wrap.appendChild(el)\n\n    // create layer instance\n    const layer = new Layer(el, {\n      onHide: () => this.hideWrap(el!),\n      onShow: () => this.showWrap()\n    })\n\n    // register mask click event\n    this.getMask().addEventListener('click', () => {\n      layer.getAllowMaskClose() && layer.hide()\n    })\n\n    // add to items\n    this.items.push(layer)\n\n    return layer\n  }\n\n  private createItemElement(name: string) {\n    const el = document.createElement('div')\n    el.classList.add('atk-layer-item')\n    el.style.display = 'none'\n    this.$wrap.appendChild(el)\n    return el\n  }\n\n  getWrap() {\n    return this.$wrap\n  }\n\n  getMask() {\n    return this.$mask\n  }\n\n  showWrap() {\n    this.$wrap.style.display = 'block'\n    this.$mask.style.display = 'block'\n    this.$mask.classList.add('atk-fade-in')\n    getScrollbarHelper().lock()\n  }\n\n  hideWrap($el: HTMLElement) {\n    // if wrap contains more than one item, do not hide entire wrap\n    if (this.items.map(l => l.getEl()).filter(e => e !== $el && e.isConnected && e.style.display !== 'none').length > 0) {\n      return\n    }\n\n    const onHide = () => {\n      this.$wrap.style.display = 'none'\n      this.$wrap.classList.remove('atk-fade-out')\n\n      getScrollbarHelper().unlock()\n\n      this.$wrap.onanimationend = null\n    }\n\n    // perform animation\n    this.$wrap.classList.add('atk-fade-out')\n    if (window.getComputedStyle(this.$wrap)['animation-name'] !== 'none') {\n      this.$wrap.onanimationend = () => onHide()\n    } else {\n      onHide()\n    }\n  }\n}\n","import type { ContextApi } from '@/types'\nimport { getScrollbarHelper } from './scrollbar-helper'\nimport { LayerWrap } from './wrap'\n\nexport class LayerManager {\n  private wrap: LayerWrap\n\n  constructor(ctx: ContextApi) {\n    this.wrap = new LayerWrap()\n    document.body.appendChild(this.wrap.getWrap())\n\n    ctx.on('unmounted', () => {\n      this.wrap.getWrap().remove()\n    })\n\n    // 记录页面原始 CSS 属性\n    getScrollbarHelper().init()\n  }\n\n  getEl() {\n    return this.wrap.getWrap()\n  }\n\n  create(name: string, el?: HTMLElement) {\n    return this.wrap.createItem(name, el)\n  }\n}\n","import type { LocalUser } from '@/types'\n\nconst LOCAL_USER_KEY = 'ArtalkUser'\n\ninterface UserOpts {\n  onUserChanged?: (user: LocalUser) => void\n}\n\nclass User {\n  private data: LocalUser\n\n  constructor(\n    private opts: UserOpts\n  ) {\n    // Import from localStorage\n    const localUser = JSON.parse(window.localStorage.getItem(LOCAL_USER_KEY) || '{}')\n\n    // Initialize\n    this.data = {\n      nick: localUser.nick || '',\n      email: localUser.email || '',\n      link: localUser.link || '',\n      token: localUser.token || '',\n      isAdmin: localUser.isAdmin || false\n    }\n  }\n\n  getData() {\n    return this.data\n  }\n\n  /** Update user data and save to localStorage */\n  update(obj: Partial<LocalUser> = {}) {\n    Object.entries(obj).forEach(([key, value]) => {\n      this.data[key] = value\n    })\n\n    window.localStorage.setItem(LOCAL_USER_KEY, JSON.stringify(this.data))\n    this.opts.onUserChanged && this.opts.onUserChanged(this.data)\n  }\n\n  /**\n   * Logout\n   *\n   * @description Logout will clear login status, but not clear user data (nick, email, link)\n   */\n  logout() {\n    this.update({\n      token: '',\n      isAdmin: false\n    })\n  }\n\n  /** Check if user has filled basic data */\n  checkHasBasicUserInfo() {\n    return !!this.data.nick && !!this.data.email\n  }\n}\n\nexport default User\n","import type { ContextApi } from '@/types'\nimport CheckerLauncher from './components/checker'\nimport Editor from './editor/editor'\nimport SidebarLayer from './layer/sidebar-layer'\n\nimport List from './list/list'\n\nimport * as I18n from './i18n'\nimport { PlugManager } from './plugins/editor-kit'\nimport { LayerManager } from './layer/layer-manager'\nimport User from './lib/user'\n\n/**\n * Services\n *\n * @description Call these services by `ctx.get('serviceName')` or `ctx.serviceName`\n */\nconst services = {\n  // I18n\n  i18n(ctx: ContextApi) {\n    I18n.setLocale(ctx.conf.locale)\n\n    ctx.watchConf(['locale'], (conf) => {\n      I18n.setLocale(conf.locale)\n    })\n  },\n\n  // User Store\n  user(ctx: ContextApi) {\n    const user = new User({\n      onUserChanged: (data) => {\n        ctx.trigger('user-changed', data)\n      }\n    })\n    return user\n  },\n\n  // 弹出层\n  layerManager(ctx: ContextApi) {\n    return new LayerManager(ctx)\n  },\n\n  // CheckerLauncher\n  checkerLauncher(ctx: ContextApi) {\n    const checkerLauncher = new CheckerLauncher({\n      getCtx: () => ctx,\n      getApi: () => ctx.getApi(),\n      onReload: () => ctx.reload(),\n\n      // make sure suffix with a slash, because it will be used as a base url when call `fetch`\n      getCaptchaIframeURL: () => `${ctx.conf.server}/api/v2/captcha/?t=${+new Date()}`\n    })\n    return checkerLauncher\n  },\n\n  // 编辑器\n  editor(ctx: ContextApi) {\n    const editor = new Editor(ctx)\n    ctx.$root.appendChild(editor.$el)\n    return editor\n  },\n\n  // 评论列表\n  list(ctx: ContextApi): List {\n    const list = new List(ctx)\n    ctx.$root.appendChild(list.$el)\n    return list\n  },\n\n  // 侧边栏 Layer\n  sidebarLayer(ctx: ContextApi) {\n    const sidebarLayer = new SidebarLayer(ctx)\n    return sidebarLayer\n  },\n\n  // Extra Service\n  // -----------------------------------------\n  // Only for type check\n  // Not inject to ctx immediately,\n  // but can be injected by other occasions\n\n  editorPlugs(): PlugManager|undefined {\n    return undefined\n  }\n}\n\nexport default services\n\n// type tricks for dependency injection\ntype TServiceImps = typeof services\ntype TObjectWithFuncs = {[k: string]: (...args: any) => any}\ntype TKeysOnlyReturn<T extends TObjectWithFuncs, V> = {[K in keyof T]: ReturnType<T[K]> extends V ? K : never}[keyof T]\ntype TOmitConditions = TKeysOnlyReturn<TServiceImps, void>\ntype TServiceInjectors = Omit<TServiceImps, TOmitConditions>\nexport type TInjectedServices = {[K in keyof TServiceInjectors]: ReturnType<TServiceInjectors[K]>}\n","import * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\n\nexport interface ErrorDialogOptions {\n  $err: HTMLElement\n\n  errMsg: string\n  errData?: any\n  retryFn?: () => void\n\n  onOpenSidebar?: () => void\n}\n\nexport function showErrorDialog(opts: ErrorDialogOptions) {\n  const errEl = Utils.createElement(`<span><span class=\"error-message\"></span><br/><br/></span>`)\n  errEl.querySelector<HTMLElement>('.error-message')!.innerText = `${$t('listLoadFailMsg')}\\n${opts.errMsg}`\n\n  if (opts.retryFn) {\n    const $retryBtn = Utils.createElement(`<span style=\"cursor:pointer;\">${$t('listRetry')}</span>`)\n    $retryBtn.onclick = () => opts.retryFn && opts.retryFn()\n    errEl.appendChild($retryBtn)\n  }\n\n  if (opts.onOpenSidebar) {\n    const $openSidebar = Utils.createElement(`<span atk-only-admin-show> | <span style=\"cursor:pointer;\">${$t('openName', { name: $t('ctrlCenter') })}</span></span>`)\n    errEl.appendChild($openSidebar)\n    $openSidebar.onclick = () => opts.onOpenSidebar && opts.onOpenSidebar()\n  }\n\n  Ui.setError(opts.$err, errEl)\n}\n","import type { ArtalkConfig, ArtalkPlugin, ContextApi } from '@/types'\nimport { handleConfFormServer } from '@/config'\nimport { showErrorDialog } from '../components/error-dialog'\n\nexport const ConfRemoter: ArtalkPlugin = (ctx) => {\n  ctx.on('created', () => {\n    if (ctx.conf.immediateFetch !== false)\n      ctx.trigger('conf-fetch')\n  })\n\n  ctx.on('conf-fetch', () => {\n    loadConf(ctx)\n  })\n}\n\nfunction loadConf(ctx: ContextApi) {\n  ctx.getApi().conf.conf().then((res) => {\n    let conf: Partial<ArtalkConfig> = {\n      apiVersion: res.data.version?.version, // version info\n    }\n\n    // reference conf from backend\n    if (ctx.conf.useBackendConf) {\n      if (!res.data.frontend_conf) throw new Error('The remote backend does not respond to the frontend conf, but `useBackendConf` conf is enabled')\n      conf = { ...conf, ...handleConfFormServer(res.data.frontend_conf) }\n    }\n\n    // apply conf modifier\n    ctx.conf.remoteConfModifier && ctx.conf.remoteConfModifier(conf)\n\n    ctx.updateConf(conf)\n  }).catch((err) => {\n    ctx.updateConf({})\n\n    let sidebarOpenView = ''\n\n    // if response err_no_site, modify the sidebar open view to create site\n    if (err.data?.err_no_site) {\n      const viewLoadParam = { create_name: ctx.conf.site, create_urls: `${window.location.protocol}//${window.location.host}` }\n      sidebarOpenView = `sites|${JSON.stringify(viewLoadParam)}`\n    }\n\n    showErrorDialog({\n      $err: ctx.get('list').$el,\n      errMsg: err.msg || String(err),\n      errData: err.data,\n      retryFn: () => loadConf(ctx),\n      onOpenSidebar: ctx.get('user').getData().isAdmin ? () => ctx.showSidebar({\n        view: sidebarOpenView as any\n      }) : undefined // only show open sidebar button when user is admin\n    })\n\n    console.error(err)\n    throw err\n  }).then(() => {\n    // Trigger mounted event\n    ctx.trigger('mounted')\n  }).then(() => {\n    // 评论获取\n    if (ctx.conf.remoteConfModifier) return // only auto fetch when no remoteConfModifier\n    ctx.fetch({ offset: 0 })\n  }).catch(() => {})\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as marked from '@/lib/marked'\n\nexport const Markdown: ArtalkPlugin = (ctx) => {\n  marked.initMarked()\n\n  ctx.on('updated', (conf) => {\n    if (conf.markedReplacers) marked.setReplacers(conf.markedReplacers)\n  })\n}\n","import $t from '@/i18n'\nimport type PlugKit from './_kit'\nimport EditorPlug from './_plug'\n\nconst LocalStorageKey = 'ArtalkContent'\n\nexport default class LocalStorage extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onContentUpdated = () => {\n      this.save()\n    }\n\n    this.kit.useMounted(() => {\n      // load editor content from localStorage when init\n      const localContent = window.localStorage.getItem(LocalStorageKey) || ''\n      if (localContent.trim() !== '') {\n        this.kit.useEditor().showNotify($t('restoredMsg'), 'i')\n        this.kit.useEditor().setContent(localContent)\n      }\n\n      // bind event\n      this.kit.useEvents().on('content-updated', onContentUpdated)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('content-updated', onContentUpdated)\n    })\n  }\n\n  // Save editor content to localStorage\n  public save() {\n    window.localStorage.setItem(LocalStorageKey, this.kit.useEditor().getContentRaw().trim())\n  }\n}\n","import type { CommentData } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport type PlugKit from './_kit'\n\nexport default class SubmitAddPreset {\n  constructor(private kit: PlugKit) {}\n\n  async reqAdd() {\n    const nComment = (await this.kit.useApi().comments.createComment({\n      ...(await this.getSubmitAddParams())\n    })).data\n    return nComment\n  }\n\n  async getSubmitAddParams() {\n    const { nick, email, link } = this.kit.useUser().getData()\n    const conf = this.kit.useConf()\n\n    return {\n      content: this.kit.useEditor().getContentFinal(),\n      name: nick, email, link,\n      rid: 0,\n      page_key: conf.pageKey,\n      page_title: conf.pageTitle,\n      site_name: conf.site,\n      ua: await Utils.getCorrectUserAgent(), // Get the corrected UA\n    }\n  }\n\n  postSubmitAdd(commentNew: CommentData) {\n    // insert the new comment to list\n    this.kit.useGlobalCtx().getData().insertComment(commentNew)\n  }\n}\n","import type { CommentData } from '@/types'\nimport $t from '@/i18n'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport SubmitAddPreset from './submit-add'\n\ninterface CustomSubmit {\n  activeCond: () => void\n  pre?: () => void\n  req?: () => Promise<CommentData>\n  /** The `post` method is called after the comment is successfully submitted */\n  post?: (nComment: CommentData) => void\n}\n\nexport default class Submit extends EditorPlug {\n  private customs: CustomSubmit[] = []\n  private defaultPreset: SubmitAddPreset\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.defaultPreset = new SubmitAddPreset(this.kit)\n\n    const onEditorSubmit = () => this.do()\n\n    this.kit.useMounted(() => {\n      // invoke `do()` when event `editor-submit` is triggered\n      this.kit.useGlobalCtx().on('editor-submit', onEditorSubmit)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useGlobalCtx().off('editor-submit', onEditorSubmit)\n    })\n  }\n\n  registerCustom(c: CustomSubmit) {\n    this.customs.push(c)\n  }\n\n  private async do() {\n    if (this.kit.useEditor().getContentFinal().trim() === '') {\n      this.kit.useEditor().focus()\n      return\n    }\n\n    const custom = this.customs.find(o => o.activeCond())\n\n    this.kit.useEditor().showLoading()\n\n    try {\n      // pre submit\n      if (custom?.pre) custom.pre()\n\n      let nComment: CommentData\n\n      // submit request\n      if (custom?.req) nComment = await custom.req()\n      else nComment = await this.defaultPreset.reqAdd()\n\n      // post submit\n      if (custom?.post) custom.post(nComment)\n      else this.defaultPreset.postSubmitAdd(nComment)\n    } catch (err: any) {\n      // submit error\n      console.error(err)\n      this.kit.useEditor().showNotify(`${$t('commentFail')}: ${err.msg || String(err)}`, 'e')\n      return\n    } finally {\n      this.kit.useEditor().hideLoading()\n    }\n\n    this.kit.useEditor().reset() // 复原编辑器\n    this.kit.useGlobalCtx().trigger('editor-submitted')\n  }\n}\n","import './emoticons.scss'\n\nimport type { EmoticonListData, EmoticonGrpData } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\ntype OwOFormatType = {\n  [key: string] : {\n    type: 'emoticon'|'emoji'|'image',\n    container: {icon: string, text: string}[]\n  }\n}\n\nexport default class Emoticons extends EditorPlug {\n  private emoticons: EmoticonListData = []\n  private loadingTask: Promise<void>|null = null\n\n  private $grpWrap!: HTMLElement\n  private $grpSwitcher!: HTMLElement\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => {\n      this.usePanel(`<div class=\"atk-editor-plug-emoticons\"></div>`)\n      this.useBtn(`<i aria-label=\"${$t('emoticon')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m4.26829 5.29294c0-.94317.45893-1.7074 1.02439-1.7074.56547 0 1.02439.76423 1.02439 1.7074s-.45892 1.7074-1.02439 1.7074c-.56546 0-1.02439-.76423-1.02439-1.7074zm4.43903 1.7074c.56546 0 1.02439-.76423 1.02439-1.7074s-.45893-1.7074-1.02439-1.7074c-.56547 0-1.02439.76423-1.02439 1.7074s.45892 1.7074 1.02439 1.7074zm-1.70732 2.73184c-1.51883 0-2.06312-1.52095-2.08361-1.58173l-1.29551.43231c.03414.10244.868 2.51604 3.3798 2.51604 2.51181 0 3.34502-2.41291 3.37982-2.51604l-1.29484-.43573c-.02254.06488-.56683 1.58583-2.08498 1.58583zm7-2.73252c0 3.86004-3.1401 7.00034-7 7.00034s-7-3.1396-7-6.99966c0-3.86009 3.1401-7.00034 7-7.00034s7 3.14025 7 7.00034zm-1.3659 0c0-3.10679-2.5275-5.63442-5.6341-5.63442-3.10663 0-5.63415 2.52832-5.63415 5.6351 0 3.10676 2.52752 5.63446 5.63415 5.63446 3.1066 0 5.6341-2.5277 5.6341-5.63446z\"/></svg></i>`)\n    })\n    this.kit.useUnmounted(() => {})\n\n    this.useContentTransformer((raw) => this.transEmoticonImageText(raw))\n    this.usePanelShow(() => {\n      ;(async () => {\n        await this.loadEmoticonsData()\n\n        // 初始化元素\n        if (!this.isImgLoaded) {\n          this.initEmoticonsList()\n          this.isImgLoaded = true\n        }\n\n        // 延迟执行，防止无法读取高度\n        setTimeout(() => {\n          this.changeListHeight()\n        }, 30)\n      })()\n    })\n    this.usePanelHide(() => {\n      this.$panel!.parentElement!.style.height = ''\n    })\n\n    // 表情包预加载\n    window.setTimeout(() => {\n      this.loadEmoticonsData()\n    }, 1000) // 延迟 1s 加载\n  }\n\n  private isListLoaded = false\n  private isImgLoaded = false\n\n  public async loadEmoticonsData() {\n    if (this.isListLoaded) return\n    if (this.loadingTask !== null) {\n      await this.loadingTask\n      return\n    }\n\n    // 数据处理\n    this.loadingTask = (async () => {\n      Ui.showLoading(this.$panel!)\n      this.emoticons = await this.handleData(this.kit.useConf().emoticons)\n      Ui.hideLoading(this.$panel!)\n      this.loadingTask = null\n      this.isListLoaded = true\n    })()\n    await this.loadingTask\n  }\n\n  private async handleData(data: any): Promise<any[]> {\n    if (!Array.isArray(data) && ['object', 'string'].includes(typeof data)) {\n      data = [data]\n    }\n\n    if (!Array.isArray(data)) {\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] Data must be of Array/Object/String type`)\n      Ui.hideLoading(this.$panel!)\n      return []\n    }\n\n    const pushGrp = (grp: EmoticonGrpData) => {\n      if (typeof grp !== 'object') return\n      if (grp.name && data.find(o => o.name === grp.name)) return\n      data.push(grp)\n    }\n\n    // 加载子内容\n    const remoteLoad = async (d: any[]) => {\n      await Promise.all(d.map(async (grp, index) => {\n        if (typeof grp === 'object' && !Array.isArray(grp)) {\n          pushGrp(grp)\n        } else if (Array.isArray(grp)) {\n          await remoteLoad(grp)\n        } else if (typeof grp === \"string\") {\n          const grpData = await this.remoteLoad(grp)\n\n          if (Array.isArray(grpData)) await remoteLoad(grpData)\n          else if (typeof grpData === 'object') pushGrp(grpData)\n        }\n      }))\n    }\n    await remoteLoad(data)\n\n    // 处理数组数据\n    data.forEach((item: any) => {\n      if (this.isOwOFormat(item)) {\n        const c = this.convertOwO(item)\n        c.forEach((grp) => { pushGrp(grp) })\n      } else if (Array.isArray(item)) {\n        item.forEach((grp) => { pushGrp(grp) })\n      }\n    })\n\n    // 剔除非法数据\n    data = data.filter((item: any) => (typeof item === 'object' && !Array.isArray(item) && !!item && !!item.name))\n\n    // console.log(data)\n\n    this.solveNullKey(data)\n    this.solveSameKey(data)\n\n    return data\n  }\n\n  /** 远程加载 */\n  private async remoteLoad(url: string): Promise<any> {\n    if (!url) return []\n\n    try {\n      const resp = await fetch(url)\n      const json = await resp.json()\n      return json\n    } catch (err) {\n      Ui.hideLoading(this.$panel!)\n      console.error('[Emoticons] Load Failed:', err)\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] ${$t('loadFail')}: ${String(err)}`)\n      return []\n    }\n  }\n\n  /** 避免表情 item.key 为 null 的情况 */\n  private solveNullKey(data: EmoticonGrpData[]) {\n    data.forEach((grp) => {\n      grp.items.forEach((item, index) => {\n        if (!item.key) item.key = `${grp.name} ${index+1}`\n      })\n    })\n  }\n\n  /** 避免相同 item.key */\n  private solveSameKey(data: EmoticonGrpData[]) {\n    const tmp: {[key: string]: number} = {}\n    data.forEach((grp) => {\n      grp.items.forEach(item => {\n        if (!item.key || String(item.key).trim() === \"\") return\n        if (!tmp[item.key]) tmp[item.key] = 1\n        else tmp[item.key]++\n\n        if (tmp[item.key] > 1) item.key = `${item.key} ${tmp[item.key]}`\n      })\n    })\n  }\n\n  /** 判断是否为 OwO 格式 */\n  private isOwOFormat(data: any) {\n    try {\n      return (typeof data === 'object') && !!Object.values(data).length\n        && Array.isArray(Object.keys(Object.values<any>(data)[0].container))\n        && Object.keys(Object.values<any>(data)[0].container[0]).includes('icon')\n    } catch { return false }\n  }\n\n  /** 转换 OwO 格式数据 */\n  private convertOwO(owoData: OwOFormatType): EmoticonListData {\n    const dest: EmoticonListData = []\n    Object.entries(owoData).forEach(([grpName, grp]) => {\n      const nGrp: EmoticonGrpData = { name: grpName, type: grp.type, items: [] }\n      grp.container.forEach((item, index) => {\n        // 图片标签提取 src 属性值\n        const iconStr = item.icon\n        if (/<(img|IMG)/.test(iconStr)) {\n          const find = /src=[\"'](.*?)[\"']/.exec(iconStr)\n          if (find && find.length > 1) item.icon = find[1]\n        }\n        nGrp.items.push({ key: item.text || `${grpName} ${index+1}`, val: item.icon })\n      })\n      dest.push(nGrp)\n    })\n    return dest\n  }\n\n  /** 初始化表情列表界面 */\n  private initEmoticonsList() {\n    // 表情列表\n    this.$grpWrap = Utils.createElement(`<div class=\"atk-grp-wrap\"></div>`)\n    this.$panel!.append(this.$grpWrap)\n\n    this.emoticons.forEach((grp, index) => {\n      const $grp = Utils.createElement(`<div class=\"atk-grp\" style=\"display: none;\"></div>`)\n      this.$grpWrap.append($grp)\n      $grp.setAttribute('data-index', String(index))\n      $grp.setAttribute('data-grp-name', grp.name)\n      $grp.setAttribute('data-type', grp.type)\n      grp.items.forEach((item) => {\n        const $item = Utils.createElement(`<span class=\"atk-item\"></span>`)\n        $grp.append($item)\n\n        if (!!item.key && !(new RegExp(`^(${grp.name})?\\\\s?[0-9]+$`).test(item.key)))\n          $item.setAttribute('title', item.key)\n\n        if (grp.type === 'image') {\n          const imgEl = document.createElement('img')\n          imgEl.src = item.val\n          imgEl.alt = item.key\n          $item.append(imgEl)\n        } else {\n          $item.innerText = item.val\n        }\n\n        $item.onclick = () => {\n          if (grp.type === 'image') {\n            this.kit.useEditor().insertContent(`:[${item.key}]`)\n          } else {\n            this.kit.useEditor().insertContent(item.val || '')\n          }\n        }\n      })\n    })\n\n    // 表情分类切换 bar\n    if (this.emoticons.length > 1) {\n      this.$grpSwitcher = Utils.createElement(`<div class=\"atk-grp-switcher\"></div>`)\n      this.$panel!.append(this.$grpSwitcher)\n      this.emoticons.forEach((grp, index) => {\n        const $item = Utils.createElement('<span />')\n        $item.innerText = grp.name\n        $item.setAttribute('data-index', String(index))\n        $item.onclick = () => (this.openGrp(index))\n        this.$grpSwitcher.append($item)\n      })\n    }\n\n    // 默认打开第一个分类\n    if (this.emoticons.length > 0) this.openGrp(0)\n  }\n\n  /** 打开一个表情组 */\n  public openGrp(index: number) {\n    Array.from(this.$grpWrap.children).forEach((item) => {\n      const el = item as HTMLElement\n      if (el.getAttribute('data-index') !== String(index)) {\n        el.style.display = 'none'\n      } else {\n        el.style.display = ''\n      }\n    })\n\n    this.$grpSwitcher?.querySelectorAll('span.active').forEach(item => item.classList.remove('active'))\n    this.$grpSwitcher?.querySelector(`span[data-index=\"${index}\"]`)?.classList.add('active')\n\n    this.changeListHeight()\n  }\n\n  private changeListHeight() {\n    /* const listWrapHeight = Utils.getHeight(this.$grpWrapem)\n    this.editor.plugWrapEl.style.height = `${listWrapHeight > 150 ? listWrapHeight : 150}px` */\n  }\n\n  /** 处理评论 content 中的表情内容 */\n  public transEmoticonImageText(text: string) {\n    if (!this.emoticons || !Array.isArray(this.emoticons))\n      return text\n\n    this.emoticons.forEach((grp) => {\n      if (grp.type !== 'image') return\n      Object.entries(grp.items).forEach(([index, item]) => {\n        text = text.split(`:[${item.key}]`).join(`<img src=\"${item.val}\" atk-emoticon=\"${item.key}\">`) // replaceAll(...)\n      })\n    })\n\n    return text\n  }\n}\n","import * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\nimport type PlugKit from './_kit'\nimport EditorPlug from './_plug'\n\n/** 允许的图片格式 */\nconst AllowImgExts = ['png', 'jpg', 'jpeg', 'gif', 'bmp', 'svg', 'webp']\n\nexport default class Upload extends EditorPlug {\n  private $imgUploadInput?: HTMLInputElement\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => this.init())\n\n    this.initDragImg()\n  }\n\n  private init() {\n    this.$imgUploadInput = document.createElement('input')\n    this.$imgUploadInput.type = 'file'\n    this.$imgUploadInput.style.display = 'none'\n    this.$imgUploadInput.accept = AllowImgExts.map(o => `.${o}`).join(',')\n\n    // TODO: Use btn cannot refresh when mounted event is triggered\n    const $btn = this.useBtn(`<i aria-label=\"${$t('uploadImage')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m0 1.94444c0-1.074107.870333-1.94444 1.94444-1.94444h10.11116c1.0741 0 1.9444.870333 1.9444 1.94444v10.11116c0 1.0741-.8703 1.9444-1.9444 1.9444h-10.11116c-1.074107 0-1.94444-.8703-1.94444-1.9444zm1.94444-.38888c-.21466 0-.38888.17422-.38888.38888v7.06689l2.33333-2.33333 2.33333 2.33333 3.88888-3.88889 2.3333 2.33334v-5.51134c0-.21466-.1742-.38888-.3888-.38888zm10.49996 8.09977-2.3333-2.33333-3.88888 3.8889-2.33333-2.33334-2.33333 2.33334v.8447c0 .2146.17422.3888.38888.3888h10.11116c.2146 0 .3888-.1742.3888-.3888zm-7.1944-6.54422c-.75133 0-1.36111.60978-1.36111 1.36111 0 .75134.60978 1.36111 1.36111 1.36111s1.36111-.60977 1.36111-1.36111c0-.75133-.60978-1.36111-1.36111-1.36111z\"/></svg></i>`)\n    $btn.after(this.$imgUploadInput)\n    $btn.onclick = () => {\n      // 选择图片\n      const $input = this.$imgUploadInput!\n      $input.onchange = () => {\n        (async () => { // 解决阻塞 UI 问题\n          if (!$input.files || $input.files.length === 0) return\n          const file = $input.files[0]\n          this.uploadImg(file)\n        })()\n      }\n      $input.click() // 显示选择图片对话框\n    }\n\n    if (!this.kit.useConf().imgUpload) {\n      this.$btn!.setAttribute('atk-only-admin-show', '')\n    }\n  }\n\n  private initDragImg() {\n    // 统一从 FileList 获取文件并上传图片方法\n    const uploadFromFileList = (files?: FileList) => {\n      if (!files) return\n\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i]\n        this.uploadImg(file)\n      }\n    }\n\n    // 拖拽图片\n    // @link https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/File_drag_and_drop\n    // 阻止浏览器的默认释放行为\n    const onDragover = (evt: Event) => {\n      evt.stopPropagation()\n      evt.preventDefault()\n    }\n\n    const onDrop = (evt: DragEvent) => {\n      const files = evt.dataTransfer?.files\n      if (files?.length) {\n        evt.preventDefault()\n        uploadFromFileList(files)\n      }\n    }\n\n    // 粘贴图片\n    const onPaste = (evt: ClipboardEvent) => {\n      const files = evt.clipboardData?.files\n      if (files?.length) {\n        evt.preventDefault()\n        uploadFromFileList(files)\n      }\n    }\n\n    this.kit.useMounted(() => {\n      this.kit.useUI().$textarea.addEventListener('dragover', onDragover)\n      this.kit.useUI().$textarea.addEventListener('drop', onDrop)\n      this.kit.useUI().$textarea.addEventListener('paste', onPaste)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useUI().$textarea.removeEventListener('dragover', onDragover)\n      this.kit.useUI().$textarea.removeEventListener('drop', onDrop)\n      this.kit.useUI().$textarea.removeEventListener('paste', onPaste)\n    })\n  }\n\n  async uploadImg(file: File) {\n    const fileExt = /[^.]+$/.exec(file.name)\n    if (!fileExt || !AllowImgExts.includes(fileExt[0])) return\n\n    // 未登录提示\n    if (!this.kit.useUser().checkHasBasicUserInfo()) {\n      this.kit.useEditor().showNotify($t('uploadLoginMsg'), 'w')\n      return\n    }\n\n    // 插入图片前换一行\n    let insertPrefix = '\\n'\n    if (this.kit.useUI().$textarea.value.trim() === '') insertPrefix = ''\n\n    // 插入占位加载文字\n    const uploadPlaceholderTxt = `${insertPrefix}![](Uploading ${file.name}...)`\n    this.kit.useEditor().insertContent(uploadPlaceholderTxt)\n\n    // 上传图片\n    let resp: { public_url: string } | undefined\n    try {\n      const customUploaderFn = this.kit.useConf().imgUploader\n      if (!customUploaderFn) {\n        // 使用 Artalk 进行图片上传\n        resp = (await this.kit.useApi().upload.upload({ file })).data\n      } else {\n        // 使用自定义的图片上传器\n        resp = { public_url: await customUploaderFn(file) }\n      }\n    } catch (err: any) {\n      console.error(err)\n      this.kit.useEditor().showNotify(`${$t('uploadFail')}: ${err.msg}`, 'e')\n    }\n    if (!!resp && resp.public_url) {\n      let imgURL = resp.public_url as string\n\n      // 若为相对路径，加上 artalk server\n      if (!Utils.isValidURL(imgURL)) imgURL = Utils.getURLBasedOnApi({\n        base: this.kit.useConf().server,\n        path: imgURL,\n      })\n\n      // 上传成功插入图片\n      this.kit.useEditor().setContent(this.kit.useUI().$textarea.value.replace(uploadPlaceholderTxt, `${insertPrefix}![](${imgURL})`))\n    } else {\n      // 上传失败删除加载文字\n      this.kit.useEditor().setContent(this.kit.useUI().$textarea.value.replace(uploadPlaceholderTxt, ''))\n    }\n  }\n}\n","import './preview.scss'\n\nimport * as marked from '@/lib/marked'\nimport $t from '@/i18n'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class Preview extends EditorPlug {\n  private isPlugPanelShow = false\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    this.kit.useMounted(() => {\n      this.usePanel(`<div class=\"atk-editor-plug-preview\"></div>`)\n\n      // initialize plug button\n      this.useBtn(`<i aria-label=\"${$t('preview')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z\"></path></svg></i>`)\n    })\n    this.kit.useUnmounted(() => {})\n\n    // function to update content\n    this.kit.useEvents().on('content-updated', (content) => {\n      this.isPlugPanelShow && this.updateContent()\n    })\n\n    this.usePanelShow(() => {\n      this.isPlugPanelShow = true\n      this.updateContent()\n    })\n    this.usePanelHide(() => {\n      this.isPlugPanelShow = false\n    })\n  }\n\n  updateContent() {\n    this.$panel!.innerHTML = this.kit.useEditor().getContentMarked()\n  }\n}\n","import type { ArtalkConfig } from '@/types'\nimport type EditorPlug from './_plug'\nimport LocalStorage from './local-storage'\nimport Textarea from './textarea'\nimport SubmitBtn from './submit-btn'\nimport Submit from './submit'\nimport StateReply from './state-reply'\nimport StateEdit from './state-edit'\nimport Closable from './closable'\nimport HeaderEvent from './header-event'\nimport HeaderUser from './header-user'\nimport HeaderLink from './header-link'\nimport Mover from './mover'\nimport Emoticons from './emoticons'\nimport Upload from './upload'\nimport Preview from './preview'\n\n/** The default enabled plugs */\nconst EDITOR_PLUGS: (typeof EditorPlug)[] = [\n  // Core\n  LocalStorage,\n  HeaderEvent, HeaderUser, HeaderLink,\n  Textarea,\n  Submit, SubmitBtn,\n  Mover, StateReply, StateEdit,\n  Closable,\n\n  // Extensions\n  Emoticons, Upload, Preview\n]\n\n/**\n * Get the enabled plugs by config\n */\nexport function getEnabledPlugs(conf: Pick<ArtalkConfig, 'imgUpload'|'emoticons'|'preview'|'editorTravel'>): (typeof EditorPlug)[] {\n  // The reference map of config and plugs\n  // (for check if the plug is enabled)\n  const confRefs = new Map<typeof EditorPlug, any>()\n  confRefs.set(Upload, conf.imgUpload)\n  confRefs.set(Emoticons, conf.emoticons)\n  confRefs.set(Preview, conf.preview)\n  confRefs.set(Mover, conf.editorTravel)\n\n  return EDITOR_PLUGS.filter(p => !confRefs.has(p) || !!confRefs.get(p))\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class HeaderEvent extends EditorPlug {\n  private get $inputs() {\n    return this.kit.useEditor().getHeaderInputEls()\n  }\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const inputEventFns: {[name: string]: () => void} = {}\n    const changeEventFns: {[name: string]: () => void} = {}\n\n    const trigger = (evt: 'header-input'|'header-change', $input: HTMLInputElement, field: string) => () => {\n      this.kit.useEvents().trigger(evt, { field, $input })\n    }\n\n    this.kit.useMounted(() => {\n      // batch bind the events\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\n        $input.addEventListener('input', inputEventFns[key] = trigger('header-input', $input, key))\n        $input.addEventListener('change', changeEventFns[key] = trigger('header-change', $input, key))\n      })\n    })\n\n    this.kit.useUnmounted(() => {\n      // unmount the event\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\n        $input.removeEventListener('input', inputEventFns[key])\n        $input.removeEventListener('change', changeEventFns[key])\n      })\n    })\n  }\n}\n","import $t from '@/i18n'\nimport type { UserInfoApiResponseData } from '@/types'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class HeaderUser extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onInput = ({ $input, field }: { $input: HTMLInputElement, field: string }) => {\n      if (this.kit.useEditor().getState() === 'edit')\n        return // TODO: prevent execute when editing, since update comment.user not support\n\n      // update user data\n      this.kit.useUser().update({ [field]: $input.value.trim() })\n\n      // remote fetch user info\n      if (field === 'nick' || field === 'email')\n        this.fetchUserInfo() // must after update user data, since fetchUserInfo() will use User.data\n    }\n\n    this.kit.useMounted(() => {\n      Object.entries(this.kit.useEditor().getHeaderInputEls())\n        .forEach(([key, $input]) => {\n          // set placeholder\n          $input.placeholder = `${$t(key as any)}`\n\n          // sync header values from User.data\n          $input.value = this.kit.useUser().getData()[key] || ''\n        })\n\n      // bind events\n      this.kit.useEvents().on('header-input', onInput)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('header-input', onInput)\n    })\n  }\n\n  private query = {\n    timer: <number|null>null,\n    abortFn: <(() => void)|null>null\n  }\n\n  /**\n   * Fetch user info from server\n   */\n  private fetchUserInfo() {\n    this.kit.useUser().logout() // clear login status\n\n    if (this.query.timer) window.clearTimeout(this.query.timer) // clear the not executed timeout task\n    if (this.query.abortFn) this.query.abortFn() // abort the last request (if request is pending not finished)\n\n    this.query.timer = window.setTimeout(() => {\n      this.query.timer = null // clear the timer (clarify the timer is executing)\n\n      const api = this.kit.useApi()\n      const CANCEL_TOKEN = 'getUserCancelToken'\n      this.query.abortFn = () => api.abortRequest(CANCEL_TOKEN)\n\n      api.user.getUser({ ...api.getUserFields() }, {\n        cancelToken: CANCEL_TOKEN\n      }).then(res => this.onUserInfoFetched(res.data))\n        .catch((err) => {})\n        .finally(() => {\n          this.query.abortFn = null // clear the abort function (clarify the request is finished)\n        })\n    }, 400) // delay to reduce request\n  }\n\n  /**\n   * Function called when user info fetched\n   *\n   * @param data The response data from server\n   */\n  private onUserInfoFetched(\n    data: UserInfoApiResponseData\n  ) {\n    // If api response is not login, logout\n    if (!data.is_login) this.kit.useUser().logout()\n\n    // Update unread notifies\n    this.kit.useGlobalCtx().getData().updateNotifies(data.notifies)\n\n    // If user is admin and not login,\n    if (this.kit.useUser().checkHasBasicUserInfo() && !data.is_login && data.user?.is_admin) {\n      // then show login window\n      this.kit.useGlobalCtx().checkAdmin({\n        onSuccess: () => {}\n      })\n    }\n\n    // Auto fill user link from server\n    if (data.user && data.user.link) {\n      this.kit.useUI().$link.value = data.user.link\n      this.kit.useUser().update({ link: data.user.link })\n    }\n  }\n}\n","import EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class HeaderLink extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onLinkChange = ({ field }: { field: string }) => {\n      if (field === 'link') this.onLinkInputChange()\n    }\n\n    // bind events\n    this.kit.useMounted(() => {\n      this.kit.useEvents().on('header-change', onLinkChange)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('header-change', onLinkChange)\n    })\n  }\n\n  private onLinkInputChange() {\n    // auto and force add protocol prefix for user input link\n    const link = this.kit.useUI().$link.value.trim()\n    if (!!link && !/^(http|https):\\/\\//.test(link)) {\n      this.kit.useUI().$link.value = `https://${link}`\n      this.kit.useUser().update({ link: this.kit.useUI().$link.value })\n    }\n  }\n}\n","import $t from '@/i18n'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class Textarea extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onKeydown = (e: KeyboardEvent) => this.onKeydown(e)\n    const onInput = () => this.onInput()\n\n    this.kit.useMounted(() => {\n      // 占位符\n      this.kit.useUI().$textarea.placeholder = this.kit.useConf().placeholder || $t('placeholder')\n\n      // bind the event\n      this.kit.useUI().$textarea.addEventListener('keydown', onKeydown)\n      this.kit.useUI().$textarea.addEventListener('input', onInput)\n    })\n\n    this.kit.useUnmounted(() => {\n      // unmount the event\n      this.kit.useUI().$textarea.removeEventListener('keydown', onKeydown)\n      this.kit.useUI().$textarea.removeEventListener('input', onInput)\n    })\n\n    this.kit.useEvents().on('content-updated', () => {\n      // delay 80ms to prevent invalid execution\n      window.setTimeout(() => {\n        this.adaptiveHeightByContent()\n      }, 80)\n    })\n  }\n\n  // 按下 Tab 输入内容，而不是失去焦距\n  private onKeydown(e: KeyboardEvent) {\n    const keyCode = e.keyCode || e.which\n\n    if (keyCode === 9) {\n      e.preventDefault()\n      this.kit.useEditor().insertContent('\\t')\n    }\n  }\n\n  private onInput() {\n    this.kit.useEvents().trigger('content-updated', this.kit.useEditor().getContentRaw())\n  }\n\n  // Resize the textarea height by content\n  public adaptiveHeightByContent() {\n    const diff = this.kit.useUI().$textarea.offsetHeight - this.kit.useUI().$textarea.clientHeight\n    this.kit.useUI().$textarea.style.height = '0px' // it's a magic. 若不加此行，内容减少，高度回不去\n    this.kit.useUI().$textarea.style.height = `${this.kit.useUI().$textarea.scrollHeight + diff}px`\n  }\n}\n","import $t from '@/i18n'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class SubmitBtn extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onClick = () => {\n      this.kit.useEditor().submit()\n    }\n\n    this.kit.useMounted(() => {\n      // apply the submit button text from user custom config\n      this.kit.useUI().$submitBtn.innerText = this.kit.useConf().sendBtn || $t('send')\n\n      // bind the event when click the submit button\n      this.kit.useUI().$submitBtn.addEventListener('click', onClick)\n    })\n\n    this.kit.useUnmounted(() => {\n      this.kit.useUI().$submitBtn.removeEventListener('click', onClick)\n    })\n  }\n}\n","import type { CommentData } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport * as Ui from '@/lib/ui'\nimport $t from '@/i18n'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\nimport Submit from './submit'\nimport SubmitAddPreset from './submit-add'\n\nexport default class StateReply extends EditorPlug {\n  private comment?: CommentData\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    // add effect when state switch to `reply`\n    this.useEditorStateEffect('reply', (commentData) => {\n      this.setReply(commentData)\n\n      return () => {\n        this.cancelReply()\n      }\n    })\n\n    // register submit preset\n    this.kit.useEvents().on('mounted', () => {\n      const submitPlug = this.kit.useDeps(Submit)\n      if (!submitPlug) throw Error(\"SubmitPlug not initialized\")\n\n      const defaultPreset = new SubmitAddPreset(this.kit)\n\n      submitPlug.registerCustom({\n        activeCond: () => !!this.comment, // active this custom submit when reply mode\n        req: async () => {\n          if (!this.comment) throw new Error('reply comment cannot be empty')\n\n          const nComment = (await this.kit.useApi().comments.createComment({\n            ...(await defaultPreset.getSubmitAddParams()),\n            rid: this.comment.id,\n            page_key: this.comment.page_key,\n            page_title: undefined,\n            site_name: this.comment.site_name\n          })).data\n\n          return nComment\n        },\n        post: (nComment: CommentData) => {\n          // open another page when reply comment is not the same pageKey\n          const conf = this.kit.useConf()\n          if (nComment.page_key !== conf.pageKey) {\n            window.open(`${nComment.page_url}#atk-comment-${nComment.id}`)\n          }\n\n          defaultPreset.postSubmitAdd(nComment)\n        }\n      })\n    })\n  }\n\n  private setReply(commentData: CommentData) {\n    const ui = this.kit.useUI()\n    if (!ui.$sendReplyBtn) {\n      const $btn = Utils.createElement(\n        `<span class=\"atk-state-btn\">` +\n          `<span class=\"atk-text-wrap\">` +\n          `${$t('reply')} <span class=\"atk-text\"></span>` +\n          `</span>` +\n          `<span class=\"atk-cancel\">×</span>` +\n        `</span>`\n      )\n      $btn.querySelector<HTMLElement>('.atk-text')!.innerText = `@${commentData.nick}`\n      $btn.addEventListener('click', () => {\n        this.kit.useEditor().resetState()\n      })\n      ui.$stateWrap.append($btn)\n      ui.$sendReplyBtn = $btn\n    }\n\n    this.comment = commentData\n\n    ui.$textarea.focus()\n  }\n\n  private cancelReply() {\n    if (!this.comment) return\n\n    const ui = this.kit.useUI()\n    if (ui.$sendReplyBtn) {\n      ui.$sendReplyBtn.remove()\n      ui.$sendReplyBtn = undefined\n    }\n    this.comment = undefined\n  }\n}\n","import type { CommentData } from '@/types'\nimport $t from '@/i18n'\nimport * as Utils from '@/lib/utils'\nimport type PlugKit from './_kit'\nimport EditorPlug from './_plug'\nimport Submit from './submit'\n\nexport default class StateEdit extends EditorPlug {\n  private comment?: CommentData\n\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    // add effect when state switch to `edit`\n    this.useEditorStateEffect('edit', (comment) => {\n      this.edit(comment)\n\n      return () => {\n        this.cancelEdit()\n      }\n    })\n\n    // register submit preset\n    this.kit.useMounted(() => {\n      const submitPlug = this.kit.useDeps(Submit)\n      if (!submitPlug) throw Error(\"SubmitPlug not initialized\")\n\n      submitPlug.registerCustom({\n        activeCond: () => !!this.comment, // active this custom submit when edit mode\n        req: async () => {\n          const saveData = {\n            content: this.kit.useEditor().getContentFinal(),\n            nick: this.kit.useUI().$nick.value,\n            email: this.kit.useUI().$email.value,\n            link: this.kit.useUI().$link.value,\n          }\n          const comment = this.comment!\n          const nComment = await this.kit.useApi().comments.updateComment(comment.id, {\n            ...comment, ...saveData\n          })\n          return nComment.data\n        },\n        post: (nComment: CommentData) => {\n          this.kit.useGlobalCtx().getData().updateComment(nComment)\n        }\n      })\n    })\n  }\n\n  private edit(comment: CommentData) {\n    const ui = this.kit.useUI()\n    if (!ui.$editCancelBtn) {\n      const $btn = Utils.createElement(\n        `<span class=\"atk-state-btn\">` +\n          `<span class=\"atk-text-wrap\">` +\n          `${$t('editCancel')}` +\n          `</span>` +\n          `<span class=\"atk-cancel\">×</span>` +\n        `</span>`\n      )\n      $btn.onclick = () => {\n        this.kit.useEditor().resetState()\n      }\n      ui.$stateWrap.append($btn)\n      ui.$editCancelBtn = $btn\n    }\n    this.comment = comment\n\n    ui.$header.style.display = 'none' // TODO: support modify header information\n\n    ui.$nick.value = comment.nick || ''\n    ui.$email.value = comment.email || ''\n    ui.$link.value = comment.link || ''\n\n    this.kit.useEditor().setContent(comment.content)\n    ui.$textarea.focus()\n\n    this.updateSubmitBtnText($t('save'))\n  }\n\n  private cancelEdit() {\n    if (!this.comment) return\n\n    const ui = this.kit.useUI()\n\n    if (ui.$editCancelBtn) {\n      ui.$editCancelBtn.remove()\n      ui.$editCancelBtn = undefined\n    }\n\n    this.comment = undefined\n\n    const { nick, email, link } = this.kit.useUser().getData()\n    ui.$nick.value = nick\n    ui.$email.value = email\n    ui.$link.value = link\n\n    this.kit.useEditor().setContent('')\n    this.restoreSubmitBtnText()\n\n    ui.$header.style.display = '' // TODO: support modify header information\n  }\n\n  // -------------------------------------------------------------------\n  //  Submit Btn Text Modifier\n  // -------------------------------------------------------------------\n\n  private originalSubmitBtnText = 'Send'\n\n  private updateSubmitBtnText(text: string) {\n    this.originalSubmitBtnText = this.kit.useUI().$submitBtn.innerText\n    this.kit.useUI().$submitBtn.innerText = text\n  }\n\n  private restoreSubmitBtnText() {\n    this.kit.useUI().$submitBtn.innerText = this.originalSubmitBtnText\n  }\n}\n","import * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\nimport EditorPlug from './_plug'\nimport type PlugKit from './_kit'\n\nexport default class Closable extends EditorPlug {\n  constructor(kit: PlugKit) {\n    super(kit)\n\n    const onOpen = () => this.open()\n    const onClose = () => this.close()\n\n    this.kit.useMounted(() => {\n      this.kit.useEvents().on('editor-open', onOpen)\n      this.kit.useEvents().on('editor-close', onClose)\n    })\n    this.kit.useUnmounted(() => {\n      this.kit.useEvents().off('editor-open', onOpen)\n      this.kit.useEvents().off('editor-close', onClose)\n    })\n  }\n\n  private open() {\n    this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed')?.remove()\n    this.kit.useUI().$textarea.style.display = ''\n    this.kit.useUI().$bottom.style.display = ''\n  }\n\n  private close() {\n    if (!this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed'))\n      this.kit.useUI().$textareaWrap.prepend(Utils.createElement(`<div class=\"atk-comment-closed\">${$t('onlyAdminCanReply')}</div>`))\n\n    if (!this.kit.useUser().getData().isAdmin) {\n      this.kit.useUI().$textarea.style.display = 'none'\n      this.kit.useEvents().trigger('panel-close')\n      this.kit.useUI().$bottom.style.display = 'none'\n    } else {\n      // 管理员一直打开评论\n      this.kit.useUI().$textarea.style.display = ''\n      this.kit.useUI().$bottom.style.display = ''\n    }\n  }\n}\n","import type { PlugManager } from '../editor-kit'\nimport type EditorPlug from \"./_plug\"\n\n/**\n * PlugKit provides a set of methods to help you develop editor plug\n */\nexport default class PlugKit {\n  constructor(\n    private plugs: PlugManager\n  ) {\n  }\n\n  /** Use the editor */\n  useEditor() {\n    return this.plugs.editor\n  }\n\n  /**\n   * Use the context of global\n   *\n   * @deprecated The calls to this function should be reduced as much as possible\n   */\n  useGlobalCtx() {\n    return this.plugs.editor.ctx\n  }\n\n  /** Use the config of Artalk */\n  useConf() {\n    return this.plugs.editor.ctx.conf\n  }\n\n  /** Use the http api client */\n  useApi() {\n    return this.plugs.editor.ctx.getApi()\n  }\n\n  /** Use the user manager */\n  useUser() {\n    return this.plugs.editor.ctx.get('user')\n  }\n\n  /** Use the ui of editor */\n  useUI() {\n    return this.plugs.editor.getUI()\n  }\n\n  /** Use the events in editor scope */\n  useEvents() {\n    return this.plugs.getEvents()\n  }\n\n  /** Listen the event when plug is mounted */\n  useMounted(func: () => void) {\n    this.useEvents().on('mounted', func)\n  }\n\n  /** Listen the event when plug is unmounted */\n  useUnmounted(func: () => void) {\n    this.useEvents().on('unmounted', func)\n  }\n\n  /** Use the deps of other plug */\n  useDeps<T extends typeof EditorPlug>(plug: T) {\n    return this.plugs.get(plug)\n  }\n}\n","import type { EditorApi, ArtalkPlugin } from '@/types'\nimport EventManager from '@/lib/event-manager'\nimport { getEnabledPlugs } from './editor'\nimport EditorPlug from './editor/_plug'\nimport PlugKit from './editor/_kit'\n\nexport interface EditorEventPayloadMap {\n  'mounted': undefined\n  'unmounted': undefined\n  'header-input': { field: string, $input: HTMLInputElement }\n  'header-change': { field: string, $input: HTMLInputElement }\n  'content-updated': string\n  'panel-show': EditorPlug\n  'panel-hide': EditorPlug\n  'panel-close': undefined\n\n  'editor-close': undefined\n  'editor-open': undefined\n}\n\nexport const EditorKit: ArtalkPlugin = (ctx) => {\n  const editor = ctx.get('editor')\n\n  const editorPlugs = new PlugManager(editor)\n  ctx.inject('editorPlugs', editorPlugs)\n}\n\nexport class PlugManager {\n  private plugs: EditorPlug[] = []\n  private openedPlug: EditorPlug|null = null\n  private events = new EventManager<EditorEventPayloadMap>()\n\n  getPlugs() { return this.plugs }\n  getEvents() { return this.events }\n\n  private clear() {\n    this.plugs = []\n    this.events = new EventManager()\n    if (this.openedPlug) this.closePlugPanel()\n  }\n\n  constructor(\n    public editor: EditorApi\n  ) {\n    let confLoaded = false // config not loaded at first time\n    this.editor.ctx.watchConf([\n      'imgUpload', 'emoticons', 'preview', 'editorTravel', 'locale'\n    ], (conf) => {\n      // trigger unmount event will call all plugs' unmount function\n      // (this will only be called while conf reloaded, not be called at first time)\n      confLoaded && this.getEvents().trigger('unmounted')\n\n      // reset the plugs\n      this.clear()\n\n      // init the all enabled plugs\n      getEnabledPlugs(conf)\n        .forEach((Plug) => {\n          // create the plug instance\n          const kit = new PlugKit(this)\n          this.plugs.push(new Plug(kit))\n        })\n\n      // trigger event for plug initialization\n      this.getEvents().trigger('mounted')\n      confLoaded = true\n\n      // refresh the plug UI\n      this.loadPluginUI()\n    })\n\n    this.events.on('panel-close', () => this.closePlugPanel())\n  }\n\n  private loadPluginUI() {\n    // handle ui, clear and reset the plug btns and plug panels\n    this.editor.getUI().$plugPanelWrap.innerHTML = ''\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\n    this.editor.getUI().$plugBtnWrap.innerHTML = ''\n    // 防止穿透\n    this.editor.getUI().$el.addEventListener('click', (e) => {\n      e.stopPropagation()\n    })\n\n    // load the plug UI\n    this.plugs.forEach((plug) => this.loadPluginItem(plug))\n  }\n\n  /** Load the plug btn and plug panel on editor ui */\n  private loadPluginItem(plug: EditorPlug) {\n    const $btn = plug.$btn\n    if (!$btn) return\n    this.editor.getUI().$plugBtnWrap.appendChild($btn)\n\n    // bind the event when click plug btn\n    !$btn.onclick && ($btn.onclick = () => {\n      // removing the active class from all the buttons\n      this.editor.getUI().$plugBtnWrap\n        .querySelectorAll('.active')\n        .forEach(item => item.classList.remove('active'))\n\n      // if the plug is not the same as the openedPlug,\n      if (plug !== this.openedPlug) {\n        // then open the plug current clicked plug panel\n        this.openPlugPanel(plug)\n\n        // add active class for current plug panel\n        $btn.classList.add('active')\n      } else {\n        // then close the plug\n        this.closePlugPanel()\n      }\n    })\n\n    // initialization of plug panel\n    const $panel = plug.$panel\n    if ($panel) {\n      $panel.style.display = 'none'\n      this.editor.getUI().$plugPanelWrap.appendChild($panel)\n    }\n  }\n\n  get<T extends typeof EditorPlug>(plug: T) {\n    return this.plugs.find(p => p instanceof plug) as InstanceType<T> | undefined;\n  }\n\n  /** Open the editor plug panel */\n  openPlugPanel(plug: EditorPlug) {\n    this.plugs.forEach((aPlug) => {\n      const plugPanel = aPlug.$panel\n      if (!plugPanel) return\n\n      if (aPlug === plug) {\n        plugPanel.style.display = ''\n        this.events.trigger('panel-show', plug)\n      } else {\n        plugPanel.style.display = 'none'\n        this.events.trigger('panel-hide', plug)\n      }\n    })\n\n    this.editor.getUI().$plugPanelWrap.style.display = ''\n    this.openedPlug = plug\n  }\n\n  /** Close the editor plug panel */\n  closePlugPanel() {\n    if (!this.openedPlug) return\n\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\n    this.events.trigger('panel-hide', this.openedPlug)\n    this.openedPlug = null\n  }\n\n  /** Get the content which is transformed by plugs */\n  getTransformedContent(rawContent: string) {\n    let result = rawContent\n    this.plugs.forEach((aPlug) => {\n      if (!aPlug.contentTransformer) return\n      result = aPlug.contentTransformer(result)\n    })\n    return result\n  }\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const GotoFocus: ArtalkPlugin = (ctx) => {\n  ctx.on('list-goto', async (commentID) => {\n    // find the comment node\n    let comment = ctx.getCommentNodes().find(c => c.getID() === commentID)\n    if (!comment) {\n      // fetch and insert the comment from the server\n      const data = (await ctx.getApi().comments.getComment(commentID)).data\n      ctx.get('list').getListLayout({ forceFlatMode: true }).insert(data.comment, data.reply_comment)\n      comment = ctx.getCommentNodes().find(c => c.getID() === commentID)\n    }\n    if (!comment) return\n    comment.focus()\n  })\n}\n\n","import type { ContextApi, ArtalkPlugin, ArtalkConfig } from '@/types'\nimport { Api } from '@/api'\n\nexport interface CountOptions {\n  getApi(): Api\n\n  siteName: string\n  pageKey?: string\n  pageTitle?: string\n  countEl: string\n  pvEl: string\n\n  /** 是否增加当前页面 PV 数 */\n  pvAdd?: boolean\n}\n\nexport const PvCountWidget: ArtalkPlugin = (ctx: ContextApi) => {\n  ctx.watchConf([\n    'site', 'pageKey', 'pageTitle', 'countEl', 'pvEl',\n  ], (conf) => {\n    initCountWidget({\n      getApi: () => ctx.getApi(),\n      siteName: conf.site,\n      pageKey: conf.pageKey,\n      pageTitle: conf.pageTitle,\n      countEl: conf.countEl,\n      pvEl: conf.pvEl,\n      pvAdd: (typeof ctx.conf.pvAdd === 'boolean' ? ctx.conf.pvAdd : true),\n    })\n  })\n}\n\n/** 初始化评论数和 PV 数量展示元素 */\nexport async function initCountWidget(opt: CountOptions) {\n  // 评论数\n  if (opt.countEl && document.querySelector(opt.countEl)) {\n    refreshStatCount(opt, { query: 'page_comment', numEl: opt.countEl })\n  }\n\n  // PV\n  const initialData = (opt.pvAdd && opt.pageKey) ? {\n    [opt.pageKey]: (await opt.getApi().pages.logPv({\n      page_key: opt.pageKey,\n      page_title: opt.pageTitle,\n      site_name: opt.siteName,\n    })).data.pv // pv+1 and get pv count\n  } : undefined\n\n  if (opt.pvEl && document.querySelector(opt.pvEl)) {\n    refreshStatCount(opt, {\n      query: 'page_pv',\n      numEl: opt.pvEl,\n      data: initialData,\n    })\n  }\n}\n\ntype CountData = { [pageKey: string]: number }\n\nasync function refreshStatCount(\n  opt: CountOptions,\n  args: {\n    query: 'page_pv' | 'page_comment'\n    numEl: string\n    data?: CountData\n  }\n) {\n  let data: CountData = args.data || {}\n\n  // Get page keys which will be queried\n  let queryPageKeys = Array.from(document.querySelectorAll(args.numEl))\n    .map((e) => e.getAttribute('data-page-key') || opt.pageKey)\n    .filter((k) => k && typeof data[k] !== 'number') // filter out keys that already have data\n\n  queryPageKeys = [...new Set(queryPageKeys)] // deduplicate\n\n  // Fetch count data from server\n  if (queryPageKeys.length > 0) {\n    const res = (await opt.getApi().stats.getStats(args.query, {\n      page_keys: queryPageKeys.join(','),\n      site_name: opt.siteName,\n    })).data.data as CountData\n    data = { ...data, ...res }\n  }\n\n  const defaultCount = opt.pageKey ? data[opt.pageKey] : 0\n  applyCountData(args.numEl, data, defaultCount)\n}\n\nfunction applyCountData(selector: string, data: CountData, defaultCount: number) {\n  document.querySelectorAll(selector).forEach((el) => {\n    const pageKey = el.getAttribute('data-page-key')\n    const count = Number(pageKey ? (data[pageKey]) : defaultCount)\n    el.innerHTML = `${count}`\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { version as ARTALK_VERSION } from '~/package.json'\nimport type List from '~/src/list/list'\nimport * as Ui from '@/lib/ui'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nlet IgnoreVersionCheck = false\n\nexport const VersionCheck: ArtalkPlugin = (ctx) => {\n  ctx.watchConf(['apiVersion', 'versionCheck'], (conf) => {\n    const list = ctx.get('list')\n    if (conf.apiVersion && conf.versionCheck && !IgnoreVersionCheck)\n      versionCheck(list, ARTALK_VERSION, conf.apiVersion)\n  })\n}\n\nfunction versionCheck(list: List, feVer: string, beVer: string) {\n  const comp = Utils.versionCompare(feVer, beVer)\n  const sameVer = (comp === 0)\n  if (sameVer) return\n\n  const errEl = Utils.createElement(\n    `<div>${$t('updateMsg', { name: (comp < 0) ? $t('frontend') : $t('backend') })}` +\n    `<br/><br/><span style=\"color: var(--at-color-meta);\">` +\n    `${$t('currentVersion')}: ${$t('frontend')} ${feVer} / ${$t('backend')} ${beVer}` +\n    `</span><br/><br/></div>`)\n  const ignoreBtn = Utils.createElement(`<span style=\"cursor:pointer\">${$t('ignore')}</span>`)\n  ignoreBtn.onclick = () => {\n    Ui.setError(list.$el.parentElement!, null)\n    IgnoreVersionCheck = true\n    list.ctx.fetch({ offset: 0 })\n  }\n  errEl.append(ignoreBtn)\n  Ui.setError(list.$el.parentElement!, errEl, '<span class=\"atk-warn-title\">Artalk Warn</span>')\n}\n","import type { ArtalkPlugin } from '@/types'\n\n// Notice: Singleton pattern needs to be loaded as lazy as possible,\n//         because the SSG application does not have a `window` context.\nlet darkModeMedia: MediaQueryList | undefined\n\nfunction updateClassnames($els: HTMLElement[], darkMode: boolean) {\n  const DarkModeClassName = 'atk-dark-mode'\n\n  $els.forEach($el => {\n    if (darkMode) $el.classList.add(DarkModeClassName)\n    else $el.classList.remove(DarkModeClassName)\n  })\n}\n\nexport const DarkMode: ArtalkPlugin = (ctx) => {\n  // the handler bind to Artalk instance, don't forget to remove it when Artalk instance destroyed\n  let darkModeAutoHandler: ((evt: MediaQueryListEvent) => void) | undefined\n\n  const sync = (darkMode: boolean|'auto') => {\n    // the elements that classnames need to be updated when darkMode changed\n    const $els = [ctx.$root, ctx.get('layerManager').getEl()]\n\n    // init darkModeMedia if not exists, and only create once\n    if (!darkModeMedia) {\n      darkModeMedia = window.matchMedia('(prefers-color-scheme: dark)')\n    }\n\n    if (darkMode === 'auto') {\n      // if darkMode is 'auto', add handler\n      if (!darkModeAutoHandler) {\n        // the handler that will be called when darkModeMedia changed\n        darkModeAutoHandler = (evt) => updateClassnames($els, evt.matches)\n        darkModeMedia.addEventListener('change', darkModeAutoHandler)\n      }\n\n      // update classnames immediately\n      updateClassnames($els, darkModeMedia.matches)\n    } else {\n      // if darkMode is boolean, remove handler\n      if (darkModeAutoHandler) {\n        darkModeMedia.removeEventListener('change', darkModeAutoHandler)\n        darkModeAutoHandler = undefined\n      }\n\n      // update classnames immediately\n      updateClassnames($els, darkMode)\n    }\n  }\n\n  ctx.watchConf(['darkMode'], (conf) => sync(conf.darkMode))\n  ctx.on('created', () => sync(ctx.conf.darkMode))\n  ctx.on('unmounted', () => {\n    // if handler exists, don't forget to remove it, or it will cause memory leak\n    darkModeAutoHandler && darkModeMedia?.removeEventListener('change', darkModeAutoHandler)\n    darkModeAutoHandler = undefined\n  })\n}\n","import './style/main.scss'\n\nimport type { ArtalkConfig, EventPayloadMap, ArtalkPlugin, ContextApi } from '@/types'\nimport type { EventHandler } from './lib/event-manager'\nimport Context from './context'\nimport { handelCustomConf, convertApiOptions } from './config'\nimport Services from './service'\nimport { DefaultPlugins } from './plugins'\nimport * as Stat from './plugins/stat'\nimport { Api } from './api'\nimport type { TInjectedServices } from './service'\n\n/** Global Plugins for all instances */\nconst GlobalPlugins: ArtalkPlugin[] = [ ...DefaultPlugins ]\n\n/**\n * Artalk\n *\n * @see https://artalk.js.org\n */\nexport default class Artalk {\n  public ctx!: ContextApi\n\n  /** Plugins */\n  protected plugins: ArtalkPlugin[] = [ ...GlobalPlugins ]\n\n  constructor(conf: Partial<ArtalkConfig>) {\n    // Init Config\n    const handledConf = handelCustomConf(conf, true)\n\n    // Init Context\n    this.ctx = new Context(handledConf)\n\n    // Init Services\n    Object.entries(Services).forEach(([name, initService]) => {\n      const obj = initService(this.ctx)\n      if (obj) this.ctx.inject(name as keyof TInjectedServices, obj) // auto inject deps to ctx\n    })\n\n    // Init Plugins\n    this.plugins.forEach(plugin => {\n      if (typeof plugin === 'function') plugin(this.ctx)\n    })\n\n    // Trigger created event\n    this.ctx.trigger('created')\n  }\n\n  /** Get the config of Artalk */\n  public getConf() {\n    return this.ctx.getConf()\n  }\n\n  /** Get the root element of Artalk */\n  public getEl() {\n    return this.ctx.$root\n  }\n\n  /** Update config of Artalk */\n  public update(conf: Partial<ArtalkConfig>) {\n    this.ctx.updateConf(conf)\n    return this\n  }\n\n  /** Reload comment list of Artalk */\n  public reload() {\n    this.ctx.reload()\n  }\n\n  /** Destroy instance of Artalk */\n  public destroy() {\n    this.ctx.trigger('unmounted')\n    this.ctx.$root.remove()\n  }\n\n  /** Add an event listener */\n  public on<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\n    this.ctx.on(name, handler)\n  }\n\n  /** Remove an event listener */\n  public off<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\n    this.ctx.off(name, handler)\n  }\n\n  /** Trigger an event */\n  public trigger<K extends keyof EventPayloadMap>(name: K, payload?: EventPayloadMap[K]) {\n    this.ctx.trigger(name, payload)\n  }\n\n  /** Set dark mode */\n  public setDarkMode(darkMode: boolean) {\n    this.ctx.setDarkMode(darkMode)\n  }\n\n  // ===========================\n  //       Static Members\n  // ===========================\n\n  /** Init Artalk */\n  public static init(conf: Partial<ArtalkConfig>): Artalk {\n    return new Artalk(conf)\n  }\n\n  /** Use plugin, the plugin will be used when Artalk.init */\n  public static use(plugin: ArtalkPlugin) {\n    if (GlobalPlugins.includes(plugin)) return\n    GlobalPlugins.push(plugin)\n  }\n\n  /** Load count widget */\n  public static loadCountWidget(c: Partial<ArtalkConfig>) {\n    const conf = handelCustomConf(c, true)\n\n    Stat.initCountWidget({\n      getApi: () => new Api(convertApiOptions(conf)),\n      siteName: conf.site,\n      countEl: conf.countEl,\n      pvEl: conf.pvEl,\n      pvAdd: false\n    })\n  }\n\n  // ===========================\n  //         Deprecated\n  // ===========================\n\n  /** @deprecated Please use `getEl()` instead */\n  public get $root() { return this.ctx.$root }\n\n  /** @description Please use `getConf()` instead */\n  public get conf() { return this.ctx.getConf() }\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { ConfRemoter } from './conf-remoter'\nimport { Markdown } from './markdown'\nimport { EditorKit } from './editor-kit'\nimport { ListPlugins } from './list'\nimport { Notifies } from './notifies'\nimport { PvCountWidget } from './stat'\nimport { VersionCheck } from './version-check'\nimport { AdminOnlyElem } from './admin-only-elem'\nimport { DarkMode } from './dark-mode'\n\nexport const DefaultPlugins: ArtalkPlugin[] = [\n  ConfRemoter,\n  Markdown, EditorKit, AdminOnlyElem,\n  ...ListPlugins,\n  Notifies,\n  PvCountWidget, VersionCheck, DarkMode,\n]\n","import type { ArtalkPlugin } from '@/types'\n\nexport const AdminOnlyElem: ArtalkPlugin = (ctx) => {\n  const scanApply = () => {\n    applyAdminOnlyEls(ctx.get('user').getData().isAdmin, getAdminOnlyEls({\n      $root: ctx.$root\n    }))\n  }\n\n  ctx.on('list-loaded', () => {\n    scanApply()\n  })\n\n  ctx.on('user-changed', (user) => {\n    scanApply()\n  })\n}\n\nfunction getAdminOnlyEls(opts: { $root: HTMLElement }): HTMLElement[] {\n  const els: HTMLElement[] = []\n\n  // elements in $root\n  opts.$root.querySelectorAll<HTMLElement>(`[atk-only-admin-show]`).forEach(item => els.push(item))\n\n  // TODO: provide a Artalk.conf hook to set whitelist of admin-only elements,\n  // and move following code to that hook (move into @artalk/artalk-sidebar)\n\n  // elements in sidebar\n  const $sidebarEl = document.querySelector<HTMLElement>('.atk-sidebar')\n  if ($sidebarEl) $sidebarEl.querySelectorAll<HTMLElement>(`[atk-only-admin-show]`).forEach(item => els.push(item))\n\n  return els\n}\n\nfunction applyAdminOnlyEls(isAdmin: boolean, els: HTMLElement[]) {\n  els.forEach(($item: HTMLElement) => {\n    if (isAdmin) $item.classList.remove('atk-hide')\n    else $item.classList.add('atk-hide')\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { WithEditor } from './with-editor'\nimport { Unread } from './unread'\nimport { Count } from './count'\nimport { SidebarBtn } from './sidebar-btn'\nimport { UnreadBadge } from './unread-badge'\nimport { GotoDispatcher } from './goto-dispatcher'\nimport { GotoFocus } from './goto-focus'\nimport { Copyright } from './copyright'\nimport { NoComment } from './no-comment'\nimport { Dropdown } from './dropdown'\nimport { TimeTicking } from './time-ticking'\nimport { ErrorDialog } from './error-dialog'\nimport { Loading } from './loading'\nimport { Fetch } from './fetch'\nimport { ReachBottom } from './reach-bottom'\nimport { GotoFirst } from './goto-first'\n\nconst ListPlugins: ArtalkPlugin[] = [\n  Fetch, Loading, Unread,\n  WithEditor, Count, SidebarBtn, UnreadBadge,\n  Dropdown, GotoDispatcher, GotoFocus, NoComment, Copyright,\n  TimeTicking, ErrorDialog, ReachBottom, GotoFirst\n]\n\nexport { ListPlugins }\n","import type { ListFetchParams, ArtalkPlugin } from '@/types'\n\nexport const Fetch: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (_params) => {\n    if (ctx.getData().getLoading()) return\n    ctx.getData().setLoading(true)\n\n    const params: ListFetchParams = {\n      // default params\n      offset: 0,\n      limit: ctx.conf.pagination.pageSize,\n      flatMode: ctx.conf.flatMode as boolean, // always be boolean because had been handled in Artalk.init\n      paramsModifier: ctx.conf.listFetchParamsModifier,\n      ..._params\n    }\n\n    // must before other function call\n    ctx.getData().setListLastFetch({\n      params\n    })\n\n    // prepare params for request\n    const reqParams = {\n      limit: params.limit,\n      offset: params.offset,\n      flat_mode: params.flatMode,\n      page_key: ctx.getConf().pageKey,\n      site_name: ctx.getConf().site,\n    }\n\n    // call the modifier function\n    if (params.paramsModifier) params.paramsModifier(reqParams)\n\n    // start request\n    ctx.getApi().comments\n      .getComments({\n        ...reqParams,\n        ...ctx.getApi().getUserFields()\n      })\n      .then(({ data }) => {\n        // Must before all other function call and event trigger,\n        // because it will depend on the lastData\n        // TODO: this is global variable, easy to use, but not good, consider to refactor.\n        // refactor work is hard, because it is used in many places.\n        ctx.getData().setListLastFetch({ params, data })\n\n        // 装置评论\n        ctx.getData().loadComments(data.comments)\n\n        // 更新页面数据\n        ctx.getData().updatePage(data.page)\n\n        // trigger events when success\n        params.onSuccess && params.onSuccess(data)\n\n        ctx.trigger('list-fetched', { params, data })\n      })\n      .catch((e) => {\n        // 显示错误对话框\n        const error = {\n          msg: e.msg || String(e),\n          data: e.data\n        }\n\n        params.onError && params.onError(error)\n\n        // trigger events when error\n        ctx.trigger('list-failed', error)\n        ctx.trigger('list-fetched', { params, error })\n\n        throw e\n      })\n      .finally(() => {\n        ctx.getData().setLoading(false)\n      })\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Ui from '@/lib/ui'\n\nexport const Loading: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (p) => {\n    const list = ctx.get('list')\n\n    if (p.offset === 0) // only show loading when fetch first page\n      Ui.setLoading(true, list.$el)\n    // else if not first page, show loading in paginator (code not there)\n  })\n\n  ctx.on('list-fetched', () => {\n    const list = ctx.get('list')\n    Ui.setLoading(false, list.$el)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport const Unread: ArtalkPlugin = (ctx) => {\n  ctx.on('comment-rendered', (comment) => {\n    // comment unread highlight\n    if (ctx.conf.listUnreadHighlight === true) {\n      const notifies = ctx.getData().getNotifies()\n      const notify = notifies.find(o => o.comment_id === comment.getID())\n\n      if (notify) {\n        // if comment contains in unread list\n        comment.getRender().setUnread(true)\n        comment.getRender().setOpenAction(() => {\n          window.open(notify.read_link)\n\n          // remove notify which has been read\n          ctx.getData().updateNotifies(notifies.filter(o => o.comment_id !== comment.getID()))\n        })\n      } else {\n        // comment not in unread list\n        comment.getRender().setUnread(false)\n      }\n    }\n  })\n\n  ctx.on('list-goto', (commentID) => {\n    const notifyKey = Utils.getQueryParam('atk_notify_key')\n    if (notifyKey) {\n      // mark as read\n      ctx.getApi().notifies.markNotifyRead(commentID, notifyKey)\n        .then(() => {\n          // remove from unread list\n          ctx.getData().updateNotifies(ctx.getData().getNotifies().filter(o => o.comment_id !== commentID))\n        })\n    }\n  })\n}\n","import type { ContextApi, ArtalkPlugin, PageData } from '@/types'\nimport $t from '@/i18n'\n\nexport const WithEditor: ArtalkPlugin = (ctx) => {\n  let $closeCommentBtn: HTMLElement|undefined\n\n  // on Artalk mounted\n  // (after all components had mounted)\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    $closeCommentBtn = list.$el.querySelector<HTMLElement>('[data-action=\"admin-close-comment\"]')!\n\n    // bind editor close button click event\n    $closeCommentBtn.addEventListener('click', () => {\n      const page = ctx.getData().getPage()\n      if (!page) throw new Error('Page data not found')\n\n      page.admin_only = !page.admin_only\n      adminPageEditSave(ctx, page)\n    })\n  })\n\n  // on comment list loaded (it will include page data update)\n  ctx.on('page-loaded', (page) => {\n    const editor = ctx.get('editor')\n\n    // if page comment is closed\n    if (page?.admin_only === true) {\n      // then close editor\n      editor.getPlugs()?.getEvents().trigger('editor-close')\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('openComment'))\n    } else {\n      // the open editor\n      editor.getPlugs()?.getEvents().trigger('editor-open')\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('closeComment'))\n    }\n  })\n\n  ctx.on('list-loaded', (comments) => {\n    // 防止评论框被吞\n    ctx.editorResetState()\n  })\n}\n\n/** 管理员设置页面信息 */\nfunction adminPageEditSave(ctx: ContextApi, page: PageData) {\n  ctx.editorShowLoading()\n  ctx.getApi().pages.updatePage(page.id, page)\n    .then(({ data }) => {\n      ctx.getData().updatePage(data)\n    })\n    .catch(err => {\n      ctx.editorShowNotify(`${$t('editFail')}: ${err.msg || String(err)}`, 'e')\n    })\n    .finally(() => {\n      ctx.editorHideLoading()\n    })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport const Count: ArtalkPlugin = (ctx) => {\n  const refreshCountNumEl = () => {\n    const list = ctx.get('list')\n\n    const $count = list.$el.querySelector('.atk-comment-count .atk-text')\n    if (!$count) return\n\n    const text = Utils.htmlEncode($t('counter', { count: `${Number(ctx.getData().getListLastFetch()?.data?.count) || 0}` }))\n    $count.innerHTML = text.replace(/(\\d+)/, '<span class=\"atk-comment-count-num\">$1</span>')\n  }\n\n  ctx.on('list-loaded', () => {\n    refreshCountNumEl()\n  })\n\n  ctx.on('comment-inserted', () => {\n    // 评论数增加 1\n    const last = ctx.getData().getListLastFetch()\n    if (last?.data) last.data.count += 1\n  })\n\n  ctx.on('comment-deleted', () => {\n    // 评论数减 1\n    const last = ctx.getData().getListLastFetch()\n    if (last?.data) last.data.count -= 1\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport $t from '@/i18n'\n\nexport const SidebarBtn: ArtalkPlugin = (ctx) => {\n  let $openSidebarBtn: HTMLElement|null = null\n\n  const syncByUser = () => {\n    if (!$openSidebarBtn) return\n    const user = ctx.get('user').getData()\n\n    // 已输入个人信息\n    if (!!user.nick && !!user.email) {\n      $openSidebarBtn.classList.remove('atk-hide')\n\n      // update button text (normal user or admin)\n      const $btnText = $openSidebarBtn.querySelector<HTMLElement>('.atk-text')\n      if ($btnText) $btnText.innerText = (!user.isAdmin) ? $t('msgCenter') : $t('ctrlCenter')\n    } else {\n      $openSidebarBtn.classList.add('atk-hide')\n    }\n  }\n\n  ctx.watchConf(['locale'], (conf) => {\n    const list = ctx.get('list')\n\n    $openSidebarBtn = list.$el.querySelector<HTMLElement>('[data-action=\"open-sidebar\"]')\n    if (!$openSidebarBtn) return\n\n    $openSidebarBtn.onclick = () => { // use onclick rather than addEventListener to prevent duplicate event\n      ctx.showSidebar()\n    }\n\n    syncByUser()\n  })\n\n  ctx.on('user-changed', (user) => {\n    syncByUser()\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const UnreadBadge: ArtalkPlugin = (ctx) => {\n  let $unreadBadge: HTMLElement|null = null\n\n  const showUnreadBadge = (count: number) => {\n    if (!$unreadBadge) return\n\n    if (count > 0) {\n      $unreadBadge.innerText = `${Number(count || 0)}`\n      $unreadBadge.style.display = 'block'\n    } else {\n      $unreadBadge.style.display = 'none'\n    }\n  }\n\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    $unreadBadge = list.$el.querySelector<HTMLElement>('.atk-unread-badge')\n  })\n\n  ctx.on('notifies-updated', (notifies) => {\n    showUnreadBadge(notifies.length || 0)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport $t from '@/i18n'\n\nexport const Dropdown: ArtalkPlugin = (ctx) => {\n  const reloadUseParamsEditor = (func: (p: any) => void) => {\n    ctx.conf.listFetchParamsModifier = func\n    ctx.reload()\n  }\n\n  const initDropdown = ($dropdownOn: HTMLElement) => {\n    renderDropdown({\n      $dropdownWrap: $dropdownOn,\n      dropdownList: [\n        [$t('sortLatest'), () => { reloadUseParamsEditor(p => { p.sort_by = 'date_desc' }) }],\n        [$t('sortBest'), () => { reloadUseParamsEditor(p => { p.sort_by = 'vote' }) }],\n        [$t('sortOldest'), () => { reloadUseParamsEditor(p => { p.sort_by = 'date_asc' }) }],\n        [$t('sortAuthor'), () => { reloadUseParamsEditor(p => { p.view_only_admin = true }) }],\n      ]\n    })\n  }\n\n  ctx.watchConf(['listSort', 'locale'], (conf) => {\n    const list = ctx.get('list')\n\n    const $count = list.$el.querySelector<HTMLElement>('.atk-comment-count')\n    if (!$count) return\n\n    // 评论列表排序 Dropdown 下拉选择层\n    if (conf.listSort) {\n      initDropdown($count)\n    } else {\n      removeDropdown({\n        $dropdownWrap: $count\n      })\n    }\n  })\n}\n\n/** 评论排序方式选择下拉菜单 */\nfunction renderDropdown(conf: {\n  $dropdownWrap: HTMLElement,\n  dropdownList: [string, () => void][]\n}) {\n  const { $dropdownWrap, dropdownList } = conf\n  if ($dropdownWrap.querySelector('.atk-dropdown')) return\n\n  // 修改 class\n  $dropdownWrap.classList.add('atk-dropdown-wrap')\n\n  // 插入图标\n  $dropdownWrap.append(Utils.createElement(`<span class=\"atk-arrow-down-icon\"></span>`))\n\n  // 列表项点击事件\n  let curtActive = 0 // 当前选中\n  const onItemClick = (i: number, $item: HTMLElement, name: string, action: Function) => {\n    action()\n\n    // set active\n    curtActive = i\n    $dropdown.querySelectorAll('.active').forEach((e) => { e.classList.remove('active') })\n    $item.classList.add('active')\n\n    // 关闭层 (临时消失，取消 :hover)\n    $dropdown.style.display = 'none'\n    setTimeout(() => { $dropdown.style.display = '' }, 80)\n  }\n\n  // 生成列表元素\n  const $dropdown = Utils.createElement(`<ul class=\"atk-dropdown atk-fade-in\"></ul>`)\n  dropdownList.forEach((item, i) => {\n    const name = item[0] as string\n    const action = item[1] as Function\n\n    const $item = Utils.createElement(`<li class=\"atk-dropdown-item\"><span></span></li>`)\n    const $link = $item.querySelector<HTMLElement>('span')!\n    $link.innerText = name\n    $link.onclick = () => { onItemClick(i, $item, name, action) }\n    $dropdown.append($item)\n\n    if (i === curtActive) $item.classList.add('active') // 默认选中项\n  })\n\n  $dropdownWrap.append($dropdown)\n}\n\n/** 删除评论排序方式选择下拉菜单 */\nfunction removeDropdown(conf: {\n  $dropdownWrap: HTMLElement\n}) {\n  const { $dropdownWrap } = conf\n  $dropdownWrap.classList.remove('atk-dropdown-wrap')\n  $dropdownWrap.querySelector('.atk-arrow-down-icon')?.remove()\n  $dropdownWrap.querySelector('.atk-dropdown')?.remove()\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\nexport const GotoDispatcher: ArtalkPlugin = (ctx) => {\n  let lastID = 0\n  const check = ({ locker }: { locker: boolean }) => {\n    const commentID = extractCommentID()\n    if (!commentID) return\n\n    if (locker && lastID === commentID) return  // if the commentID is the same as the last one, do nothing\n    lastID = commentID  // record the last commentID\n\n    ctx.trigger('list-goto', commentID) // trigger event\n  }\n\n  const hashChangeHandler = () => check({ locker: false })\n  const listLoadedHandler = () => check({ locker: true })\n  ctx.on('mounted', () => {\n    window.addEventListener('hashchange', hashChangeHandler)\n    ctx.on('list-loaded', listLoadedHandler)\n  })\n  ctx.on('unmounted', () => {\n    window.removeEventListener('hashchange', hashChangeHandler)\n    ctx.off('list-loaded', listLoadedHandler)\n  })\n}\n\nfunction extractCommentID(): number|null {\n  // Try get from hash\n  // Hash retrieval priority is higher than query,\n  // Because click goto will change hash.\n  const match = window.location.hash.match(/#atk-comment-([0-9]+)/)\n  let commentId = match && match[1] && !Number.isNaN(parseFloat(match[1])) ? parseFloat(match[1]) : null\n\n  // Fail over to get from query\n  if (!commentId) {\n    commentId = Number(Utils.getQueryParam('atk_comment')) // same as backend GetReplyLink()\n  }\n\n  return commentId || null\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\nimport { sanitize } from '@/lib/sanitizer'\n\nexport const NoComment: ArtalkPlugin = (ctx) => {\n  ctx.on('list-loaded', (comments) => {\n    const list = ctx.get('list')!\n\n    // 无评论\n    const isNoComment = comments.length <= 0\n    let $noComment = list.getCommentsWrapEl().querySelector<HTMLElement>('.atk-list-no-comment')\n\n    if (isNoComment) {\n      if (!$noComment) {\n        $noComment = Utils.createElement('<div class=\"atk-list-no-comment\"></div>')\n\n        // sanitize before set innerHTML\n        $noComment.innerHTML = sanitize(list.ctx.conf.noComment || list.ctx.$t('noComment'))\n        list.getCommentsWrapEl().appendChild($noComment)\n      }\n    } else {\n      $noComment?.remove()\n    }\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport { version as ARTALK_VERSION } from '~/package.json'\n\nexport const Copyright: ArtalkPlugin = (ctx) => {\n  ctx.on('mounted', () => {\n    const list = ctx.get('list')\n\n    const $copyright = list.$el.querySelector<HTMLElement>('.atk-copyright')\n    if (!$copyright) return\n\n    $copyright.innerHTML = (\n      `Powered By <a href=\"https://artalk.js.org\" ` +\n      `target=\"_blank\" title=\"Artalk v${ARTALK_VERSION}\">` +\n      `Artalk</a>`)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/** 评论时间自动更新 */\nexport const TimeTicking: ArtalkPlugin = (ctx) => {\n  let timer: number|null = null\n\n  ctx.on('mounted', () => {\n    timer = window.setInterval(() => {\n      const list = ctx.get('list')\n\n      list.$el.querySelectorAll<HTMLElement>('[data-atk-comment-date]').forEach(el => {\n        const date = el.getAttribute('data-atk-comment-date')\n        el.innerText = Utils.timeAgo(new Date(Number(date)), ctx.$t)\n      })\n    }, 30 * 1000) // 30s 更新一次\n  })\n\n  ctx.on('unmounted', () => {\n    timer && window.clearInterval(timer)\n  })\n}\n","import type { ArtalkPlugin, ContextApi } from '@/types'\nimport { showErrorDialog } from '@/components/error-dialog'\nimport * as Ui from '../../lib/ui'\n\nexport const ErrorDialog: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', () => {\n    const list = ctx.get('list')\n\n    // clear the original error when a new fetch is triggered\n    Ui.setError(list.$el, null)\n  })\n\n  ctx.on('list-failed', (err) => {\n    showErrorDialog({\n      $err: ctx.get('list').$el,\n      errMsg: err.msg,\n      errData: err.data,\n      retryFn: () => ctx.fetch({ offset: 0 })\n    })\n  })\n}\n\n","import type { ArtalkPlugin } from '@/types'\n\nexport const ReachBottom: ArtalkPlugin = (ctx) => {\n  let observer: IntersectionObserver|null = null\n\n  const setupObserver = ($target: HTMLElement) => {\n    const scrollEvtAt = (ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()) || null\n\n    // eslint-disable-next-line compat/compat\n    observer = new IntersectionObserver(([entries]) => {\n      if (entries.isIntersecting) {\n        clearObserver() // clear before trigger event to avoid trigger twice `list-reach-bottom`\n\n        // note that this event will be triggered only once\n        // until the next list is loaded\n        ctx.trigger('list-reach-bottom')\n      }\n    }, {\n      threshold: 0.9, // when the target is 90% visible\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/root\n      // If the root is null, then the bounds of the actual document viewport are used.\n      root: scrollEvtAt\n    })\n    observer.observe($target)\n  }\n\n  const clearObserver = () => {\n    observer?.disconnect()\n    observer = null\n  }\n\n  ctx.on('list-loaded', () => {\n    clearObserver()\n\n    const list = ctx.get('list')\n\n    // get the second last child\n    const children = list.getCommentsWrapEl().childNodes\n    const $target = children.length > 2 ? children[children.length - 2] as HTMLElement : null\n    if (!$target) return\n\n    // check IntersectionObserver support\n    if (!('IntersectionObserver' in window)) {\n      console.warn('IntersectionObserver api not supported')\n      return\n    }\n\n    // use IntersectionObserver to detect reach bottom\n    setupObserver($target)\n  })\n\n  ctx.on('unmounted', () => {\n    clearObserver()\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\nimport * as Utils from '@/lib/utils'\n\n/** List scroll to the first comment */\nexport const GotoFirst: ArtalkPlugin = (ctx) => {\n  const handler = () => {\n    const list = ctx.get('list')\n\n    const $relative = ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()\n    ;($relative || window).scroll({\n      top: Utils.getOffset(list.$el, $relative).top,\n      left: 0,\n    })\n  }\n\n  ctx.on('mounted', () => {\n    ctx.on('list-goto-first', handler)\n  })\n\n  ctx.on('unmounted', () => {\n    ctx.off('list-goto-first', handler)\n  })\n}\n","import type { ArtalkPlugin } from '@/types'\n\nexport const Notifies: ArtalkPlugin = (ctx) => {\n  ctx.on('list-fetch', (params) => {\n    if (params.offset !== 0) return\n\n    const user = ctx.getApi().getUserFields()\n    if (!user) return\n\n    // Fetch all unread notifies\n    ctx.getApi().notifies.getNotifies(user).then(res => {\n      ctx.getData().updateNotifies(res.data.notifies)\n    })\n  })\n}\n","import Artalk from './artalk'\nimport type * as ArtalkType from './types'\n\nexport type * from './types'\nexport { ArtalkType }\n\nexport default Artalk\n\n// Expose the static methods from the Artalk class\n// because direct export of static methods is not supported\n// for adapting to different environments like CommonJS and browser IIFE\n// for example, we can use `Artalk.init()` rather than `Artalk.default.init()`\n// therefore, we need to manually expose the static methods in the Artalk class.\nexport const init = Artalk.init\nexport const use = Artalk.use\nexport const loadCountWidget = Artalk.loadCountWidget\n"],"names":["HttpClient","constructor","apiConfig","__publicField","this","Map","fetchParams","fetch","credentials","headers","redirect","referrerPolicy","data","securityData","input","JSON","stringify","Object","keys","reduce","formData","key","property","append","Blob","FormData","toQueryString","cancelToken","abortControllers","has","abortController","get","signal","AbortController","set","abort","delete","_a","__async","_b","body","secure","path","type","query","format","baseUrl","params","__objRest","secureParams","baseApiParams","securityWorker","requestParams","mergeRequestParams","queryString","payloadFormatter","contentFormatters","responseFormat","customFetch","__spreadProps","__spreadValues","createAbortSignal","then","response","r","error","ok","catch","e","assign","encodeQueryParam","value","encodeURIComponent","addQueryParam","addArrayQueryParam","map","v","join","rawQuery","filter","Array","isArray","addQueryParams","params1","params2","super","arguments","flushCache","request","method","warmUpCache","getCaptcha","getCaptchaStatus","verifyCaptcha","getComments","createComment","comment","getComment","id","updateComment","deleteComment","conf","getNotifies","markAllNotifyRead","options","markNotifyRead","commentId","notifyKey","getPages","fetchAllPages","getPageFetchStatus","logPv","page","updatePage","deletePage","fetchPage","sendEmail","email","getSettings","applySettings","settings","getSettingsTemplate","locale","getSites","createSite","site","updateSite","deleteSite","getStats","exportArtrans","importArtrans","uploadArtrans","upload","getUser","login","user","getUserStatus","createUser","updateUser","deleteUser","getUsers","getVersion","syncVotes","vote","targetId","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","prototype","_inherits","subClass","superClass","create","_setPrototypeOf","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","bind","__proto__","p","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","call","_assertThisInitialized","self","ReferenceError","_possibleConstructorReturn","_createSuper","Derived","hasNativeReflectConstruct","result","Super","NewTarget","apply","_superPropBase","object","hasOwnProperty","_get","receiver","base","desc","getOwnPropertyDescriptor","Emitter","callback","listeners","push","stack","l","splice","event","stackToCall","slice","listener","Promise","resolve","once","removeEventListener","defaultPrevented","AbortSignal","_Emitter","_super","_this","aborted","onabort","reason","Event","document","createEvent","initEvent","createEventObject","bubbles","cancelable","signalReason","Error","name","DOMException","err","dispatchEvent","polyfillNeeded","__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL","console","log","Request","abortableFetchDecorator","patchTargets","_patchTargets","_patchTargets$Request","NativeRequest","NativeAbortController","_patchTargets$__FORCE","init","realFetch","isPrototypeOf","abortError","reject","cancellation","_","addEventListener","race","Symbol","toStringTag","_abortableFetch","warn","global","Fetch","opts","exports","apiToken","getApiToken","Headers","Authorization","resp","json","need_captcha","onNeedCheckCaptcha","imgData","img_data","iframe","need_login","onNeedCheckAdmin","code","FetchException","message","msg","createError","status","Api","ApiV2","baseURL","_opts","getUserFields","userInfo","_getDefaults","async","breaks","extensions","gfm","hooks","pedantic","renderer","silent","tokenizer","walkTokens","_defaults","changeDefaults","newDefaults","escapeTest","escapeReplace","RegExp","source","escapeTestNoEncode","escapeReplaceNoEncode","escapeReplacements","getEscapeReplacement","ch","escape$1","html","encode","test","replace","unescapeTest","caret","edit","regex","opt","obj","val","valSource","getRegex","cleanUrl","href","encodeURI","noopTest","exec","splitCells","tableRow","count","cells","match","offset","str","escaped","curr","split","trim","shift","pop","rtrim","c","invert","suffLen","currChar","charAt","outputLink","cap","link","raw","lexer","title","text","state","inLink","token","tokens","inlineTokens","_Tokenizer","space","src","rules","block","newline","codeBlockStyle","fences","matchIndentToCode","indentToCode","node","matchIndentInNode","indentInNode","indentCodeCompensation","lang","inline","anyPunctuation","heading","trimmed","depth","hr","blockquote","top","blockTokens","list","bull","isordered","ordered","start","loose","items","itemRegex","itemContents","endsWithBlankLine","endEarly","substring","line","t","repeat","nextLine","indent","trimStart","search","blankLine","nextBulletRegex","Math","min","hrRegex","fencesBeginRegex","headingBeginRegex","rawLine","ischecked","istask","task","checked","trimEnd","spacers","hasMultipleLineBreaks","some","pre","def","tag","toLowerCase","table","aligns","rows","item","header","align","row","cell","lheading","paragraph","escape","inRawBlock","trimmedUrl","rtrimSlash","lastParenIndex","b","indexOf","level","findClosingBracket","linkLen","reflink","links","nolink","emStrong","maskedSrc","prevChar","emStrongLDelim","punctuation","lLength","rDelim","rLength","delimTotal","midDelimTotal","endReg","emStrongRDelimAst","emStrongRDelimUnd","lastIndex","lastCharLength","index","codespan","hasNonSpaceChars","hasSpaceCharsOnBothEnds","br","del","autolink","url","prevCapZero","_backpedal","inlineText","bullet","_paragraph","_blockLabel","_tag","_comment","blockNormal","gfmTable","blockGfm","blockPedantic","_punctuation","_inlineComment","_inlineLabel","inlineNormal","blockSkip","reflinkSearch","inlinePedantic","inlineGfm","inlineBreaks","normal","_Lexer","inlineQueue","lex","lexInline","next","lastToken","cutSrc","lastParagraphClipped","leading","tabs","extTokenizer","startBlock","startIndex","Infinity","tempSrc","tempStart","forEach","getStartIndex","errMsg","charCodeAt","keepPrevChar","includes","lastIndexOf","startInline","_Renderer","infostring","quote","listitem","checkbox","tablerow","content","tablecell","flags","strong","em","cleanHref","out","image","_TextRenderer","_Parser","textRenderer","parse","parser","parseInline","renderers","genericToken","ret","headingToken","n","String","fromCharCode","parseInt","codeToken","tableToken","j","k","blockquoteToken","listToken","itemBody","unshift","htmlToken","paragraphToken","textToken","escapeToken","tagToken","linkToken","imageToken","strongToken","emToken","codespanToken","delToken","_Hooks","preprocess","markdown","postprocess","processAllTokens","Set","_parseMarkdown","WeakSet","parseMarkdown_fn","origOpt","defaults","throwError","__privateMethod","_onError","onError_fn","toString","all","markedInstance","args","__privateAdd","setOptions","use","values","concat","childTokens","flat","pack","ext","prevRenderer","extLevel","prop","rendererProp","rendererFunc","tokenizerProp","tokenizerFunc","prevTokenizer","hooksProp","hooksFunc","prevHook","passThroughHooks","arg","packWalktokens","marked","getDefaults","Parser","Renderer","TextRenderer","Lexer","Tokenizer","Hooks","escapes","unescapes","rescaped","runescaped","escapeHtmlChar","unescapeHtmlChar","escapeHtml","unescapeHtml","she","decode","unescape","version","assignment_1","assignment","lowercase","string","asKey","accumulator","toMap_1","attributes","uris","require$$0","elements","voids","he","require$$1","require$$3","rstart","rend","rattrs","rtag","rtagend","require$$2","handler","chars","lastItem","createStack","last","parsePart","substr","parseEdge","parseEndTag","parseStartTag","same","tagName","rest","unary","attrs","low","u","doubleQuotedValue","singleQuotedValue","unquotedValue","pos","end","sanitizer","buffer","context","ignoring","ignore","allowedTags","classesOk","allowedClasses","attrsOk","allowedAttributes","lkey","className","colon","questionmark","hash","allowedSchemes","matches","scheme","testUrl","unignore","transformText","reset","a","img","insane","strict","configuration","insaneOptions","span","reg","class","style","sanitize","createCommonjsModule","fn","module","index$1","defaultColors","toComment","cm","ref","colors","cache","re","m","word","color","factory","renderCode","hanabi","getRenderer","libMarked","markedLinkRenderer","markedCodeRenderer","orgLinkRenderer","localLink","startsWith","window","location","protocol","hostname","realLang","colorized","hljs","getLanguage","highlight","replacers","markedOptions","getInstance","markedContent","alt","imgSrc","simpleMarked","dest","replacer","mergeDeep","objects","isObject","prev","pVal","oVal","DataManager","events","getLoading","loading","setLoading","getListLastFetch","listLastFetch","setListLastFetch","comments","fetchComments","trigger","findComment","find","clearComments","loadComments","partialComments","insertComment","notifies","updateNotifies","getPage","pageData","en","placeholder","noComment","send","save","nick","emoticon","preview","uploadImage","uploadFail","commentFail","restoredMsg","onlyAdminCanReply","uploadLoginMsg","counter","sortLatest","sortOldest","sortBest","sortAuthor","openComment","closeComment","listLoadFailMsg","listRetry","loadMore","admin","reply","voteUp","voteDown","voteFail","readMore","actionConfirm","collapse","collapsed","collapsedMsg","expand","approved","pending","pendingMsg","editCancel","deleteConfirm","pin","unpin","seconds","minutes","hours","days","now","adminCheck","captchaCheck","confirm","cancel","msgCenter","ctrlCenter","frontend","backend","loadFail","editing","editFail","deleting","deleteFail","reqGot","reqAborted","updateMsg","currentVersion","open","openName","GLOBAL_LOCALES_KEY","createElement","htmlStr","div","innerHTML","firstElementChild","htmlEncode","temp","innerText","getQueryParam","decodeURIComponent","getOffset","el","relativeTo","getOffsetRecursive","element","rect","getBoundingClientRect","scrollLeft","pageXOffset","documentElement","scrollTop","pageYOffset","left","elOffset","relativeToOffset","padWithZeros","vNumber","width","numAsString","timeAgo","date","$t","oldTime","getTime","diffValue","Date","floor","leave1","leave2","leave3","round","vDay","getDate","vMonth","getMonth","getFullYear","dateFormat","getCorrectUserAgent","uaRaw","navigator","userAgent","userAgentData","getHighEntropyValues","uaData","uaGot","majorPlatformVersion","Number","platformVersion","platform","isValidURL","urlRaw","URL","getURLBasedOnApi","internal","findLocaleSet","p1","p2","toUpperCase","LocaleConf","LocaleDict","setLocale","Utils.htmlEncode","EventManager","on","off","evt","payload","pageKey","pageTitle","server","sendBtn","darkMode","editorTravel","flatMode","nestMax","nestSort","emoticons","uaBadge","listSort","countEl","pvEl","gravatar","mirror","pagination","pageSize","autoLoad","heightLimit","children","scrollable","imgUpload","reqTimeout","versionCheck","useBackendConf","handelCustomConf","customConf","full","Defaults","findEl","querySelector","pathname","language","matchMedia","convertApiOptions","ctx","siteName","timeout","getData","checkHasBasicUserInfo","checkAdmin","checkCaptcha","watchConf","effect","lastVal","newVal","getConf","res","Context","getCommentNodes","$root","classList","add","mounted","inject","depName","getApi","replyComment","commentData","$comment","editor","setReply","editComment","setEditComment","reload","listGotoFirst","editorShowLoading","showLoading","editorHideLoading","hideLoading","editorShowNotify","showNotify","editorResetState","resetState","showSidebar","sidebarLayer","show","hideSidebar","hide","checkerLauncher","I18n.t","setDarkMode","updateConf","nConf","getEl","getMarked","marked.getInstance","Dialog","contentEl","$el","Utils.createElement","$actions","$content","appendChild","setYes","btn","onclick","onBtnClick","setNo","currentTarget","remove","parentElem","$loading","transparentBg","background","display","$spinner","setTimeout","isConnected","scrollIntoView","elem","enableAnim","containerRect","clientHeight","scrollY","innerHeight","height","scrollOptions","behavior","scroll","playFadeInAnim","after","onAnimEnded","playFadeAnim","setError","errorTextEl","HTMLElement","iframeBody","checker","$iframeWrap","$iframe","Ui.showLoading","getOpts","getCaptchaIframeURL","onload","Ui.hideLoading","$closeBtn","hideInteractInput","stop","queryStatus","ms","isPass","captcha","is_pass","triggerSuccess","CaptchaChecker","inputVal","render.iframeBody","imgEl","setAttribute","render.imgBody","onSuccess","formEl","onError","click","AdminChecker","inputType","password","update","isAdmin","onReload","wrapPromise","cancelFn","onCancel","successFn","CheckerLauncher","fire","postFire","layer","getCtx","close","destroy","checkerStore","checkerCtx","$input","btnTextOrg","focus","onkeyup","keyCode","preventDefault","dialog","btnEl","btnTextRestore","btnText","tf","onfocus","clearTimeout","onMount","Component","Sel","$header","$nick","$email","$link","$textareaWrap","$textarea","$bottom","$submitBtn","$notifyWrap","$bottomLeft","$stateWrap","$plugBtnWrap","$plugPanelWrap","EditorPlug","kit","useBtn","$btn","usePanel","$panel","useContentTransformer","func","contentTransformer","usePanelShow","useEvents","aPlug","usePanelHide","useEditorStateEffect","stateName","effectFn","editorStateEffectWhen","editorStateEffect","Mover","move","afterEl","isMoved","editorEl","useUI","$travelPlace","replaceWith","back","useGlobalCtx","EditorStateManager","stateCurt","stateUnmountFn","getPlugs","moveAfterEl","_d","_c","$relative","scrollRelativeTo","Ui.scrollIntoView","getUI","plugin","_e","Editor","ui","entries","sel","render","getState","getHeaderInputEls","getContentFinal","getContentRaw","plugs","getTransformedContent","getContentMarked","setContent","getEvents","insertContent","selection","createRange","selectionStart","sStart","sEnd","selectionEnd","sT","switch","wrapElem","notifyElem","s","w","notifyRemove","timeoutFn","Ui.showNotify","submit","SidebarLayer","refreshOnShow","transform","initLayer","createIframe","view","iFrameSrc","iframeLoad","authCheck","animTimer","is_admin","is_login","setOnAfterHide","Utils.getURLBasedOnApi","time","urlParams","URLSearchParams","createNestStrategy","import","srcData","sortBy","nodeList","rid","root","rootNode","parent","loadChildren","parentNode","child","childNode","sortFunc","vote_up","sortLevels","nodes","sort","ListNest.makeNestCommentNodeList","nestSortBy","rootC","createCommentNode","$commentsWrap","getRender","parentC","childD","childC","putChild","checkHeightLimit","insert","prepend","findCommentNode","getParents","heightLimitRemoveForChildren","insertMode","is_collapsed","is_allow_reply","visible","$listCommentsWrap","ListLayout","getStrategy","check","max","maxHeight","imgContains","_apply","contains","HEIGHT_LIMIT_SCROLL_CSS","applyScrollableHeightLimit","HEIGHT_LIMIT_CSS","overflow","$expandBtn","stopPropagation","disposeHeightLimit","postBtnClick","applyHeightLimit","postExpandBtnClick","_check","parseFloat","getComputedStyle","Utils.getHeight","$container","images","getElementsByTagName","loaded","complete","onImagesLoaded","from","renderNick","$headerNick","$nickA","Utils.isValidURL","renderVerifyBadge","$headerBadgeWrap","badgeText","badge_name","badgeColor","badge_color","$badge","backgroundColor","is_pinned","$pinnedBadge","renderDate","$date","getDateFormatted","renderUABadge","ip_region","$uaWrap","$regionBadge","browser","os","getUserUA","$uaBrowser","$usOS","ActionBtn","getText","adminOnly","isMessaging","msgRecTimer","appendTo","dom","setClick","isLoading","confirmRestore","isConfirming","confirmText","confirmRecTimer","fireMsgRecTimer","clearMsgRecTimer","updateText","loadingText","setMsg","setWarn","setSuccess","duringTime","setMsgRecTimer","msgRecTimerFunc","renderVote","voteBtnUp","getActions","voteBtnDown","vote_down","renderReply","replyBtn","renderCollapse","collapseBtn","adminEdit","renderModerator","pendingBtn","is_pending","renderPin","pinnedBtn","renderEdit","editBtn","renderDel","delBtn","adminDelete","Renders","Avatar","$avatar","$avatarImg","avatarURLBuilder","getGravatarURL","$avatarA","Header","Content","collapsedInfoEl","$body","insertAdjacentElement","contentShowBtn","Ui.playFadeInAnim","ReplyAt","replyTo","$replyAt","goToReplyComment","ReplyTo","$replyTo","replyContent","Pending","pendingEl","Actions","Render","$main","$childrenWrap","contentMaxH","childrenMaxH","getChildren","HeightLimit.disposeHeightLimit","playFadeAnimForBody","playFlashAnim","getChildrenWrap","setUnread","setOpenable","setOpenURL","setOpenAction","action","CommentActions","actionBtn","votes","up","down","btnElem","modify","setData","onDelete","origHash","modifyHash","CommentNode","nestCurt","actionInstance","renderInstance","CommentUI","newEl","onAfterRender","getParent","getNestCurt","getIsRoot","getID","getChildrenWrapEl","$childComment","flattenParents","emailMD5","email_encrypted","Utils.timeAgo","info","win","nav","osVersion","engine","device","engineMatch","Trident","Presto","WebKit","Gecko","browserMatch","Safari","Chrome","IE","Edge","Firefox","Chromium","Opera","Vivaldi","Yandex","Kindle","UC","QQBrowser","QQ","Baidu","Maxthon","Sogou","LBBROWSER","TheWorld","MIUI","Quark","Qiyu","Wechat","Taobao","Alipay","Weibo","Douban","Suning","iQiYi","osMatch","Windows","Linux","macOS","Android","Ubuntu","FreeBSD","Debian","BlackBerry","MeeGo","Symbian","iOS","WebOS","deviceMatch","Mobile","Tablet","showModalDialog","chrome","arr","browserLanguage","UADetect","ua","ReadMoreBtn","origText","$text","hasMore","total","onClick","checkDisabled","showErr","ReadMorePaginator","readMoreAutoLoad","onReachedBottom","getHasMore","getIsClearComments","dispose","Pagination","oninput","onkeydown","keydown","$prevBtn","$nextBtn","maxPage","ceil","setInput","inputTimer","isNaN","change","onChange","which","UpDownPaginator","PaginationComponent","getPageDataByLastData","roots_count","initListPaginatorFunc","paginator","createPaginatorByConf","$paginator","List","initCrudEvents","getCommentsWrapEl","commentNodes","getListLayout","forceFlatMode","d","bodyOrgOverflow","bodyOrgPaddingRight","getScrollbarHelper","paddingRight","unlock","lock","barPaddingRight","getPropertyValue","inner","outer","position","visibility","w1","offsetWidth","w2","clientWidth","removeChild","Ui.getScrollBarWidth","Layer","onAfterHide","setAllowMaskClose","allow","allowMaskClose","getAllowMaskClose","onShow","onHide","LayerWrap","$wrap","$mask","createItem","createItemElement","hideWrap","showWrap","getMask","getWrap","onanimationend","LayerManager","wrap","LOCAL_USER_KEY","User","localUser","localStorage","getItem","setItem","onUserChanged","logout","services","i18n","I18n.setLocale","layerManager","editorPlugs","showErrorDialog","errEl","retryFn","$retryBtn","onOpenSidebar","$openSidebar","$err","loadConf","apiVersion","frontend_conf","DisabledKeys","handleConfFormServer","remoteConfModifier","sidebarOpenView","err_no_site","viewLoadParam","create_name","create_urls","host","errData","LocalStorageKey","SubmitAddPreset","reqAdd","useApi","getSubmitAddParams","useUser","useConf","useEditor","page_key","page_title","site_name","Utils.getCorrectUserAgent","postSubmitAdd","commentNew","Submit","defaultPreset","onEditorSubmit","do","useMounted","useUnmounted","registerCustom","customs","custom","activeCond","nComment","req","post","Emoticons","transEmoticonImageText","loadEmoticonsData","isImgLoaded","initEmoticonsList","changeListHeight","parentElement","isListLoaded","loadingTask","handleData","Ui.setError","pushGrp","grp","remoteLoad","grpData","isOwOFormat","convertOwO","solveNullKey","solveSameKey","tmp","container","owoData","grpName","nGrp","iconStr","icon","$grpWrap","$grp","$item","$grpSwitcher","openGrp","getAttribute","querySelectorAll","AllowImgExts","Upload","initDragImg","$imgUploadInput","accept","onchange","files","file","uploadImg","uploadFromFileList","onDragover","onDrop","dataTransfer","onPaste","clipboardData","fileExt","insertPrefix","uploadPlaceholderTxt","customUploaderFn","imgUploader","public_url","imgURL","Preview","isPlugPanelShow","updateContent","EDITOR_PLUGS","onContentUpdated","localContent","$inputs","inputEventFns","changeEventFns","field","timer","abortFn","onInput","fetchUserInfo","api","CANCEL_TOKEN","abortRequest","onUserInfoFetched","finally","onLinkChange","onLinkInputChange","onKeydown","adaptiveHeightByContent","diff","offsetHeight","scrollHeight","cancelReply","submitPlug","useDeps","page_url","$sendReplyBtn","cancelEdit","saveData","$editCancelBtn","updateSubmitBtnText","restoreSubmitBtnText","originalSubmitBtnText","onOpen","onClose","PlugKit","plug","PlugManager","confLoaded","clear","confRefs","getEnabledPlugs","Plug","loadPluginUI","closePlugPanel","openedPlug","loadPluginItem","openPlugPanel","plugPanel","rawContent","initCountWidget","refreshStatCount","numEl","initialData","pvAdd","pages","pv","queryPageKeys","stats","page_keys","defaultCount","selector","applyCountData","IgnoreVersionCheck","darkModeMedia","updateClassnames","$els","DarkModeClassName","GlobalPlugins","immediateFetch","markedReplacers","scanApply","els","$sidebarEl","getAdminOnlyEls","_params","limit","paramsModifier","listFetchParamsModifier","reqParams","flat_mode","listUnreadHighlight","notify","comment_id","read_link","commentID","Utils.getQueryParam","$closeCommentBtn","admin_only","adminPageEditSave","$count","$openSidebarBtn","syncByUser","$btnText","$unreadBadge","reloadUseParamsEditor","initDropdown","$dropdownOn","$dropdownWrap","dropdownList","curtActive","onItemClick","$dropdown","renderDropdown","sort_by","view_only_admin","removeDropdown","lastID","locker","extractCommentID","hashChangeHandler","listLoadedHandler","reply_comment","isNoComment","$noComment","$copyright","ARTALK_VERSION","setInterval","clearInterval","observer","clearObserver","disconnect","childNodes","$target","scrollEvtAt","IntersectionObserver","isIntersecting","threshold","observe","setupObserver","Utils.getOffset","feVer","beVer","comp","pa","pb","na","nb","Utils.versionCompare","ignoreBtn","darkModeAutoHandler","sync","Artalk","handledConf","Services","initService","plugins","loadCountWidget"],"mappings":"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","x_google_ignoreList":[1,4,5,6,7,8,9,10,11,12,13,14,16]}